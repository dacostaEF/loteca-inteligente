<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>üîê Central Admin - Loteca Inteligente</title>
    <link rel="icon" type="image/png" href="/static/Favicon_LI.png">
    <link rel="shortcut icon" type="image/png" href="/static/Favicon_LI.png">
    
    <!-- META TAGS PARA AMBIENTE M√ìVEL COM DESTAQUE LIL√ÅS -->
    <meta name="theme-color" content="#A855F7">
    <meta name="msapplication-navbutton-color" content="#A855F7">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --cor-fundo: #12101a;
            --cor-fundo-card: #1e1b29;
            --cor-borda: #3a364f;
            --cor-texto-principal: #e2e8f0;
            --cor-texto-secundario: #94a3b8;
            --cor-destaque-primaria: #A855F7; /* Lil√°s */
            --cor-destaque-secundaria: #00E38C; /* Verde */
            --cor-vantagem: #00E38C;
            --cor-desvantagem: #F43F5E; /* Vermelho/Rosa */
            --cor-equilibrio: #FBBF24; /* Amarelo */
        }

        body {
            font-family: 'Roboto', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: var(--cor-fundo);
            min-height: 100vh;
            color: var(--cor-texto-principal);
            
            /* MOLDURA NEON LIL√ÅS - EFEITO LOTERIAS INTELIGENTE */
            box-shadow: 
                inset 0 0 0 3px var(--cor-destaque-primaria),
                inset 0 0 20px rgba(168, 85, 247, 0.3),
                0 0 40px rgba(168, 85, 247, 0.2);
            position: relative;
        }
        
        /* MOLDURA NEON PARA TABLETS */
        @media (max-width: 1024px) and (min-width: 769px) {
            body {
                box-shadow: 
                    inset 0 0 0 4px var(--cor-destaque-primaria),
                    inset 0 0 25px rgba(168, 85, 247, 0.35),
                    0 0 50px rgba(168, 85, 247, 0.25);
                animation: neonPulse 4s ease-in-out infinite alternate;
            }
        }

        /* MOLDURA NEON ADICIONAL PARA DISPOSITIVOS M√ìVEIS */
        @media (max-width: 768px) {
            body {
                box-shadow: 
                    inset 0 0 0 2px var(--cor-destaque-primaria),
                    inset 0 0 15px rgba(168, 85, 247, 0.4),
                    0 0 30px rgba(168, 85, 247, 0.3);
                animation: neonPulse 3s ease-in-out infinite alternate;
            }
        }
        
        /* ANIMA√á√ÉO NEON PULSANTE */
        @keyframes neonPulse {
            0% {
                box-shadow: 
                    inset 0 0 0 3px var(--cor-destaque-primaria),
                    inset 0 0 20px rgba(168, 85, 247, 0.3),
                    0 0 40px rgba(168, 85, 247, 0.2);
            }
            100% {
                box-shadow: 
                    inset 0 0 0 3px var(--cor-destaque-primaria),
                    inset 0 0 25px rgba(168, 85, 247, 0.5),
                    0 0 60px rgba(168, 85, 247, 0.4);
            }
        }

        /* === TELA DE LOGIN === */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-box {
            background: var(--cor-fundo-card);
            border: 1px solid var(--cor-borda);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        .login-box h1 {
            color: var(--cor-destaque-primaria);
            margin-bottom: 30px;
            font-size: 28px;
            font-weight: 800;
        }

        .login-box .icon {
            font-size: 60px;
            color: var(--cor-destaque-secundaria);
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--cor-texto-secundario);
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--cor-borda);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            background-color: var(--cor-fundo);
            color: var(--cor-texto-principal);
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--cor-destaque-primaria);
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, var(--cor-destaque-secundaria), #00B377);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,227,140,0.3);
        }

        .error-message {
            color: #e74c3c;
            margin-top: 15px;
            padding: 10px;
            background: #ffeaea;
            border-radius: 5px;
            display: none;
        }

        /* === INTERFACE PRINCIPAL === */
        .admin-container {
            display: none;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: var(--cor-fundo-card);
            border: 1px solid var(--cor-borda);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: var(--cor-destaque-primaria);
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 800;
        }

        .logout-btn {
            background: #e74c3c;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--cor-fundo-card);
            border: 1px solid var(--cor-borda);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card .icon {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .stat-card .number {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .stat-card .label {
            color: #666;
            font-weight: 600;
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            background: var(--cor-fundo-card);
            border: 1px solid var(--cor-borda);
            padding: 5px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: var(--cor-texto-secundario);
        }

        .tab:hover {
            background: rgba(168, 85, 247, 0.1);
            color: var(--cor-destaque-primaria);
        }

        .tab.active {
            background: linear-gradient(135deg, var(--cor-destaque-primaria), #9333EA);
            color: white;
        }

        .tab-content {
            background: var(--cor-fundo-card);
            border: 1px solid var(--cor-borda);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-group {
            position: relative;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 15px;
            border: 1px solid var(--cor-borda);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            background-color: var(--cor-fundo);
            color: var(--cor-texto-principal);
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--cor-destaque-primaria);
            transform: translateY(-2px);
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
        }

        .input-group label {
            position: absolute;
            top: -10px;
            left: 15px;
            background: var(--cor-fundo-card);
            padding: 0 10px;
            color: var(--cor-destaque-secundaria);
            font-weight: 600;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--cor-destaque-secundaria), #00B377);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,227,140,0.3);
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--cor-borda);
            color: var(--cor-texto-secundario);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            border-color: var(--cor-destaque-primaria);
            color: var(--cor-destaque-primaria);
        }

        .btn-danger {
            background: var(--cor-desvantagem);
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: var(--cor-fundo-card);
            border: 1px solid var(--cor-borda);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .data-table th {
            background: linear-gradient(135deg, var(--cor-destaque-primaria), #9333EA);
            color: white;
            padding: 15px 10px;
            font-weight: 600;
            text-align: left;
        }

        .data-table td {
            padding: 12px 10px;
            border-bottom: 1px solid var(--cor-borda);
            color: var(--cor-texto-principal);
        }

        .data-table tr:hover {
            background: rgba(168, 85, 247, 0.05);
        }

        .escudo-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-badge.serie-a {
            background: var(--cor-destaque-secundaria);
            color: white;
        }

        .status-badge.s√©rie-a {
            background: var(--cor-destaque-secundaria);
            color: white;
        }

        .status-badge.serie-b {
            background: var(--cor-equilibrio);
            color: var(--cor-fundo);
        }

        .status-badge.s√©rie-b {
            background: var(--cor-equilibrio);
            color: var(--cor-fundo);
        }

        .status-badge.regional {
            background: var(--cor-texto-secundario);
            color: white;
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 18px;
            color: var(--cor-texto-secundario);
        }

        .loading i {
            font-size: 40px;
            margin-bottom: 15px;
            animation: spin 1s linear infinite;
            color: var(--cor-destaque-primaria);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-message, .error-alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-weight: 600;
            display: none;
            border: 1px solid var(--cor-borda);
        }

        .success-message {
            background: rgba(0, 227, 140, 0.1);
            color: var(--cor-destaque-secundaria);
            border-color: var(--cor-destaque-secundaria);
        }

        .error-alert {
            background: rgba(244, 63, 94, 0.1);
            color: var(--cor-desvantagem);
            border-color: var(--cor-desvantagem);
        }

        .search-box {
            width: 100%;
            padding: 15px;
            border: 1px solid var(--cor-borda);
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 20px;
            background-color: var(--cor-fundo);
            color: var(--cor-texto-principal);
        }

        .search-box:focus {
            outline: none;
            border-color: var(--cor-destaque-primaria);
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
        }

        @media (max-width: 768px) {
            .admin-container {
                padding: 10px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .data-table {
                font-size: 14px;
            }
            
            .data-table th, .data-table td {
                padding: 8px 5px;
            }
        }

        /* Estilos para aba Classifica√ß√£o */
        .classification-area {
            margin: 20px 0;
        }

        .table-input {
            width: 60px;
            padding: 4px 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 13px;
        }

        .table-input:focus {
            border-color: var(--cor-destaque-primaria);
            outline: none;
            box-shadow: 0 0 0 2px rgba(168, 85, 247, 0.2);
        }

        /* C√©lulas edit√°veis na tabela de classifica√ß√£o */
        .data-table td.editable {
            background-color: #f8f9ff;
            border: 1px dashed #ddd;
            cursor: text;
            transition: all 0.2s ease;
        }

        .data-table td.editable:hover {
            background-color: #f0f0ff;
            border-color: var(--cor-destaque-primaria);
        }

        .data-table td.editable:focus {
            background-color: white;
            border-color: var(--cor-destaque-primaria);
            outline: none;
            box-shadow: 0 0 0 2px rgba(168, 85, 247, 0.1);
        }

        .loading-message {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .coming-soon {
            text-align: center;
            padding: 60px 20px;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 40px 0;
        }
        
        /* === ESTILOS PARA EDI√á√ÉO AVAN√áADA === */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes saved {
            0% { background-color: #d1f2eb; }
            50% { background-color: #28a745; }
            100% { background-color: #d1f2eb; }
        }
        
        .editable {
            transition: all 0.3s ease;
            cursor: text;
        }
        
        .editable:hover {
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transform: translateY(-1px);
        }
        
        .editable:focus {
            outline: none;
            transform: scale(1.02);
        }
        
        .modified {
            animation: pulse 0.5s ease-in-out;
        }
        
        .saved {
            animation: saved 1s ease-in-out;
        }

        /* === SISTEMA DE TOOLTIPS EDUCATIVOS === */
        .help-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            background: #dc3545;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 16px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            margin-left: 5px;
            transition: all 0.3s ease;
            vertical-align: middle;
        }

        .help-icon:hover {
            background: #c82333;
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3);
        }

        /* Modal de Ajuda */
        .help-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .help-modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 5% auto;
            padding: 0;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.4s ease-out;
            overflow: hidden;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .help-modal-header {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .help-modal-title {
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .help-modal-close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .help-modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .help-modal-body {
            padding: 25px;
            color: white;
            line-height: 1.6;
        }

        .help-definition {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #ffd700;
        }

        .help-formula {
            background: rgba(0, 0, 0, 0.2);
            padding: 12px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
            color: #ffd700;
        }

        .help-examples {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }

        .help-example {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .help-example-value {
            font-size: 18px;
            font-weight: bold;
            color: #ffd700;
        }

        .help-example-label {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 5px;
        }

        .help-interpretation {
            margin-top: 20px;
        }

        .help-scale {
            display: flex;
            justify-content: space-between;
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .help-scale-item {
            text-align: center;
            flex: 1;
            padding: 5px;
        }

        .help-scale-excellent { color: #28a745; }
        .help-scale-good { color: #ffc107; }
        .help-scale-average { color: #fd7e14; }
        .help-scale-poor { color: #dc3545; }

        /* === √çCONE TOGGLE SENHA === */
        #togglePassword:hover {
            color: #00E38C !important;
            transform: scale(1.1);
        }

        /* === BOT√ïES DE A√á√ÉO DESTACADOS === */
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        /* Efeitos hover espec√≠ficos por cor */
        button[style*="00E38C"]:hover {
            box-shadow: 0 8px 25px rgba(0,227,140,0.4) !important;
        }

        button[style*="6c757d"]:hover {
            box-shadow: 0 8px 25px rgba(108,117,125,0.4) !important;
        }

        button[style*="17a2b8"]:hover {
            box-shadow: 0 8px 25px rgba(23,162,184,0.4) !important;
        }

        button[style*="ffc107"]:hover {
            box-shadow: 0 8px 25px rgba(255,193,7,0.4) !important;
        }

        /* === SCROLL PERSONALIZADO PARA TABELA DE JOGOS === */
        .tabela-jogos-scroll {
            scrollbar-width: thin;
            scrollbar-color: #6f42c1 #2a2a2a;
        }

        .tabela-jogos-scroll::-webkit-scrollbar {
            width: 8px;
        }

        .tabela-jogos-scroll::-webkit-scrollbar-track {
            background: #2a2a2a;
            border-radius: 4px;
        }

        .tabela-jogos-scroll::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #6f42c1, #8b5cf6);
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .tabela-jogos-scroll::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
        }

        /* Cabe√ßalho fixo na tabela */
        .tabela-jogos-scroll thead th {
            position: sticky;
            top: 0;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        /* Notifica√ß√µes */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 10000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .notification.success {
            background: linear-gradient(135deg, #28a745, #20c997);
        }
        
        .notification.error {
            background: linear-gradient(135deg, #dc3545, #fd7e14);
        }
        
        .notification.info {
            background: linear-gradient(135deg, #17a2b8, #6f42c1);
        }

        /* === ESTILOS PARA ESTAT√çSTICAS === */
        .stats-section {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .section-title {
            color: #6f42c1;
            background: linear-gradient(135deg, #6f42c1, #8b5cf6);
            color: white;
            padding: 10px 15px;
            border-radius: 6px;
            margin: -20px -20px 20px -20px;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px dashed #dee2e6;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state h3 {
            color: #495057;
            margin-bottom: 10px;
        }

        /* === ESTILOS DOS CAMPOS === */
        
        /* Campos bloqueados (dados da classifica√ß√£o) - VERS√ÉO PROFISSIONAL */
        .campo-bloqueado {
            background: #1a1a1a !important;
            border: 1px solid #404040 !important;
            padding: 10px 12px !important;
            border-radius: 4px !important;
            color: #ffffff !important;
            font-weight: 600 !important;
            font-size: 16px !important;
            width: 100% !important;
            text-align: right !important;
            font-family: 'Roboto', 'Open Sans', sans-serif !important;
            cursor: not-allowed !important;
            user-select: none !important;
            pointer-events: none !important;
        }
        
        .campo-bloqueado:focus {
            outline: 2px solid #dc3545 !important;
            box-shadow: 0 0 8px rgba(220, 53, 69, 0.6) !important;
        }
        
        /* Campos calculados automaticamente */
        .campo-calculado {
            background: #2d3748 !important; /* Fundo mais claro */
            border: 2px solid #60a5fa !important; /* Borda azul para destaque */
            padding: 10px 12px !important;
            border-radius: 4px !important;
            color: #ffffff !important; /* Texto branco forte */
            font-weight: 700 !important;
            font-size: 18px !important; /* Fonte maior */
            width: 100% !important;
            text-align: center !important; /* Centralizado para melhor visibilidade */
            font-family: 'Roboto', 'Open Sans', sans-serif !important;
            cursor: not-allowed;
            user-select: none;
            pointer-events: none;
            box-shadow: 0 0 10px rgba(96, 165, 250, 0.3) !important; /* Brilho azul */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8) !important; /* Sombra no texto */
        }
        
        /* Campos edit√°veis */
        .campo-editavel {
            background: #2a2a2a !important;
            border: 1px solid #555555 !important;
            padding: 10px 12px !important;
            border-radius: 4px !important;
            color: #ffffff !important;
            font-weight: 600 !important;
            font-size: 16px !important;
            width: 100% !important;
            text-align: right !important;
            font-family: 'Roboto', 'Open Sans', sans-serif !important;
            transition: all 0.2s ease !important;
        }
        
        /* Placeholder mais suave */
        .campo-editavel::placeholder {
            color: #adb5bd !important;
            font-weight: normal !important;
        }
        
        /* Focus nos campos edit√°veis */
        .campo-editavel:focus {
            outline: none !important;
            border-color: #0056b3 !important;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25) !important;
        }

        /* === CAMPOS QUE PRECISAM SER PREENCHIDOS - Destaque Visual === */
        .campo-pendente {
            background: rgba(0, 227, 140, 0.15) !important; /* Verde transparente */
            border: 1px solid rgba(0, 227, 140, 0.4) !important;
            padding: 10px 12px !important;
            border-radius: 4px !important;
            color: #60a5fa !important; /* Azul ciano para n√∫meros */
            font-weight: 600 !important;
            font-size: 16px !important;
            width: 100% !important;
            text-align: right !important;
            font-family: 'Roboto', 'Open Sans', sans-serif !important;
            box-shadow: 0 0 8px rgba(0, 227, 140, 0.2) !important;
            cursor: text;
            user-select: text;
            pointer-events: auto;
        }

        .campo-pendente:focus {
            background: rgba(0, 227, 140, 0.25) !important;
            border-color: #00E38C !important;
            box-shadow: 0 0 12px rgba(0, 227, 140, 0.4) !important;
            outline: none !important;
        }

        .campo-pendente::placeholder {
            color: rgba(96, 165, 250, 0.7) !important;
            font-style: italic !important;
            font-weight: normal !important;
        }

        /* === SISTEMA DE CADEADO MANUAL === */
        .campo-lock-toggle {
            transition: all 0.3s ease !important;
            z-index: 10;
        }

        .campo-lock-toggle:hover {
            color: #1d4ed8 !important;
            transform: translateY(-50%) scale(1.1) !important;
        }

        .campo-bloqueado-manual {
            background: #374151 !important; /* Fundo cinza escuro */
            border: 2px solid #1e40af !important; /* Borda azul navy */
            color: #ffffff !important;
            cursor: not-allowed !important;
            user-select: none !important;
            pointer-events: none !important;
        }

        .campo-bloqueado-manual:focus {
            outline: none !important;
            box-shadow: 0 0 8px rgba(30, 64, 175, 0.5) !important;
        }
    </style>
</head>
<body>
    <!-- === TELA DE LOGIN === -->
    <div class="login-container" id="loginContainer">
        <div class="login-box">
            <i class="fas fa-shield-alt icon"></i>
            <h1>Acesso Administrativo</h1>
            <p style="margin-bottom: 30px; color: #666;">Central de Dados - Loteca Inteligente</p>
            
            <div class="form-group">
                <label for="adminKey">Chave de Administrador:</label>
                <div style="position: relative; display: flex; align-items: center;">
                    <input type="password" id="adminKey" placeholder="Digite a chave de acesso" style="padding-right: 45px;">
                    <i class="fas fa-eye" id="togglePassword" 
                       style="position: absolute; right: 15px; cursor: pointer; color: #666; font-size: 16px; transition: color 0.3s ease;" 
                       onclick="togglePasswordVisibility()" 
                       title="Mostrar/Ocultar senha"></i>
                </div>
            </div>
            
            <button class="btn" onclick="login()">
                <i class="fas fa-sign-in-alt"></i> Acessar Sistema
            </button>
            
            <div class="error-message" id="loginError">
                <i class="fas fa-exclamation-triangle"></i> Chave de acesso inv√°lida!
            </div>
        </div>
    </div>

    <!-- === INTERFACE PRINCIPAL === -->
    <div class="admin-container" id="adminContainer">
        <!-- Header -->
        <div class="header">
            <h1>
                <i class="fas fa-database"></i>
                Central Admin - Loteca Inteligente
            </h1>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Sair
            </button>
        </div>

        <!-- Estat√≠sticas -->
        <div class="stats-grid">
            <div class="stat-card">
                <i class="fas fa-users icon" style="color: #3498db;"></i>
                <div class="number" id="totalClubes">-</div>
                <div class="label">Total de Clubes</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-trophy icon" style="color: #f39c12;"></i>
                <div class="number" id="serieAClubes">-</div>
                <div class="label">S√©rie A</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-medal icon" style="color: #e67e22;"></i>
                <div class="number" id="serieBClubes">-</div>
                <div class="label">S√©rie B</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-clock icon" style="color: #00E38C;"></i>
                <div class="number" id="ultimaSync">-</div>
                <div class="label">√öltima Sincroniza√ß√£o</div>
            </div>
        </div>
        
        <!-- Bot√£o Debug removido - fun√ß√£o desnecess√°ria -->

        <!-- Mensagens -->
        <div class="success-message" id="successMessage">
            <i class="fas fa-check-circle"></i> <span id="successText"></span>
        </div>
        <div class="error-alert" id="errorMessage">
            <i class="fas fa-exclamation-circle"></i> <span id="errorText"></span>
        </div>

        <!-- Abas -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('classificacao')">
                <i class="fas fa-table"></i> Classifica√ß√£o
            </button>
            <button class="tab" onclick="showTab('jogos-loteca')">
                <i class="fas fa-gamepad"></i> Jogos Loteca
            </button>
            <button class="tab" onclick="showTab('clubes')">
                <i class="fas fa-users"></i> Clubes
            </button>
            <button class="tab" onclick="showTab('estatisticas')">
                <i class="fas fa-chart-bar"></i> Estat√≠sticas
            </button>
            <button class="tab" onclick="showTab('campeonatos')">
                <i class="fas fa-trophy"></i> Campeonatos
            </button>
            <button class="tab" onclick="showTab('dashboard')">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </button>
            <button class="tab" onclick="showTab('backup')">
                <i class="fas fa-download"></i> Backup
            </button>
        </div>

        <!-- === ABA CLASSIFICA√á√ÉO === -->
        <div class="tab-content active" id="classificacao">
            <h2 style="margin-bottom: 25px; color: #333;">
                <i class="fas fa-table"></i> Gest√£o de Classifica√ß√£o
            </h2>
            
            <!-- Seletor de Campeonato -->
            <div class="form-row">
                <div class="input-group">
                    <label>Campeonato</label>
                    <select id="campeonatoSelect" onchange="alterarCampeonato()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: 2px solid #4c51bf; padding: 10px; border-radius: 8px; font-weight: bold;">
                        <option value="serie-a" style="background: #4c51bf; color: white;">ü•á Brasileir√£o S√©rie A</option>
                        <option value="serie-b" style="background: #6b46c1; color: white;">ü•à Brasileir√£o S√©rie B</option>
                        <option value="premier-league" style="background: #1e40af; color: white;">üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø Premier League</option>
                        <option value="la-liga" style="background: #dc2626; color: white;">üá™üá∏ La Liga</option>
                        <option value="ligue1" style="background: #0f172a; color: white;">üá´üá∑ Ligue 1</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Rodada</label>
                    <input type="number" id="rodadaInput" placeholder="Ex: 25" min="1" max="38">
                </div>
            </div>
            
            <!-- √Årea de Classifica√ß√£o -->
            <div class="classification-area">
                <div class="loading-message" id="loadingClassificacao" style="display: none; color: #00ff00; font-weight: bold;">
                    <i class="fas fa-spinner fa-spin"></i> üîÑ Carregando classifica√ß√£o...
                </div>
                
                <table class="data-table" id="tabelaClassificacao" style="border: 2px solid #374151; width: 100%; border-collapse: collapse;">
                    <thead style="background: linear-gradient(135deg, #1f2937, #374151); color: white;">
                        <tr>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">Pos</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">Time</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">P</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">J</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">V</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">E</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">D</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">GP</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">GC</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">SG</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">%</th>
                            <th style="padding: 12px 8px; font-weight: bold; font-size: 14px; border: 1px solid #4b5563;">√öltimos</th>
                        </tr>
                    </thead>
                    <tbody id="classificacaoBody" style="border: 2px solid #ff0000; min-height: 200px;">
                        <!-- üéØ DEBUG: Dados da classifica√ß√£o ser√£o inseridos aqui -->
                        <tr><td colspan="12" style="text-align: center; padding: 20px; color: #ff0000; font-weight: bold;">üîç AGUARDANDO DADOS...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Bot√µes de A√ß√£o -->
            <div class="form-row" style="margin-top: 20px;">
                <button class="btn-primary" onclick="carregarClassificacao()" style="background: #00ff00; color: black;">
                    <i class="fas fa-sync"></i> üîÑ Atualizar Classifica√ß√£o
                </button>
                <button class="btn-success" onclick="salvarClassificacao()">
                    <i class="fas fa-save"></i> Salvar Altera√ß√µes
                </button>
                <!-- Bot√£o TESTE DEBUG removido - fun√ß√£o desnecess√°ria -->
            </div>
        </div>

        <!-- === ABA JOGOS LOTECA === -->
        <div class="tab-content" id="jogos-loteca">
            <h2 style="margin-bottom: 25px; color: #333;">
                <i class="fas fa-gamepad"></i> Gest√£o de Jogos Loteca
            </h2>
            
            <!-- INFORMA√á√ïES DO CONCURSO -->
            <div class="form-row" style="margin-bottom: 30px;">
                <div class="form-group" style="flex: 1; margin-right: 15px;">
                    <label>Concurso N¬∫:</label>
                    <input type="number" id="numeroConcurso" class="form-control" placeholder="1213" value="1213">
                </div>
                <div class="form-group" style="flex: 2; margin-right: 15px;">
                    <label>Data do Sorteio:</label>
                    <input type="date" id="dataSorteio" class="form-control" value="2025-09-27">
                </div>
                <div class="form-group" style="flex: 2;">
                    <label>Per√≠odo de Apostas:</label>
                    <input type="text" id="periodoApostas" class="form-control" placeholder="24/09/2025 at√© 15h do dia 27/09/2025" value="24/09/2025 at√© 15h do dia 27/09/2025">
                </div>
            </div>

            <!-- VOLANTE DA LOTECA - R√âPLICA DA CAIXA -->
            <div class="loteca-volante" style="background: white; border: 2px solid #0066cc; border-radius: 10px; padding: 20px; margin-bottom: 30px;">
                <div class="volante-header" style="text-align: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #0066cc;">
                    <h3 style="color: #0066cc; margin: 0; font-weight: bold;">
                        Concurso <span id="displayConcurso">1213</span> (<span id="displayData">27/09/2025, S√°bado</span>)
                    </h3>
                    <p style="color: #666; margin: 5px 0 0 0; font-size: 14px;">
                        Per√≠odo de apostas: <span id="displayPeriodo">24/09/2025 at√© as 15h do dia 27/09/2025</span>
                    </p>
                    <p style="color: #666; margin: 5px 0 0 0; font-size: 14px;">
                        Realiza√ß√£o dos jogos de futebol: <span id="displayRealizacao">27/09/2025 a 28/09/2025</span>
                    </p>
                </div>

                <!-- TABELA DOS JOGOS -->
                <div class="table-responsive">
                    <table class="loteca-table" style="width: 100%; border-collapse: collapse; border: 1px solid #0066cc;">
                        <thead>
                            <tr style="background: #0066cc; color: white;">
                                <th style="padding: 10px; text-align: center; border: 1px solid #0066cc; width: 60px;">Jogo</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #0066cc; width: 35%;">Coluna 1</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #0066cc; width: 60px;">x</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #0066cc; width: 35%;">Coluna 2</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #0066cc; width: 15%;">Data</th>
                            </tr>
                        </thead>
                        <tbody id="lotecaJogos">
                            <!-- Os 14 jogos ser√£o inseridos aqui -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- BOT√ïES DE A√á√ÉO -->
            <div class="form-row" style="margin-top: 20px;">
                <button class="btn-primary" onclick="carregarJogosAtuais()" style="margin-right: 10px;">
                    <i class="fas fa-sync"></i> Carregar Jogos Atuais
                </button>
                <button class="btn-success" onclick="salvarJogosLoteca()" style="margin-right: 10px;">
                    <i class="fas fa-save"></i> Salvar Concurso
                </button>
                <button class="btn-secondary" onclick="gerarAnalises()" style="margin-right: 10px;">
                    <i class="fas fa-chart-bar"></i> Gerar An√°lises
                </button>
                <button class="btn-warning" onclick="publicarNoSite()">
                    <i class="fas fa-upload"></i> Publicar no Site
                </button>
            </div>

            <!-- HIST√ìRICO DE CONCURSOS -->
            <div class="historico-section" style="margin-top: 40px;">
                <h3 style="color: #333; margin-bottom: 15px;">
                    <i class="fas fa-history"></i> Hist√≥rico de Concursos
                </h3>
                <div class="loading-message" id="loadingHistorico" style="display: none;">
                    <i class="fas fa-spinner fa-spin"></i> Carregando hist√≥rico...
                </div>
                <table class="data-table" id="tabelaHistorico">
                    <thead>
                        <tr>
                            <th>Concurso</th>
                            <th>Data</th>
                            <th>Status</th>
                            <th>Jogos</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="historicoBody">
                        <!-- Hist√≥rico ser√° inserido aqui -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- === ABA CLUBES - ESTAT√çSTICAS DETALHADAS === -->
        <div class="tab-content" id="clubes">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <h2 style="color: #6f42c1; font-weight: 600; text-shadow: 0 2px 4px rgba(111, 66, 193, 0.3); margin: 0;">
                    <i class="fas fa-chart-line" style="margin-right: 10px;"></i> Estat√≠sticas Detalhadas dos Clubes
                </h2>
                <button id="btnTabelaJogos" class="btn-primary" onclick="abrirTabelaJogos()" style="background: linear-gradient(135deg, #00E38C, #00B377); display: none;">
                    <i class="fas fa-table" style="margin-right: 8px;"></i> Tabela de Jogos
                </button>
            </div>
            
            <!-- Seletor de Clube -->
            <div class="form-row" style="margin-bottom: 30px;">
                <div class="input-group" style="flex: 1;">
                    <label>Selecionar Clube</label>
                    <select id="clubeEstatisticas" onchange="carregarEstatisticasClube()">
                        <option value="">Escolha um clube...</option>
                        <option value="flamengo">üî• Flamengo</option>
                        <option value="corinthians">‚ö´ Corinthians</option>
                        <option value="palmeiras">üü¢ Palmeiras</option>
                        <option value="santos">‚ö™ Santos</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>&nbsp;</label>
                    <button class="btn-primary" onclick="carregarEstatisticasClube()">
                        <i class="fas fa-sync"></i> Carregar Dados
                    </button>
                </div>
            </div>

            <!-- Tabela de Estat√≠sticas -->
            <div id="formularioEstatisticas" style="display: none;">
                
                <table class="data-table" id="tabelaEstatisticas">
                    <thead>
                        <tr style="background: linear-gradient(135deg, #6f42c1, #8b5cf6); color: white;">
                            <th colspan="4" style="text-align: center; font-size: 18px; padding: 15px;">
                                üìä Estat√≠sticas Detalhadas do Clube
                            </th>
                        </tr>
                        <tr style="background: #f8f9fa;">
                            <th style="width: 25%;">Campo</th>
                            <th style="width: 25%;">Valor</th>
                            <th style="width: 25%;">Campo</th>
                            <th style="width: 25%;">Valor</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- DADOS B√ÅSICOS -->
                        <tr>
                            <td><strong>Posi√ß√£o Atual</strong> <i class="fas fa-lock" style="color: #fbbf24; margin-left: 8px;" title="Campo fixo - Dados da Tabela de Classifica√ß√£o"></i></td>
                            <td><input type="number" id="posicaoAtual" placeholder="Ex: 2" min="1" max="20" readonly class="campo-bloqueado"></td>
                            <td><strong>Pontos Total</strong> <i class="fas fa-lock" style="color: #fbbf24; margin-left: 8px;" title="Campo fixo - Dados da Tabela de Classifica√ß√£o"></i></td>
                            <td><input type="number" id="pontosTotal" placeholder="Ex: 58" readonly class="campo-bloqueado"></td>
                        </tr>
                        <tr>
                            <td><strong>Jogos Disputados</strong> <i class="fas fa-lock" style="color: #fbbf24; margin-left: 8px;" title="Campo fixo - Dados da Tabela de Classifica√ß√£o"></i></td>
                            <td><input type="number" id="jogosDisputados" placeholder="Ex: 28" readonly class="campo-bloqueado"></td>
                            <td><strong>PPG</strong> <i class="fas fa-lock" style="color: #fbbf24; margin-left: 8px;" title="Campo fixo - Dados da Tabela de Classifica√ß√£o"></i><span class="help-icon" onclick="mostrarAjuda('ppg')" title="Clique para saber mais sobre PPG">?</span></td>
                            <td><input type="text" id="ppg" readonly class="campo-bloqueado"></td>
                        </tr>
                        
                        <!-- PERFORMANCE GERAL -->
                        <tr style="background: #333333;">
                            <td colspan="4" style="text-align: left; font-weight: 400; color: #ffffff; padding: 12px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px;">Performance Geral</td>
                        </tr>
                        <tr>
                            <td><strong>Vit√≥rias</strong> <i class="fas fa-lock" style="color: #fbbf24; margin-left: 8px;" title="Campo fixo - Dados da Tabela de Classifica√ß√£o"></i></td>
                            <td><input type="number" id="vitorias" placeholder="" readonly class="campo-bloqueado"></td>
                            <td><strong>Empates</strong> <i class="fas fa-lock" style="color: #fbbf24; margin-left: 8px;" title="Campo fixo - Dados da Tabela de Classifica√ß√£o"></i></td>
                            <td><input type="number" id="empates" placeholder="" readonly class="campo-bloqueado"></td>
                        </tr>
                        <tr>
                            <td><strong>Derrotas</strong> <i class="fas fa-lock" style="color: #fbbf24; margin-left: 8px;" title="Campo fixo - Dados da Tabela de Classifica√ß√£o"></i></td>
                            <td><input type="number" id="derrotas" placeholder="" readonly class="campo-bloqueado"></td>
                            <td><strong>% Vit√≥rias</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i></td>
                            <td><input type="text" id="percentualVitorias" readonly class="campo-bloqueado"></td>
                        </tr>

                        <!-- DADOS OFENSIVOS -->
                        <tr style="background: #333333;">
                            <td colspan="4" style="text-align: left; font-weight: 400; color: #ffffff; padding: 12px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px;">Dados Ofensivos</td>
                        </tr>
                        <tr>
                            <td><strong>Gols Marcados</strong> <i class="fas fa-lock" style="color: #fbbf24; margin-left: 8px;" title="Campo fixo - Dados da Tabela de Classifica√ß√£o"></i></td>
                            <td><input type="number" id="golsMarcados" placeholder="Ex: 52" readonly class="campo-bloqueado"></td>
                            <td><strong>M√©dia Gols</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i></td>
                            <td><input type="text" id="mediaGols" readonly class="campo-bloqueado"></td>
                        </tr>
                        <tr>
                            <td><strong>Chutes por Jogo</strong> <i class="fas fa-edit" style="color: #60a5fa; margin-left: 8px;" title="Campo edit√°vel"></i></td>
                            <td><input type="number" step="0.1" id="chutesPorJogo" placeholder="Ex: 14.2" class="campo-editavel"></td>
                            <td><strong>Posse de Bola (%)</strong> <i class="fas fa-edit" style="color: #60a5fa; margin-left: 8px;" title="Campo edit√°vel"></i></td>
                            <td><input type="number" step="0.1" id="posseBola" placeholder="Ex: 58.3" class="campo-editavel"></td>
                        </tr>

                        <!-- DADOS DEFENSIVOS -->
                        <tr style="background: #333333;">
                            <td colspan="4" style="text-align: left; font-weight: 400; color: #ffffff; padding: 12px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px;">Dados Defensivos</td>
                        </tr>
                        <tr>
                            <td><strong>Gols Sofridos</strong> <i class="fas fa-lock" style="color: #fbbf24; margin-left: 8px;" title="Campo fixo - Dados da Tabela de Classifica√ß√£o"></i></td>
                            <td><input type="number" id="golsSofridos" placeholder="Ex: 32" readonly class="campo-bloqueado"></td>
                            <td><strong>M√©dia Sofridos</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i></td>
                            <td><input type="text" id="mediaSofridos" readonly class="campo-bloqueado"></td>
                        </tr>
                        <tr>
                            <td><strong>Clean Sheets</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i><span class="help-icon" onclick="mostrarAjuda('cleansheet')" title="Clique para saber mais sobre Clean Sheets">?</span></td>
                            <td><input type="number" id="cleanSheets" readonly class="campo-bloqueado"></td>
                            <td><strong>% Clean Sheets</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i></td>
                            <td><input type="text" id="percentualCleanSheets" readonly class="campo-bloqueado"></td>
                        </tr>

                        <!-- MANDANTE vs VISITANTE -->
                        <tr style="background: #333333;">
                            <td colspan="4" style="text-align: left; font-weight: 400; color: #ffffff; padding: 12px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px;">Mandante vs Visitante</td>
                        </tr>
                        <tr>
                            <td><strong>PPG Casa</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i><span class="help-icon" onclick="mostrarAjuda('ppg_casa')" title="Clique para saber mais sobre PPG Casa">?</span></td>
                            <td><input type="number" step="0.01" id="ppgCasa" readonly class="campo-bloqueado"></td>
                            <td><strong>PPG Fora</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i><span class="help-icon" onclick="mostrarAjuda('ppg_fora')" title="Clique para saber mais sobre PPG Fora">?</span></td>
                            <td><input type="number" step="0.01" id="ppgFora" readonly class="campo-bloqueado"></td>
                        </tr>
                        <tr>
                            <td><strong>Aproveitamento Casa (%)</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i></td>
                            <td><input type="number" step="0.1" id="aproveitamentoCasa" readonly class="campo-bloqueado"></td>
                            <td><strong>Aproveitamento Fora (%)</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i></td>
                            <td><input type="number" step="0.1" id="aproveitamentoFora" readonly class="campo-bloqueado"></td>
                        </tr>

                        <!-- FORMA RECENTE -->
                        <tr style="background: #333333;">
                            <td colspan="4" style="text-align: left; font-weight: 400; color: #ffffff; padding: 12px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px;">Forma Recente</td>
                        </tr>
                        <tr>
                            <td><strong>√öltimos 5 Jogos</strong> <i class="fas fa-lock" style="color: #fbbf24; margin-left: 8px;" title="Campo fixo - Dados da Tabela de Classifica√ß√£o"></i></td>
                            <td><input type="text" id="formaUltimos5" placeholder="Ex: V-V-E-E-D" maxlength="11" readonly class="campo-bloqueado"></td>
                            <td><strong>Pontos √öltimos 5</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i></td>
                            <td><input type="number" id="pontosUltimos5" readonly class="campo-bloqueado"></td>
                        </tr>
                        <tr>
                            <td><strong>Sequ√™ncia Atual</strong> <i class="fas fa-lock" style="color: #00E38C; margin-left: 8px;" title="Calculado automaticamente da tabela de jogos"></i></td>
                            <td><input type="text" id="sequenciaAtual" readonly class="campo-bloqueado"></td>
                            <td><strong>‚úèÔ∏è Tend√™ncia</strong> <i class="fas fa-edit" style="color: #007bff;" title="Campo Edit√°vel - Dados Complementares"></i></td>
                            <td>
                                <select id="tendencia" class="campo-editavel">
                                    <option value="">Selecione...</option>
                                    <option value="Subindo">üìà Subindo</option>
                                    <option value="Est√°vel">‚û°Ô∏è Est√°vel</option>
                                    <option value="Descendo">üìâ Descendo</option>
                                </select>
                            </td>
                        </tr>

                        <!-- ESTAT√çSTICA PLANTEL -->
                        <tr style="background: #333333;">
                            <td colspan="4" style="text-align: left; font-weight: 400; color: #ffffff; padding: 12px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px;">Estat√≠stica Plantel</td>
                        </tr>
                        <tr>
                            <td><strong>üîí Elenco Total</strong> <i class="fas fa-edit" style="color: #007bff;" title="Campo Edit√°vel - Dados Complementares"></i> <i class="fas fa-lock" style="color: #ef4444; font-size: 0.8rem;" title="Campo preenchido automaticamente da planilha"></i></td>
                            <td style="position: relative;">
                                <input type="number" id="elencoTotal" placeholder="40" class="campo-bloqueado">
                                <i class="fas fa-unlock campo-lock-toggle" data-field="elencoTotal" onclick="toggleLock('elencoTotal')" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #1e40af; cursor: pointer; display: none;" title="Clique para bloquear campo"></i>
                            </td>
                            <td><strong>‚úèÔ∏è % Prov√°veis</strong> <i class="fas fa-edit" style="color: #007bff;" title="Campo Edit√°vel - Dados Complementares"></i></td>
                            <td style="position: relative;">
                                <input type="number" step="0.1" id="pctProvaveis" placeholder="Ex: 42.5" class="campo-editavel">
                                <i class="fas fa-unlock campo-lock-toggle" data-field="pctProvaveis" onclick="toggleLock('pctProvaveis')" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #1e40af; cursor: pointer; display: none;" title="Clique para bloquear campo"></i>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>üîí Valor Elenco (MM ‚Ç¨)</strong> <i class="fas fa-exclamation-triangle" style="color: #fbbf24;" title="Campo precisa ser atualizado com dados reais"></i> <i class="fas fa-lock" style="color: #ef4444; font-size: 0.8rem;" title="Campo preenchido automaticamente da planilha"></i></td>
                            <td style="position: relative;">
                                <input type="number" step="0.1" id="valorElenco" placeholder="85.0" class="campo-bloqueado">
                                <i class="fas fa-unlock campo-lock-toggle" data-field="valorElenco" onclick="toggleLock('valorElenco')" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #1e40af; cursor: pointer; display: none;" title="Clique para bloquear campo"></i>
                            </td>
                            <td><strong>‚úèÔ∏è Rating M√©dio</strong> <i class="fas fa-edit" style="color: #007bff;" title="Campo Edit√°vel - Dados Complementares"></i></td>
                            <td style="position: relative;">
                                <input type="number" step="0.1" id="ratingMedio" placeholder="Ex: 4.6" class="campo-editavel">
                                <i class="fas fa-unlock campo-lock-toggle" data-field="ratingMedio" onclick="toggleLock('ratingMedio')" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #1e40af; cursor: pointer; display: none;" title="Clique para bloquear campo"></i>
                            </td>
                        </tr>

                        <!-- DADOS OFENSIVOS -->
                        <tr style="background: #333333;">
                            <td colspan="4" style="text-align: left; font-weight: 400; color: #ffffff; padding: 12px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px;">Dados Ofensivos</td>
                        </tr>
                        <tr>
                            <td><strong>üîí Chutes/Jogo</strong> <i class="fas fa-futbol" style="color: #f59e0b;" title="Chutes a gol por jogo"></i> <i class="fas fa-lock" style="color: #ef4444; font-size: 0.8rem;" title="Campo preenchido automaticamente da planilha"></i></td>
                            <td style="position: relative;">
                                <input type="number" step="0.1" id="chutesPorJogo" placeholder="13.4" class="campo-bloqueado">
                                <i class="fas fa-unlock campo-lock-toggle" data-field="chutesPorJogo" onclick="toggleLock('chutesPorJogo')" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #1e40af; cursor: pointer; display: none;" title="Clique para bloquear campo"></i>
                            </td>
                            <td><strong>üîí Posse de Bola (%)</strong> <i class="fas fa-percentage" style="color: #10b981;" title="Percentual m√©dio de posse de bola"></i> <i class="fas fa-lock" style="color: #ef4444; font-size: 0.8rem;" title="Campo preenchido automaticamente da planilha"></i></td>
                            <td style="position: relative;">
                                <input type="number" step="0.1" id="posseBola" placeholder="58.2" class="campo-bloqueado">
                                <i class="fas fa-unlock campo-lock-toggle" data-field="posseBola" onclick="toggleLock('posseBola')" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #1e40af; cursor: pointer; display: none;" title="Clique para bloquear campo"></i>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>üîí Passes Certos</strong> <i class="fas fa-exchange-alt" style="color: #3b82f6;" title="N√∫mero m√©dio de passes certos por jogo"></i> <i class="fas fa-lock" style="color: #ef4444; font-size: 0.8rem;" title="Campo preenchido automaticamente da planilha"></i></td>
                            <td style="position: relative;">
                                <input type="number" id="passesCertos" placeholder="385" class="campo-bloqueado">
                                <i class="fas fa-unlock campo-lock-toggle" data-field="passesCertos" onclick="toggleLock('passesCertos')" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #1e40af; cursor: pointer; display: none;" title="Clique para bloquear campo"></i>
                            </td>
                            <td style="color: #6b7280; font-style: italic;">Dados sincronizados da Planilha de Clubes</td>
                            <td></td>
                        </tr>

                        <!-- CONTEXTO ATUAL -->
                        <tr style="background: #333333;">
                            <td colspan="4" style="text-align: left; font-weight: 400; color: #ffffff; padding: 12px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px;">Contexto Atual</td>
                        </tr>
                        <tr>
                            <td><strong>‚úèÔ∏è Desfalques Importantes</strong> <i class="fas fa-edit" style="color: #007bff;" title="Campo Edit√°vel - Dados Complementares"></i></td>
                            <td colspan="3"><input type="text" id="desfalques" placeholder="Ex: Arrascaeta (les√£o), Vi√±a (suspenso)" class="campo-editavel"></td>
                        </tr>
                        <tr>
                            <td><strong>‚úèÔ∏è Motiva√ß√£o Atual</strong> <i class="fas fa-edit" style="color: #007bff;" title="Campo Edit√°vel - Dados Complementares"></i></td>
                            <td colspan="3"><input type="text" id="motivacao" placeholder="Ex: Briga pelo t√≠tulo - 6 pts do l√≠der" class="campo-editavel"></td>
                        </tr>
                        <tr>
                            <td><strong>‚úèÔ∏è Pr√≥ximos Jogos</strong> <i class="fas fa-edit" style="color: #007bff;" title="Campo Edit√°vel - Dados Complementares"></i></td>
                            <td colspan="3"><input type="text" id="proximosJogos" placeholder="Ex: COR(f), PAL(c), BOT(f)" class="campo-editavel"></td>
                        </tr>
                    </tbody>
                </table>

                <!-- BOT√ïES DE A√á√ÉO -->
                <div style="margin-top: 30px; text-align: center; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 15px; border: 1px solid rgba(255,255,255,0.1);">
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                        <button class="btn-primary" onclick="salvarEstatisticas()" style="background: linear-gradient(135deg, #00E38C, #00B377);">
                            <i class="fas fa-save"></i> Salvar Estat√≠sticas
                        </button>
                    </div>
                </div>

            </div>

            <!-- Mensagem quando nenhum clube selecionado -->
            <div id="mensagemSelecionar" class="empty-state">
                <i class="fas fa-chart-line" style="font-size: 48px; color: #ccc; margin-bottom: 15px;"></i>
                <h3>Selecione um clube para come√ßar</h3>
                <p>Escolha um clube no seletor acima para preencher suas estat√≠sticas detalhadas</p>
            </div>

        </div>

        <!-- === ABA ESTAT√çSTICAS === -->
        <div class="tab-content" id="estatisticas">
            <h2 style="margin-bottom: 25px; color: #333;">
                <i class="fas fa-chart-bar"></i> Gest√£o de Estat√≠sticas
            </h2>
            
            <div class="form-row">
                <div class="input-group">
                    <label>Selecionar Clube</label>
                    <select id="clubeEstatisticas">
                        <option value="">Carregando clubes...</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Total de Atletas</label>
                    <input type="number" id="totalAtletas" placeholder="Ex: 40">
                </div>
                <div class="input-group">
                    <label>% Prov√°veis</label>
                    <input type="number" id="pctProvaveis" placeholder="Ex: 35.5" step="0.1" min="0" max="100">
                </div>
                <div class="input-group">
                    <label>M√©dia Pontos</label>
                    <input type="number" id="mediaPontos" placeholder="Ex: 4.58" step="0.01" min="0" max="10">
                </div>
            </div>

            <div class="form-row">
                <div class="input-group">
                    <label>Pre√ßo M√©dio (C$)</label>
                    <input type="number" id="precoMedio" placeholder="Ex: 6.75" step="0.01" min="0">
                </div>
                <div class="input-group">
                    <label>Rating (0-1)</label>
                    <input type="number" id="rating" placeholder="Ex: 0.458" step="0.001" min="0" max="1">
                </div>
                <div class="input-group">
                    <label>Fonte</label>
                    <select id="fonte">
                        <option value="MANUAL">Manual</option>
                        <option value="CARTOLA">Cartola FC</option>
                        <option value="OUTRO">Outro</option>
                    </select>
                </div>
            </div>

            <button class="btn-primary" onclick="salvarEstatisticas()">
                <i class="fas fa-save"></i> Salvar Estat√≠sticas
            </button>

            <!-- Lista de Estat√≠sticas -->
            <div class="loading" id="loadingEstatisticas">
                <i class="fas fa-spinner"></i>
                <div>Carregando estat√≠sticas...</div>
            </div>

            <table class="data-table" id="tableEstatisticas" style="display: none;">
                <thead>
                    <tr>
                        <th>Clube</th>
                        <th>Atletas</th>
                        <th>% Prov√°veis</th>
                        <th>M√©dia Pontos</th>
                        <th>Pre√ßo M√©dio</th>
                        <th>Rating</th>
                        <th>Fonte</th>
                        <th>Atualiza√ß√£o</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="tbodyEstatisticas">
                </tbody>
            </table>
        </div>

        <!-- === ABA CAMPEONATOS === -->
        <div class="tab-content" id="campeonatos">
            <h2 style="margin-bottom: 25px; color: #333;">
                <i class="fas fa-trophy"></i> Gest√£o de Campeonatos
            </h2>
            <p style="padding: 50px; text-align: center; color: #666;">
                <i class="fas fa-construction" style="font-size: 40px; margin-bottom: 15px;"></i><br>
                Funcionalidade em desenvolvimento...
            </p>
        </div>

        <!-- === ABA DASHBOARD === -->
        <div class="tab-content" id="dashboard">
            <h2 style="margin-bottom: 25px; color: #333;">
                <i class="fas fa-tachometer-alt"></i> Dashboard do Sistema
            </h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-database icon" style="color: #9b59b6;"></i>
                    <div class="number" id="tamanhoDb">-</div>
                    <div class="label">Tamanho do Banco</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-calendar icon" style="color: #e74c3c;"></i>
                    <div class="number" id="dadosAntigos">-</div>
                    <div class="label">Dados Mais Antigos</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-source icon" style="color: #2ecc71;"></i>
                    <div class="number" id="fontesPrincipais">-</div>
                    <div class="label">Fontes Principais</div>
                </div>
            </div>
        </div>

        <!-- === ABA BACKUP === -->
        <div class="tab-content" id="backup">
            <h2 style="margin-bottom: 25px; color: #333;">
                <i class="fas fa-download"></i> Backup e Restore
            </h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div style="padding: 30px; background: #f8f9fa; border-radius: 15px;">
                    <h3 style="margin-bottom: 20px; color: #00E38C;">
                        <i class="fas fa-download"></i> Fazer Backup
                    </h3>
                    <p style="margin-bottom: 20px; color: #666;">
                        Baixe uma c√≥pia completa de todos os dados da Central.
                    </p>
                    <button class="btn-primary" onclick="fazerBackup()">
                        <i class="fas fa-download"></i> Gerar Backup
                    </button>
                </div>
                
                <div style="padding: 30px; background: #fff3cd; border-radius: 15px;">
                    <h3 style="margin-bottom: 20px; color: #856404;">
                        <i class="fas fa-upload"></i> Restaurar Backup
                    </h3>
                    <p style="margin-bottom: 20px; color: #666;">
                        Restaure dados de um arquivo de backup anterior.
                    </p>
                    <input type="file" id="backupFile" accept=".json" style="margin-bottom: 15px;">
                    <button class="btn-secondary" onclick="restaurarBackup()">
                        <i class="fas fa-upload"></i> Restaurar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Ajuda -->
    <div id="helpModal" class="help-modal">
        <div class="help-modal-content">
            <div class="help-modal-header">
                <h2 class="help-modal-title" id="helpModalTitle">
                    <i class="fas fa-question-circle"></i>
                    <span id="helpModalTitleText">Ajuda</span>
                </h2>
                <button class="help-modal-close" onclick="fecharAjuda()">&times;</button>
            </div>
            <div class="help-modal-body" id="helpModalBody">
                <!-- Conte√∫do ser√° inserido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- Modal Tabela de Jogos -->
    <div id="jogosModal" class="help-modal">
        <div class="help-modal-content" style="max-width: 1200px; width: 95%;">
            <div class="help-modal-header">
                <h2 class="help-modal-title">
                    <i class="fas fa-table"></i>
                    <span id="jogosModalTitle">Hist√≥rico de Jogos - Flamengo</span>
                </h2>
                <button class="help-modal-close" onclick="fecharTabelaJogos()">&times;</button>
            </div>
            <div class="help-modal-body" style="padding: 20px;">
                <!-- Bot√£o Adicionar Jogo -->
                <div style="margin-bottom: 20px; text-align: right;">
                    <button class="btn-primary" onclick="adicionarNovoJogo()" style="background: linear-gradient(135deg, #00E38C, #00B377);">
                        <i class="fas fa-plus"></i> Adicionar Novo Jogo
                    </button>
                </div>
                
                <!-- Tabela de Jogos -->
                <div class="tabela-jogos-scroll" style="overflow-x: auto; max-height: 400px; overflow-y: auto; border: 1px solid #333; border-radius: 8px;">
                    <table id="tabelaJogos" style="width: 100%; border-collapse: collapse; background: #1a1a1a; border-radius: 8px; overflow: hidden;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #6f42c1, #8b5cf6); color: white;">
                                <th style="padding: 12px; text-align: center;">Data</th>
                                <th style="padding: 12px; text-align: center;">Casa</th>
                                <th style="padding: 12px; text-align: center;">Placar</th>
                                <th style="padding: 12px; text-align: center;">Visitante</th>
                                <th style="padding: 12px; text-align: center;">Local</th>
                                <th style="padding: 12px; text-align: center;">Resultado</th>
                                <th style="padding: 12px; text-align: center;">Pontos</th>
                                <th style="padding: 12px; text-align: center;">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="jogosTableBody">
                            <!-- Jogos ser√£o inseridos aqui -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Resumo Estat√≠stico -->
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                    <h4 style="color: #00E38C; margin-bottom: 10px;">üìä Resumo Estat√≠stico</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #00E38C;" id="totalJogos">0</div>
                            <div style="font-size: 12px; color: #ccc;">Total de Jogos</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #28a745;" id="totalVitorias">0</div>
                            <div style="font-size: 12px; color: #ccc;">Vit√≥rias</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #ffc107;" id="totalEmpates">0</div>
                            <div style="font-size: 12px; color: #ccc;">Empates</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #dc3545;" id="totalDerrotas">0</div>
                            <div style="font-size: 12px; color: #ccc;">Derrotas</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #17a2b8;" id="ppgCalculado">0.00</div>
                            <div style="font-size: 12px; color: #ccc;">PPG</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // === CONFIGURA√á√ïES === 
        const ADMIN_KEY = 'loteca2024admin'; // Chave de acesso padr√£o
        const API_BASE = window.location.port === '5001' ? 'http://127.0.0.1:5001' : window.location.origin; // Base URL para APIs

        // === FUN√á√ÉO PARA MOSTRAR/OCULTAR SENHA ===
        function togglePasswordVisibility() {
            const passwordField = document.getElementById('adminKey');
            const toggleIcon = document.getElementById('togglePassword');
            
            if (passwordField.type === 'password') {
                // Mostrar senha
                passwordField.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
                toggleIcon.style.color = '#00E38C'; // Verde quando vis√≠vel
                toggleIcon.title = 'Ocultar senha';
            } else {
                // Ocultar senha
                passwordField.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
                toggleIcon.style.color = '#666'; // Cinza quando oculta
                toggleIcon.title = 'Mostrar senha';
            }
        }

        // === SISTEMA DE LOGIN ===
        function login() {
            const key = document.getElementById('adminKey').value;
            const errorDiv = document.getElementById('loginError');
            
            if (key === ADMIN_KEY) {
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('adminContainer').style.display = 'block';
                carregarDashboard();
                carregarClubes();
                carregarEstatisticas();
            } else {
                errorDiv.style.display = 'block';
                setTimeout(() => {
                    errorDiv.style.display = 'none';
                }, 3000);
            }
        }

        function logout() {
            document.getElementById('loginContainer').style.display = 'flex';
            document.getElementById('adminContainer').style.display = 'none';
            document.getElementById('adminKey').value = '';
        }

        // === SISTEMA DE ABAS ===
        function showTab(tabName) {
            // Esconder todas as abas
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostrar aba selecionada
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Carregar dados espec√≠ficos da aba
            if (tabName === 'classificacao') {
                console.log('üèÜ [ADMIN] === ABA CLASSIFICA√á√ÉO ATIVADA ===');
                console.log('üéØ [ADMIN] Elemento da aba ativo:', document.getElementById('classificacao'));
                setTimeout(() => {
                    console.log('‚è∞ [ADMIN] Timeout executado - chamando carregarClassificacao...');
                    carregarClassificacao();
                }, 200);
            }
            if (tabName === 'clubes') carregarClubes();
            if (tabName === 'estatisticas') carregarEstatisticas();
            if (tabName === 'dashboard') carregarDashboard();
        }

        // === SISTEMA DE MENSAGENS ===
        function mostrarSucesso(mensagem) {
            mostrarNotificacao(`‚úÖ ${mensagem}`, 'success');
        }

        function mostrarErro(mensagem) {
            mostrarNotificacao(`‚ùå ${mensagem}`, 'error');
        }
        
        function mostrarNotificacao(mensagem, tipo = 'info') {
            // Remover notifica√ß√µes anteriores
            const notificacoesExistentes = document.querySelectorAll('.notification');
            notificacoesExistentes.forEach(n => n.remove());
            
            // Criar nova notifica√ß√£o
            const notification = document.createElement('div');
            notification.className = `notification ${tipo}`;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span>${mensagem}</span>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: white; font-size: 18px; cursor: pointer; padding: 0; margin-left: 10px;">√ó</button>
                </div>
            `;
            
            // Adicionar ao body
            document.body.appendChild(notification);
            
            // Mostrar com anima√ß√£o
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Auto-remover ap√≥s 5 segundos
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.classList.remove('show');
                    setTimeout(() => {
                        if (notification.parentElement) {
                            notification.remove();
                        }
                    }, 300);
                }
            }, 5000);
        }

        // === DASHBOARD ===
        async function carregarDashboard() {
            try {
                const response = await fetch(`${API_BASE}/api/admin/dashboard-stats`);
                const result = await response.json();
                
                if (result.success) {
                    const data = result.data;
                    document.getElementById('totalClubes').textContent = data.total_clubes || '0';
                    document.getElementById('serieAClubes').textContent = data.serie_a || '0';
                    document.getElementById('serieBClubes').textContent = data.serie_b || '0';
                    // Formatar data da √∫ltima sincroniza√ß√£o
                    if (data.ultima_sincronizacao) {
                        const dataObj = new Date(data.ultima_sincronizacao);
                        const dataFormatada = dataObj.toLocaleString('pt-BR', {
                            day: '2-digit',
                            month: '2-digit',
                            year: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        });
                        document.getElementById('ultimaSync').textContent = dataFormatada;
                    } else {
                        document.getElementById('ultimaSync').textContent = 'Nunca';
                    }
                } else {
                    mostrarErro('Erro ao carregar dashboard: ' + result.message);
                }
            } catch (error) {
                console.error('Erro ao carregar dashboard:', error);
                mostrarErro('Erro de conex√£o com o servidor');
            }
        }

        // === GEST√ÉO DE CLUBES ===
        let clubesData = [];

        async function carregarClubes() {
            const loading = document.getElementById('loadingClubes');
            const table = document.getElementById('tableClubes');
            
            loading.style.display = 'block';
            table.style.display = 'none';
            
            try {
                const response = await fetch(`${API_BASE}/api/admin/clubes`);
                const result = await response.json();
                
                if (result.success) {
                    clubesData = result.data;
                    renderizarClubes(clubesData);
                    carregarClubesSelect();
                    
                    loading.style.display = 'none';
                    table.style.display = 'table';
                } else {
                    mostrarErro('Erro ao carregar clubes: ' + result.message);
                    loading.style.display = 'none';
                }
            } catch (error) {
                console.error('Erro ao carregar clubes:', error);
                mostrarErro('Erro de conex√£o ao carregar clubes');
                loading.style.display = 'none';
            }
        }

        function renderizarClubes(clubes) {
            const tbody = document.getElementById('tbodyClubes');
            tbody.innerHTML = '';
            
            clubes.forEach(clube => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        ${clube.escudo_60x60 ? 
                            `<img src="${clube.escudo_60x60}" class="escudo-img" alt="${clube.abreviacao}">` : 
                            `<div style="width:40px;height:40px;background:${clube.cor_primaria || '#ccc'};border-radius:50%;"></div>`
                        }
                    </td>
                    <td>${clube.nome_fantasia}</td>
                    <td>${clube.abreviacao}</td>
                    <td>${clube.estado || '-'}</td>
                    <td><span class="status-badge ${clube.serie?.toLowerCase().replace(' ', '-')}">${clube.serie || '-'}</span></td>
                    <td>${clube.id}</td>
                    <td>
                        <button class="btn-secondary" onclick="editarClube(${clube.id})" style="margin-right: 5px;">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-danger" onclick="excluirClube(${clube.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function filtrarClubes() {
            const searchTerm = document.getElementById('searchClubes').value.toLowerCase();
            const clubesFiltrados = clubesData.filter(clube => 
                clube.nome_fantasia.toLowerCase().includes(searchTerm) ||
                clube.abreviacao.toLowerCase().includes(searchTerm) ||
                (clube.estado && clube.estado.toLowerCase().includes(searchTerm))
            );
            renderizarClubes(clubesFiltrados);
        }

        function carregarClubesSelect() {
            const select = document.getElementById('clubeEstatisticas');
            select.innerHTML = '<option value="">Selecione um clube...</option>';
            
            clubesData.forEach(clube => {
                const option = document.createElement('option');
                option.value = clube.id;
                option.textContent = `${clube.nome_fantasia} (${clube.abreviacao})`;
                select.appendChild(option);
            });
        }

        async function salvarClube() {
            const clube = {
                nome_fantasia: document.getElementById('nomeFantasia').value,
                abreviacao: document.getElementById('abreviacao').value,
                estado: document.getElementById('estado').value,
                serie: document.getElementById('serie').value,
                id: document.getElementById('cartolaId').value,
                escudo_url: document.getElementById('escudoUrl').value,
                cor_primaria: document.getElementById('corPrimaria').value,
                cor_secundaria: document.getElementById('corSecundaria').value,
                admin_key: ADMIN_KEY
            };
            
            if (!clube.nome_fantasia || !clube.abreviacao) {
                mostrarErro('Nome e abrevia√ß√£o s√£o obrigat√≥rios');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/api/admin/clubes`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(clube)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    mostrarSucesso('Clube salvo com sucesso!');
                    limparFormClube();
                    carregarClubes();
                    carregarDashboard(); // Atualizar estat√≠sticas
                } else {
                    mostrarErro('Erro ao salvar clube: ' + result.message);
                }
            } catch (error) {
                console.error('Erro ao salvar clube:', error);
                mostrarErro('Erro de conex√£o ao salvar clube');
            }
        }

        function limparFormClube() {
            document.getElementById('nomeFantasia').value = '';
            document.getElementById('abreviacao').value = '';
            document.getElementById('estado').value = '';
            document.getElementById('serie').value = '';
            document.getElementById('cartolaId').value = '';
            document.getElementById('escudoUrl').value = '';
            document.getElementById('corPrimaria').value = '#FF0000';
            document.getElementById('corSecundaria').value = '#000000';
        }

        function editarClube(id) {
            const clube = clubesData.find(c => c.id === id);
            if (clube) {
                document.getElementById('nomeFantasia').value = clube.nome_fantasia;
                document.getElementById('abreviacao').value = clube.abreviacao;
                document.getElementById('estado').value = clube.estado || '';
                document.getElementById('serie').value = clube.serie || '';
                document.getElementById('cartolaId').value = clube.id;
                document.getElementById('escudoUrl').value = clube.escudo_60x60 || '';
                document.getElementById('corPrimaria').value = clube.cor_primaria || '#FF0000';
                document.getElementById('corSecundaria').value = clube.cor_secundaria || '#000000';
            }
        }

        async function excluirClube(id) {
            if (confirm('Tem certeza que deseja excluir este clube?')) {
                try {
                    const response = await fetch(`${API_BASE}/api/admin/clubes/${id}`, {
                        method: 'DELETE',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ admin_key: ADMIN_KEY })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        mostrarSucesso('Clube exclu√≠do com sucesso!');
                        carregarClubes();
                        carregarDashboard(); // Atualizar estat√≠sticas
                    } else {
                        mostrarErro('Erro ao excluir clube: ' + result.message);
                    }
                } catch (error) {
                    console.error('Erro ao excluir clube:', error);
                    mostrarErro('Erro de conex√£o ao excluir clube');
                }
            }
        }

        // === GEST√ÉO DE ESTAT√çSTICAS ===
        let estatisticasData = [];

        async function carregarEstatisticas() {
            const loading = document.getElementById('loadingEstatisticas');
            const table = document.getElementById('tableEstatisticas');
            
            loading.style.display = 'block';
            table.style.display = 'none';
            
            try {
                const response = await fetch(`${API_BASE}/api/admin/estatisticas`);
                const result = await response.json();
                
                if (result.success) {
                    estatisticasData = result.data;
                    renderizarEstatisticas(estatisticasData);
                    
                    loading.style.display = 'none';
                    table.style.display = 'table';
                } else {
                    mostrarErro('Erro ao carregar estat√≠sticas: ' + result.message);
                    loading.style.display = 'none';
                }
            } catch (error) {
                console.error('Erro ao carregar estat√≠sticas:', error);
                mostrarErro('Erro de conex√£o ao carregar estat√≠sticas');
                loading.style.display = 'none';
            }
        }

        function renderizarEstatisticas(estatisticas) {
            const tbody = document.getElementById('tbodyEstatisticas');
            tbody.innerHTML = '';
            
            estatisticas.forEach(stat => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${stat.nome_fantasia || stat.clube_nome}</td>
                    <td>${stat.total_atletas || '-'}</td>
                    <td>${stat.pct_provaveis ? stat.pct_provaveis.toFixed(1) + '%' : '-'}</td>
                    <td>${stat.media_pontos_elenco ? stat.media_pontos_elenco.toFixed(2) : '-'}</td>
                    <td>${stat.preco_medio ? 'C$ ' + stat.preco_medio.toFixed(2) : '-'}</td>
                    <td>${stat.rating ? stat.rating.toFixed(3) : '-'}</td>
                    <td><span class="status-badge">${stat.fonte}</span></td>
                    <td>${stat.data_atualizacao ? new Date(stat.data_atualizacao).toLocaleString('pt-BR') : '-'}</td>
                    <td>
                        <button class="btn-secondary" onclick="editarEstatisticas(${stat.clube_id})" style="margin-right: 5px;">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-danger" onclick="excluirEstatisticas(${stat.clube_id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        async function salvarEstatisticas() {
            const estatisticas = {
                clube_id: document.getElementById('clubeEstatisticas').value,
                total_atletas: document.getElementById('totalAtletas').value,
                pct_provaveis: document.getElementById('pctProvaveis').value,
                media_pontos_elenco: document.getElementById('mediaPontos').value,
                preco_medio: document.getElementById('precoMedio').value,
                rating: document.getElementById('rating').value,
                fonte: document.getElementById('fonte').value,
                admin_key: ADMIN_KEY
            };
            
            if (!estatisticas.clube_id) {
                mostrarErro('Selecione um clube');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/api/admin/estatisticas`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(estatisticas)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    mostrarSucesso('Estat√≠sticas salvas com sucesso!');
                    carregarEstatisticas();
                    carregarDashboard(); // Atualizar dashboard
                } else {
                    mostrarErro('Erro ao salvar estat√≠sticas: ' + result.message);
                }
            } catch (error) {
                console.error('Erro ao salvar estat√≠sticas:', error);
                mostrarErro('Erro de conex√£o ao salvar estat√≠sticas');
            }
        }

        // Fun√ß√£o limparFormEstatisticas removida - n√£o √© mais necess√°ria

        function editarEstatisticas(clubeId) {
            const stat = estatisticasData.find(s => s.clube_id === clubeId);
            if (stat) {
                document.getElementById('clubeEstatisticas').value = stat.clube_id;
                document.getElementById('totalAtletas').value = stat.total_atletas || '';
                document.getElementById('pctProvaveis').value = stat.pct_provaveis || '';
                document.getElementById('mediaPontos').value = stat.media_pontos_elenco || '';
                document.getElementById('precoMedio').value = stat.preco_medio || '';
                document.getElementById('rating').value = stat.rating || '';
                document.getElementById('fonte').value = stat.fonte || 'MANUAL';
            }
        }

        function excluirEstatisticas(clubeId) {
            if (confirm('Tem certeza que deseja excluir estas estat√≠sticas?')) {
                try {
                    // Aqui seria a chamada real para a API
                    mostrarSucesso('Estat√≠sticas exclu√≠das com sucesso!');
                    carregarEstatisticas();
                } catch (error) {
                    console.error('Erro ao excluir estat√≠sticas:', error);
                    mostrarErro('Erro ao excluir estat√≠sticas');
                }
            }
        }

        // === FUN√á√ïES DA ABA CLASSIFICA√á√ÉO ===
        function alterarCampeonato() {
            const campeonato = document.getElementById('campeonatoSelect').value;
            console.log(`üîÑ [ADMIN] Alterando para: ${campeonato}`);
            
            // Limpar tabela atual
            const bodyEl = document.getElementById('classificacaoBody');
            if (bodyEl) {
                bodyEl.innerHTML = '<tr><td colspan="12" style="text-align: center; padding: 20px; color: #666; font-style: italic;">üîÑ Carregando nova classifica√ß√£o...</td></tr>';
            }
            
            // Carregar nova classifica√ß√£o
            setTimeout(() => {
                carregarClassificacao();
            }, 300);
        }
        
        async function carregarClassificacao() {
            console.log('üîÑ [ADMIN] === INICIANDO CARREGAMENTO DA CLASSIFICA√á√ÉO ===');
            
            const campeonatoSelect = document.getElementById('campeonatoSelect');
            const loadingEl = document.getElementById('loadingClassificacao');
            const bodyEl = document.getElementById('classificacaoBody');
            
            console.log('üéØ [ADMIN] Elementos DOM encontrados:');
            console.log('   - campeonatoSelect:', campeonatoSelect ? 'OK' : 'MISSING');
            console.log('   - loadingEl:', loadingEl ? 'OK' : 'MISSING');
            console.log('   - bodyEl:', bodyEl ? 'OK' : 'MISSING');
            
            const campeonato = campeonatoSelect ? campeonatoSelect.value : 'serie-a';
            let adminKey = localStorage.getItem('admin_key');
            
            // FOR√áAR admin key se n√£o existir
            if (!adminKey) {
                console.warn('‚ö†Ô∏è [ADMIN] Admin key n√£o encontrada no localStorage! Usando padr√£o...');
                adminKey = 'loteca2024admin';
                localStorage.setItem('admin_key', adminKey);
            }
            
            console.log('üîë [ADMIN] Configura√ß√µes:');
            console.log('   - campeonato:', campeonato);
            console.log('   - adminKey:', adminKey ? 'OK (***' + adminKey.slice(-4) + ')' : 'MISSING');
            console.log('   - adminKey completa:', adminKey);
            
            if (loadingEl) {
                loadingEl.style.display = 'block';
                console.log('üìä [ADMIN] Loading exibido');
            }
            
            if (bodyEl) {
                bodyEl.innerHTML = '';
                console.log('üßπ [ADMIN] Tabela limpa');
            }
            
            try {
                const requestData = {
                    admin_key: adminKey,
                    campeonato: campeonato
                };
                
                console.log('üì§ [ADMIN] Enviando requisi√ß√£o...');
                console.log('   - URL: /api/admin/classificacao');
                console.log('   - Method: POST');
                console.log('   - Body:', JSON.stringify(requestData));
                
                const response = await fetch('/api/admin/classificacao', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(requestData)
                });
                
                console.log('üì• [ADMIN] Resposta recebida:');
                console.log('   - Status:', response.status);
                console.log('   - OK:', response.ok);
                console.log('   - StatusText:', response.statusText);
                
                if (loadingEl) {
                    loadingEl.style.display = 'none';
                    console.log('üìä [ADMIN] Loading escondido');
                }
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('üìã [ADMIN] Dados JSON recebidos:');
                console.log('   - Success:', data.success);
                console.log('   - Total:', data.total);
                console.log('   - Campeonato:', data.campeonato);
                console.log('   - Classifica√ß√£o length:', data.classificacao ? data.classificacao.length : 'NULL');
                
                if (data.success && data.classificacao && data.classificacao.length > 0) {
                    console.log('‚úÖ [ADMIN] Sucesso! Renderizando tabela...');
                    console.log('üèÜ [ADMIN] Primeiros 3 times:');
                    data.classificacao.slice(0, 3).forEach((time, i) => {
                        console.log(`   ${i+1}. ${time.time} - ${time.pontos} pts`);
                    });
                    
                    renderizarClassificacao(data.classificacao);
                    console.log('üé® [ADMIN] Renderiza√ß√£o conclu√≠da!');
                } else {
                    console.warn('‚ö†Ô∏è [ADMIN] API retornou dados vazios. Usando dados mock...');
                    
                    // Se for S√©rie B e API falhou, usar dados mock
                    if (campeonato === 'serie-b') {
                        console.log('ü•à [ADMIN] Carregando dados mock da S√©rie B...');
                        const dadosSerieB = [
                            {id: 1, time: 'Santos', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 1, ultimos_jogos: 'NNNNN'},
                            {id: 2, time: 'Novorizontino', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 2, ultimos_jogos: 'NNNNN'},
                            {id: 3, time: 'Sport', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 3, ultimos_jogos: 'NNNNN'},
                            {id: 4, time: 'Mirassol', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 4, ultimos_jogos: 'NNNNN'},
                            {id: 5, time: 'Cear√°', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 5, ultimos_jogos: 'NNNNN'},
                            {id: 6, time: 'Vila Nova', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 6, ultimos_jogos: 'NNNNN'},
                            {id: 7, time: 'Am√©rica-MG', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 7, ultimos_jogos: 'NNNNN'},
                            {id: 8, time: 'Oper√°rio', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 8, ultimos_jogos: 'NNNNN'},
                            {id: 9, time: 'Goi√°s', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 9, ultimos_jogos: 'NNNNN'},
                            {id: 10, time: 'Ava√≠', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 10, ultimos_jogos: 'NNNNN'},
                            {id: 11, time: 'Paysandu', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 11, ultimos_jogos: 'NNNNN'},
                            {id: 12, time: 'Coritiba', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 12, ultimos_jogos: 'NNNNN'},
                            {id: 13, time: 'Amazonas', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 13, ultimos_jogos: 'NNNNN'},
                            {id: 14, time: 'Chapecoense', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 14, ultimos_jogos: 'NNNNN'},
                            {id: 15, time: 'CRB', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 15, ultimos_jogos: 'NNNNN'},
                            {id: 16, time: 'Ponte Preta', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 16, ultimos_jogos: 'NNNNN'},
                            {id: 17, time: 'Ituano', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 17, ultimos_jogos: 'NNNNN'},
                            {id: 18, time: 'Botafogo-SP', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 18, ultimos_jogos: 'NNNNN'},
                            {id: 19, time: 'Brusque', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 19, ultimos_jogos: 'NNNNN'},
                            {id: 20, time: 'Guarani', pontos: 0, jogos: 0, vitorias: 0, empates: 0, derrotas: 0, gols_pro: 0, gols_contra: 0, saldo_gols: 0, aproveitamento: 0, posicao: 20, ultimos_jogos: 'NNNNN'}
                        ];
                        
                        renderizarClassificacao(dadosSerieB);
                        console.log('üé® [ADMIN] S√©rie B renderizada com dados mock!');
                        mostrarNotificacao('üìã S√©rie B carregada! Edite os dados conforme necess√°rio.', 'info');
                    } else {
                        console.error('‚ùå [ADMIN] Erro no response:', data.message || 'Dados inv√°lidos');
                        mostrarErro('Erro ao carregar classifica√ß√£o: ' + (data.message || 'Dados inv√°lidos'));
                    }
                }
            } catch (error) {
                if (loadingEl) {
                    loadingEl.style.display = 'none';
                }
                console.error('üí• [ADMIN] Erro na requisi√ß√£o:', error);
                console.error('üìÑ [ADMIN] Error stack:', error.stack);
                mostrarErro('Erro ao carregar classifica√ß√£o: ' + error.message);
            }
            
            console.log('üèÅ [ADMIN] === CARREGAMENTO FINALIZADO ===');
        }
        
        function renderizarClassificacao(classificacao) {
            console.log('üé® [ADMIN] === INICIANDO RENDERIZA√á√ÉO ===');
            console.log('üìä [ADMIN] Dados recebidos:', classificacao);
            console.log('üìä [ADMIN] Tipo:', typeof classificacao);
            console.log('üìä [ADMIN] √â array:', Array.isArray(classificacao));
            console.log('üìä [ADMIN] Length:', classificacao ? classificacao.length : 'N/A');
            
            const bodyEl = document.getElementById('classificacaoBody');
            console.log('üéØ [ADMIN] Body element:', bodyEl ? 'OK' : 'MISSING');
            
            if (!bodyEl) {
                console.error('‚ùå [ADMIN] Element classificacaoBody n√£o encontrado!');
                return;
            }
            
            bodyEl.innerHTML = '';
            console.log('üßπ [ADMIN] Tbody limpo');
            
            if (!classificacao || classificacao.length === 0) {
                console.warn('‚ö†Ô∏è [ADMIN] Nenhum dado para renderizar');
                bodyEl.innerHTML = '<tr><td colspan="12" style="text-align: center; padding: 20px; color: #666;">Nenhum dado encontrado</td></tr>';
                return;
            }
            
            // Detectar tipo de campeonato baseado nos campos
            const campeonato = document.getElementById('campeonatoSelect').value;
            const isPremierLeague = campeonato === 'premier-league';
            const isLaLiga = campeonato === 'la-liga';
            const isLigue1 = campeonato === 'ligue1';
            const isInternacional = isPremierLeague || isLaLiga || isLigue1;
            
            console.log('‚úÖ [ADMIN] Renderizando', classificacao.length, 'times...');
            console.log('üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø [ADMIN] Premier League:', isPremierLeague);
            console.log('üá™üá∏ [ADMIN] La Liga:', isLaLiga);
            console.log('üá´üá∑ [ADMIN] Ligue 1:', isLigue1);
            console.log('üåç [ADMIN] Internacional:', isInternacional);
            
            classificacao.forEach((time, index) => {
                console.log(`üèÜ [ADMIN] Renderizando time ${index + 1}:`, time);
                const row = document.createElement('tr');
                
                // Determinar zona (libertadores, sul-americana, rebaixamento)
                const zonaClass = time.zona ? `zona-${time.zona.replace('-', '')}` : '';
                
                row.className = `team-row ${zonaClass}`;
                
                if (isInternacional) {
                    // Renderiza√ß√£o espec√≠fica para campeonatos internacionais (Premier League e La Liga)
                    row.innerHTML = `
                        <td style="font-weight: bold; background: #e8f4f8; color: #1a202c; border: 1px solid #cbd5e0;">${time.posicao}</td>
                        <td style="position: relative;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span class="editable" contenteditable="true" data-field="clube" data-id="${time.id}" 
                                      style="font-weight: bold; background: #e0f2fe; color: #1a202c; border: 2px dashed #0ea5e9; padding: 8px; font-size: 14px; min-width: 120px; display: inline-block;" 
                                      data-original="${time.clube}">${time.clube}</span>
                                ${time.zona ? `<span class="zona-badge zona-${time.zona.replace('-', '')}" style="background: #10b981; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">${time.zona}</span>` : ''}
                                ${time.badge ? `<span class="badge-especial" style="background: #dc2626; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">${time.badge}</span>` : ''}
                            </div>
                        </td>
                        <td class="editable" contenteditable="true" data-field="pts" data-id="${time.id}" 
                            style="font-weight: bold; color: #1e40af; background: #fef9e7; border: 2px dashed #f59e0b; padding: 8px; text-align: center; font-size: 14px;" 
                            data-original="${time.pts}">${time.pts}</td>
                        <td class="editable" contenteditable="true" data-field="pj" data-id="${time.id}" 
                            style="color: #374151; background: #f3f4f6; border: 2px dashed #9ca3af; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.pj}">${time.pj}</td>
                        <td class="editable" contenteditable="true" data-field="vit" data-id="${time.id}" 
                            style="color: #065f46; background: #ecfdf5; border: 2px dashed #10b981; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.vit}">${time.vit}</td>
                        <td class="editable" contenteditable="true" data-field="e" data-id="${time.id}" 
                            style="color: #92400e; background: #fffbeb; border: 2px dashed #f59e0b; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.e}">${time.e}</td>
                        <td class="editable" contenteditable="true" data-field="der" data-id="${time.id}" 
                            style="color: #991b1b; background: #fef2f2; border: 2px dashed #ef4444; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.der}">${time.der}</td>
                        <td class="editable" contenteditable="true" data-field="gm" data-id="${time.id}" 
                            style="color: #065f46; background: #ecfdf5; border: 2px dashed #10b981; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.gm}">${time.gm}</td>
                        <td class="editable" contenteditable="true" data-field="gc" data-id="${time.id}" 
                            style="color: #991b1b; background: #fef2f2; border: 2px dashed #ef4444; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.gc}">${time.gc}</td>
                        <td style="font-weight: bold; color: ${time.sg >= 0 ? '#065f46' : '#991b1b'}; background: #e8f4f8; text-align: center; border: 1px solid #cbd5e0; font-size: 14px;">${time.sg >= 0 ? '+' : ''}${time.sg}</td>
                        <td style="background: #e8f4f8; border: 1px solid #cbd5e0;">
                            <div class="editable" contenteditable="true" data-field="zona" data-id="${time.id}" 
                                 style="padding: 4px; text-align: center; font-size: 12px; font-weight: bold;" 
                                 data-original="${time.zona || ''}">${time.zona || '-'}</div>
                        </td>
                        <td style="background: #e8f4f8; border: 1px solid #cbd5e0;">
                            <div style="display: flex; gap: 3px; justify-content: center;" data-time-id="${time.id}">
                                ${(time.ultimas_5 || 'NNNNN').split('').map((result, index) => 
                                    `<span class="resultado-bolinha clickable" 
                                           data-time-id="${time.id}" 
                                           data-jogo-index="${index}" 
                                           data-resultado="${result}"
                                           onclick="alterarResultado(this)"
                                           style="width: 18px; height: 18px; border-radius: 50%; display: inline-block; font-size: 10px; text-align: center; line-height: 18px; color: white; font-weight: bold; cursor: pointer; transition: all 0.2s ease; border: 1px solid #374151; background: ${getCorResultado(result)};"
                                           title="Clique para alterar: ${getDescricaoResultado(result)}">${result}</span>`
                                ).join('')}
                            </div>
                        </td>
                    `;
                } else {
                    // Renderiza√ß√£o para Brasileir√£o (S√©rie A e B)
                    row.innerHTML = `
                        <td style="font-weight: bold; background: #e8f4f8; color: #1a202c; border: 1px solid #cbd5e0;">${time.posicao}</td>
                        <td style="position: relative;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span class="editable" contenteditable="true" data-field="time" data-id="${time.id}" 
                                      style="font-weight: bold; background: #e0f2fe; color: #1a202c; border: 2px dashed #0ea5e9; padding: 8px; font-size: 14px; min-width: 120px; display: inline-block;" 
                                      data-original="${time.time}">${time.time}</span>
                                ${time.zona ? `<span class="zona-badge zona-${time.zona.replace('-', '')}" style="background: #10b981; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">${time.zona}</span>` : ''}
                            </div>
                        </td>
                        <td class="editable" contenteditable="true" data-field="pontos" data-id="${time.id}" 
                            style="font-weight: bold; color: #1e40af; background: #fef9e7; border: 2px dashed #f59e0b; padding: 8px; text-align: center; font-size: 14px;" 
                            data-original="${time.pontos}">${time.pontos}</td>
                        <td class="editable" contenteditable="true" data-field="jogos" data-id="${time.id}" 
                            style="color: #374151; background: #f3f4f6; border: 2px dashed #9ca3af; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.jogos}">${time.jogos}</td>
                        <td class="editable" contenteditable="true" data-field="vitorias" data-id="${time.id}" 
                            style="color: #065f46; background: #ecfdf5; border: 2px dashed #10b981; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.vitorias}">${time.vitorias}</td>
                        <td class="editable" contenteditable="true" data-field="empates" data-id="${time.id}" 
                            style="color: #92400e; background: #fffbeb; border: 2px dashed #f59e0b; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.empates}">${time.empates}</td>
                        <td class="editable" contenteditable="true" data-field="derrotas" data-id="${time.id}" 
                            style="color: #991b1b; background: #fef2f2; border: 2px dashed #ef4444; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.derrotas}">${time.derrotas}</td>
                        <td class="editable" contenteditable="true" data-field="gols_pro" data-id="${time.id}" 
                            style="color: #065f46; background: #ecfdf5; border: 2px dashed #10b981; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.gols_pro}">${time.gols_pro}</td>
                        <td class="editable" contenteditable="true" data-field="gols_contra" data-id="${time.id}" 
                            style="color: #991b1b; background: #fef2f2; border: 2px dashed #ef4444; padding: 8px; text-align: center; font-size: 14px; font-weight: 600;" 
                            data-original="${time.gols_contra}">${time.gols_contra}</td>
                        <td style="font-weight: bold; color: ${time.saldo_gols >= 0 ? '#065f46' : '#991b1b'}; background: #e8f4f8; text-align: center; border: 1px solid #cbd5e0; font-size: 14px;">${time.saldo_gols >= 0 ? '+' : ''}${time.saldo_gols}</td>
                        <td style="font-weight: bold; background: #e8f4f8; color: #1a202c; text-align: center; border: 1px solid #cbd5e0; font-size: 14px;">${time.aproveitamento}%</td>
                        <td style="background: #e8f4f8; border: 1px solid #cbd5e0;">
                            <div style="display: flex; gap: 5px; justify-content: center;" data-time-id="${time.id}">
                                ${(time.ultimos_jogos || 'NNNNN').split('').map((result, index) => 
                                    `<span class="resultado-bolinha clickable" 
                                           data-time-id="${time.id}" 
                                           data-jogo-index="${index}" 
                                           data-resultado="${result}"
                                           onclick="alterarResultado(this)"
                                           style="width: 20px; height: 20px; border-radius: 50%; display: inline-block; font-size: 11px; text-align: center; line-height: 20px; color: white; font-weight: bold; cursor: pointer; transition: all 0.2s ease; border: 2px solid #374151; background: ${getCorResultado(result)};"
                                           title="Clique para alterar: ${getDescricaoResultado(result)}">${result}</span>`
                                ).join('')}
                            </div>
                        </td>
                    `;
                }
                
                bodyEl.appendChild(row);
                console.log(`‚úÖ [ADMIN] Time ${index + 1} adicionado ao DOM`);
            });
            
            // Adicionar eventos de edi√ß√£o
            adicionarEventosEdicao();
            
            console.log(`üéâ [ADMIN] === RENDERIZA√á√ÉO CONCLU√çDA ===`);
            console.log(`üìä [ADMIN] Total de times renderizados: ${classificacao.length}`);
            console.log(`üéØ [ADMIN] Filhos na tabela:`, bodyEl.children.length);
        }
        
        function adicionarEventosEdicao() {
            console.log('üéÆ [ADMIN] Adicionando eventos de edi√ß√£o...');
            
            const editableCells = document.querySelectorAll('.editable');
            
            editableCells.forEach(cell => {
                // Evento ao focar (come√ßar edi√ß√£o)
                cell.addEventListener('focus', function() {
                    this.style.background = '#ffffcc';
                    this.style.boxShadow = '0 0 5px #ffd700';
                    this.style.border = '2px solid #ffd700';
                    console.log(`‚úèÔ∏è [ADMIN] Editando ${this.dataset.field} do time ID ${this.dataset.id}`);
                });
                
                // Evento ao sair do foco (finalizar edi√ß√£o)
                cell.addEventListener('blur', function() {
                    const originalValue = this.dataset.original;
                    const newValue = this.textContent.trim();
                    
                    if (newValue !== originalValue) {
                        // Valor foi alterado
                        this.style.background = '#d4edda'; // Verde claro
                        this.style.border = '2px solid #28a745';
                        this.classList.add('modified');
                        console.log(`üíæ [ADMIN] Modificado: ${this.dataset.field} = ${newValue} (era ${originalValue})`);
                        
                        // Marcar para salvamento
                        marcarParaSalvamento(this);
                    } else {
                        // Valor n√£o mudou, voltar ao normal
                        restaurarEstiloOriginal(this);
                    }
                });
                
                // Evento ao pressionar Enter (salvar imediato)
                cell.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        this.blur(); // For√ßa o blur para processar a altera√ß√£o
                        setTimeout(() => {
                            salvarAlteracaoImediata(this);
                        }, 100);
                    }
                });
            });
            
            console.log(`‚úÖ [ADMIN] Eventos adicionados a ${editableCells.length} c√©lulas`);
        }
        
        function restaurarEstiloOriginal(cell) {
            const field = cell.dataset.field;
            
            // Cores espec√≠ficas por campo (MELHORADAS PARA LEGIBILIDADE)
            const estilos = {
                'time': {
                    background: '#e0f2fe',
                    border: '2px dashed #0ea5e9',
                    color: '#1a202c',
                    fontWeight: 'bold'
                },
                'pontos': {
                    background: '#fef9e7',
                    border: '2px dashed #f59e0b',
                    color: '#1e40af',
                    fontWeight: 'bold'
                },
                'jogos': {
                    background: '#f3f4f6',
                    border: '2px dashed #9ca3af',
                    color: '#374151',
                    fontWeight: '600'
                },
                'vitorias': {
                    background: '#ecfdf5',
                    border: '2px dashed #10b981',
                    color: '#065f46',
                    fontWeight: '600'
                },
                'empates': {
                    background: '#fffbeb',
                    border: '2px dashed #f59e0b',
                    color: '#92400e',
                    fontWeight: '600'
                },
                'derrotas': {
                    background: '#fef2f2',
                    border: '2px dashed #ef4444',
                    color: '#991b1b',
                    fontWeight: '600'
                },
                'gols_pro': {
                    background: '#ecfdf5',
                    border: '2px dashed #10b981',
                    color: '#065f46',
                    fontWeight: '600'
                },
                'gols_contra': {
                    background: '#fef2f2',
                    border: '2px dashed #ef4444',
                    color: '#991b1b',
                    fontWeight: '600'
                }
            };
            
            const estilo = estilos[field] || estilos['jogos'];
            
            cell.style.background = estilo.background;
            cell.style.border = estilo.border;
            cell.style.color = estilo.color;
            cell.style.fontWeight = estilo.fontWeight;
            cell.style.fontSize = '14px';
            cell.style.boxShadow = 'none';
            cell.classList.remove('modified');
        }
        
        function marcarParaSalvamento(cell) {
            // Adicionar √† lista de modifica√ß√µes pendentes
            if (!window.modificacoesPendentes) {
                window.modificacoesPendentes = new Set();
            }
            
            const key = `${cell.dataset.id}-${cell.dataset.field}`;
            window.modificacoesPendentes.add(key);
            
            // Atualizar contador de modifica√ß√µes
            atualizarContadorModificacoes();
        }
        
        function atualizarContadorModificacoes() {
            const count = window.modificacoesPendentes ? window.modificacoesPendentes.size : 0;
            const btnSalvar = document.querySelector('button[onclick="salvarClassificacao()"]');
            
            if (btnSalvar) {
                if (count > 0) {
                    btnSalvar.innerHTML = `<i class="fas fa-save"></i> üíæ Salvar Altera√ß√µes (${count})`;
                    btnSalvar.style.background = '#28a745';
                    btnSalvar.style.animation = 'pulse 1s infinite';
                } else {
                    btnSalvar.innerHTML = `<i class="fas fa-save"></i> Salvar Altera√ß√µes`;
                    btnSalvar.style.background = '';
                    btnSalvar.style.animation = 'none';
                }
            }
        }
        
        async function salvarAlteracaoImediata(cell) {
            console.log('üíæ [ADMIN] Salvamento imediato ativado!');
            
            const campeonato = document.getElementById('campeonatoSelect').value || 'serie-a';
            const updates = [{
                id: parseInt(cell.dataset.id),
                field: cell.dataset.field,
                value: cell.textContent.trim()
            }];
            
            console.log(`üéØ [ADMIN] Salvando na ${campeonato}: ${cell.dataset.field} = ${cell.textContent.trim()}`);
            
            try {
                const response = await fetch('/api/admin/classificacao/salvar', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        admin_key: localStorage.getItem('admin_key'),
                        campeonato: campeonato,
                        updates: updates
                    })
                });
                
                const data = await response.json();
                if (data.success) {
                    // Salvo com sucesso
                    cell.style.background = '#d1f2eb'; // Verde mais claro
                    cell.style.border = '2px solid #28a745';
                    cell.dataset.original = cell.textContent.trim(); // Atualizar valor original
                    
                    // Remover da lista de pendentes
                    const key = `${cell.dataset.id}-${cell.dataset.field}`;
                    if (window.modificacoesPendentes) {
                        window.modificacoesPendentes.delete(key);
                        atualizarContadorModificacoes();
                    }
                    
                    console.log('‚úÖ [ADMIN] Salvo com sucesso!');
                    mostrarNotificacao('‚úÖ Altera√ß√£o salva!', 'success');
                } else {
                    console.error('‚ùå [ADMIN] Erro ao salvar:', data.message);
                    mostrarNotificacao('‚ùå Erro ao salvar: ' + data.message, 'error');
                }
            } catch (error) {
                console.error('üí• [ADMIN] Erro na requisi√ß√£o:', error);
                mostrarNotificacao('üí• Erro de conex√£o!', 'error');
            }
        }
        
        async function salvarClassificacao() {
            const campeonato = document.getElementById('campeonatoSelect').value || 'serie-a';
            const editableCells = document.querySelectorAll('.editable[data-field]');
            const updates = [];
            
            editableCells.forEach(cell => {
                const value = cell.textContent.trim();
                const originalValue = cell.dataset.original;
                
                // Incluir tanto n√∫meros quanto texto (para nomes de times)
                if (value && value !== originalValue) {
                    updates.push({
                        id: parseInt(cell.dataset.id),
                        field: cell.dataset.field,
                        value: cell.dataset.field === 'time' || cell.dataset.field === 'clube' ? value : (isNaN(value) ? value : parseInt(value))
                    });
                }
            });
            
            console.log(`üíæ [ADMIN] Salvando ${updates.length} altera√ß√µes na ${campeonato}`);
            
            try {
                const response = await fetch('/api/admin/classificacao/salvar', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        admin_key: localStorage.getItem('admin_key'),
                        campeonato: campeonato,
                        updates: updates
                    })
                });
                
                const data = await response.json();
                if (data.success) {
                    mostrarSucesso('Classifica√ß√£o salva com sucesso!');
                    carregarClassificacao(); // Recarregar para atualizar saldo de gols e aproveitamento
                    atualizarDashboard(); // Atualizar estat√≠sticas do dashboard
                } else {
                    mostrarErro('Erro ao salvar: ' + data.message);
                }
            } catch (error) {
                console.error('Erro ao salvar classifica√ß√£o:', error);
                mostrarErro('Erro ao salvar classifica√ß√£o');
            }
        }
        
        // === FUN√á√ÉO DE TESTE DEBUG REMOVIDA ===
        
        // === FUN√á√ïES DAS BOLINHAS DOS √öLTIMOS JOGOS ===
        function getCorResultado(resultado) {
            switch (resultado) {
                case 'V': return '#16a34a'; // Verde
                case 'E': return '#d97706'; // Amarelo/Laranja
                case 'D': return '#dc2626'; // Vermelho
                case 'N': return '#6b7280'; // Cinza
                default: return '#6b7280';
            }
        }
        
        function getDescricaoResultado(resultado) {
            switch (resultado) {
                case 'V': return 'Vit√≥ria';
                case 'E': return 'Empate';
                case 'D': return 'Derrota';
                case 'N': return 'N√£o jogou';
                default: return 'Indefinido';
            }
        }
        
        function alterarResultado(bolinha) {
            const resultadoAtual = bolinha.dataset.resultado;
            const timeId = bolinha.dataset.timeId;
            const jogoIndex = parseInt(bolinha.dataset.jogoIndex);
            
            // Ciclo: N ‚Üí V ‚Üí E ‚Üí D ‚Üí N
            let novoResultado;
            switch (resultadoAtual) {
                case 'N': novoResultado = 'V'; break;
                case 'V': novoResultado = 'E'; break;
                case 'E': novoResultado = 'D'; break;
                case 'D': novoResultado = 'N'; break;
                default: novoResultado = 'V';
            }
            
            console.log(`üéÆ [ADMIN] Alterando jogo ${jogoIndex + 1} do time ID ${timeId}: ${resultadoAtual} ‚Üí ${novoResultado}`);
            
            // Atualizar visualmente
            bolinha.dataset.resultado = novoResultado;
            bolinha.style.background = getCorResultado(novoResultado);
            bolinha.textContent = novoResultado;
            bolinha.title = `Clique para alterar: ${getDescricaoResultado(novoResultado)}`;
            
            // Efeito visual de clique
            bolinha.style.transform = 'scale(1.2)';
            setTimeout(() => {
                bolinha.style.transform = 'scale(1)';
            }, 150);
            
            // Coletar todos os resultados do time
            const todasBolinhas = document.querySelectorAll(`[data-time-id="${timeId}"].resultado-bolinha`);
            let novosUltimosJogos = '';
            todasBolinhas.forEach(b => {
                novosUltimosJogos += b.dataset.resultado;
            });
            
            console.log(`üìä [ADMIN] Novos √∫ltimos jogos para time ${timeId}: ${novosUltimosJogos}`);
            
            // Salvar no banco
            salvarUltimosJogos(timeId, novosUltimosJogos);
        }
        
        async function salvarUltimosJogos(timeId, ultimosJogos) {
            const campeonato = document.getElementById('campeonatoSelect').value || 'serie-a';
            
            // Determinar campo correto baseado no campeonato
            const fieldName = (campeonato === 'premier-league' || campeonato === 'la-liga' || campeonato === 'ligue1') ? 'ultimas_5' : 'ultimos_jogos';
            
            try {
                const response = await fetch('/api/admin/classificacao/salvar', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        admin_key: localStorage.getItem('admin_key'),
                        campeonato: campeonato,
                        updates: [{
                            id: parseInt(timeId),
                            field: fieldName,
                            value: ultimosJogos
                        }]
                    })
                });
                
                const data = await response.json();
                if (data.success) {
                    console.log('‚úÖ [ADMIN] √öltimos jogos salvos com sucesso!');
                    mostrarNotificacao('üéÆ Resultado atualizado!', 'success');
                } else {
                    console.error('‚ùå [ADMIN] Erro ao salvar:', data.message);
                    mostrarNotificacao('‚ùå Erro ao salvar resultado!', 'error');
                }
            } catch (error) {
                console.error('üí• [ADMIN] Erro na requisi√ß√£o:', error);
                mostrarNotificacao('üí• Erro de conex√£o!', 'error');
            }
        }

        // === BACKUP E RESTORE ===
        async function fazerBackup() {
            try {
                const response = await fetch(`${API_BASE}/api/admin/backup`);
                const result = await response.json();
                
                if (result.success) {
                    const dataStr = JSON.stringify(result.data, null, 2);
                    const dataBlob = new Blob([dataStr], {type: 'application/json'});
                    
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(dataBlob);
                    link.download = result.filename || `loteca-backup-${new Date().toISOString().slice(0,10)}.json`;
                    link.click();
                    
                    mostrarSucesso('Backup gerado com sucesso!');
                } else {
                    mostrarErro('Erro ao gerar backup: ' + result.message);
                }
            } catch (error) {
                console.error('Erro ao gerar backup:', error);
                mostrarErro('Erro de conex√£o ao gerar backup');
            }
        }

        async function restaurarBackup() {
            const fileInput = document.getElementById('backupFile');
            const file = fileInput.files[0];
            
            if (!file) {
                mostrarErro('Selecione um arquivo de backup');
                return;
            }
            
            try {
                const text = await file.text();
                const backupData = JSON.parse(text);
                
                if (confirm('Tem certeza que deseja restaurar este backup? Todos os dados atuais ser√£o substitu√≠dos.')) {
                    const response = await fetch(`${API_BASE}/api/admin/restore`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            backup_data: backupData,
                            admin_key: ADMIN_KEY
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        mostrarSucesso('Backup restaurado com sucesso! ' + result.message);
                        carregarClubes();
                        carregarEstatisticas();
                        carregarDashboard();
                    } else {
                        mostrarErro('Erro ao restaurar backup: ' + result.message);
                    }
                }
            } catch (error) {
                console.error('Erro ao restaurar backup:', error);
                mostrarErro('Arquivo de backup inv√°lido ou erro de conex√£o');
            }
        }

        // === TECLAS DE ATALHO ===
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && document.getElementById('loginContainer').style.display !== 'none') {
                login();
            }
        });

        // === FUN√á√ïES DE ESTAT√çSTICAS DOS CLUBES ===
        
        // Carregar estat√≠sticas de um clube
        async function carregarEstatisticasClube() {
            const clubeSelecionado = document.getElementById('clubeEstatisticas').value;
            const formulario = document.getElementById('formularioEstatisticas');
            const mensagem = document.getElementById('mensagemSelecionar');
            const btnTabelaJogos = document.getElementById('btnTabelaJogos');
            
            if (clubeSelecionado) {
                formulario.style.display = 'block';
                mensagem.style.display = 'none';
                
                // Mostrar bot√£o "Tabela de Jogos" para clubes com dados de jogos
                if (clubeSelecionado.toLowerCase().includes('flamengo') || 
                    clubeSelecionado.toLowerCase().includes('corinthians')) {
                    btnTabelaJogos.style.display = 'inline-flex';
                } else {
                    btnTabelaJogos.style.display = 'none';
                }
                
                console.log(`üîÑ Carregando estat√≠sticas REAIS de: ${clubeSelecionado}`);
                
                // Carregar dados reais da classifica√ß√£o
                await carregarDadosReaisClube(clubeSelecionado);
                
                // Carregar dados dos jogos (se dispon√≠vel)
                await carregarDadosJogosClube(clubeSelecionado);
                
                // Carregar dados edit√°veis salvos (se dispon√≠vel)
                await carregarDadosEditaveisSalvos(clubeSelecionado);
                
                // üìä PREENCHER DADOS AUTOM√ÅTICOS DA PLANILHA
                await preencherDadosAutomaticosPlanilha(clubeSelecionado);
                
                // Verificar se h√° dados da planilha para sincronizar
                verificarDadosPlanilha();
            } else {
                formulario.style.display = 'none';
                mensagem.style.display = 'block';
                btnTabelaJogos.style.display = 'none';
            }
        }

        // Carregar dados reais do clube da tabela de classifica√ß√£o
        async function carregarDadosReaisClube(nomeClube) {
            try {
                // Buscar dados da classifica√ß√£o
                const response = await fetch(`${API_BASE}/api/admin/classificacao`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        campeonato: 'serie-a',
                        admin_key: ADMIN_KEY
                    })
                });
                const result = await response.json();
                
                if (result.success && result.classificacao) {
                    // Encontrar o clube na classifica√ß√£o
                    const clube = result.classificacao.find(time => 
                        time.time.toLowerCase().includes(nomeClube.toLowerCase()) ||
                        nomeClube.toLowerCase().includes(time.time.toLowerCase())
                    );
                    
                    if (clube) {
                        console.log(`‚úÖ Dados encontrados para ${clube.time}:`, clube);
                        preencherDadosReais(clube);
                    } else {
                        console.warn(`‚ùå Clube ${nomeClube} n√£o encontrado na classifica√ß√£o`);
                        // Fallback para dados de exemplo espec√≠ficos por clube
                        if (nomeClube.toLowerCase().includes('corinthians')) {
                            preencherDadosCorinthians();
                        } else {
                            preencherDadosFlamengo();
                        }
                    }
                } else {
                    console.error('‚ùå Erro ao carregar classifica√ß√£o:', result.message);
                    // Fallback para dados de exemplo espec√≠ficos por clube
                    if (nomeClube.toLowerCase().includes('corinthians')) {
                        preencherDadosCorinthians();
                    } else {
                        preencherDadosFlamengo();
                    }
                }
            } catch (error) {
                console.error('‚ùå Erro na requisi√ß√£o:', error);
                // Fallback para dados de exemplo espec√≠ficos por clube
                if (nomeClube.toLowerCase().includes('corinthians')) {
                    preencherDadosCorinthians();
                } else {
                    preencherDadosFlamengo();
                }
            }
        }

        // Carregar dados dos jogos do clube (se dispon√≠vel)
        // Carregar dados edit√°veis salvos do clube
        async function carregarDadosEditaveisSalvos(nomeClube) {
            try {
                const response = await fetch(`/api/admin/estatisticas-editaveis/${nomeClube}`, {
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('admin_key')}`
                    }
                });
                
                const result = await response.json();
                if (result.success && result.data) {
                    const dados = result.data;
                    
                    // Preencher campos edit√°veis com dados salvos
                    if (dados.elencoTotal) {
                        document.getElementById('elencoTotal').value = dados.elencoTotal;
                        mostrarCadeadoSePreenchido('elencoTotal');
                    }
                    if (dados.pctProvaveis) {
                        document.getElementById('pctProvaveis').value = dados.pctProvaveis;
                        mostrarCadeadoSePreenchido('pctProvaveis');
                    }
                    if (dados.valorElenco) {
                        document.getElementById('valorElenco').value = dados.valorElenco;
                        mostrarCadeadoSePreenchido('valorElenco');
                    }
                    if (dados.ratingMedio) {
                        document.getElementById('ratingMedio').value = dados.ratingMedio;
                        mostrarCadeadoSePreenchido('ratingMedio');
                    }
                    if (dados.chutesPorJogo) {
                        document.getElementById('chutesPorJogo').value = dados.chutesPorJogo;
                    }
                    if (dados.posseBola) {
                        document.getElementById('posseBola').value = dados.posseBola;
                    }
                    if (dados.tendencia) {
                        document.getElementById('tendencia').value = dados.tendencia;
                    }
                    if (dados.desfalques) {
                        document.getElementById('desfalques').value = dados.desfalques;
                    }
                    if (dados.motivacao) {
                        document.getElementById('motivacao').value = dados.motivacao;
                    }
                    if (dados.proximosJogos) {
                        document.getElementById('proximosJogos').value = dados.proximosJogos;
                    }
                    
                    console.log(`‚úÖ Dados edit√°veis de ${nomeClube} carregados com sucesso!`);
                } else {
                    console.log(`‚ÑπÔ∏è Sem dados edit√°veis salvos para ${nomeClube}`);
                }
                
            } catch (error) {
                console.log(`‚ÑπÔ∏è Erro ao carregar dados edit√°veis: ${error.message}`);
            }
        }

        async function carregarDadosJogosClube(nomeClube) {
            try {
                // Mapear nome do clube para o formato usado nos arquivos
                let clubeArquivo = nomeClube.toLowerCase();
                if (clubeArquivo.includes('flamengo')) {
                    clubeArquivo = 'flamengo';
                } else if (clubeArquivo.includes('corinthians')) {
                    clubeArquivo = 'corinthians';
                }
                
                console.log(`üìä [JOGOS] Tentando carregar estat√≠sticas de jogos para: ${clubeArquivo}`);
                
                const response = await fetch(`/api/admin/estatisticas-jogos/${clubeArquivo}`);
                const data = await response.json();
                
                if (data.success) {
                    console.log(`‚úÖ [JOGOS] Estat√≠sticas carregadas:`, data.data);
                    preencherDadosJogos(data.data);
                } else {
                    console.log(`‚ÑπÔ∏è [JOGOS] Sem dados de jogos para ${clubeArquivo}: ${data.error}`);
                }
                
            } catch (error) {
                console.log(`‚ÑπÔ∏è [JOGOS] Erro ao carregar dados de jogos: ${error.message}`);
            }
        }

        // Preencher campos com dados calculados dos jogos
        function preencherDadosJogos(estatisticas) {
            // CAMPOS BLOQUEADOS VERDES - Dados calculados dos jogos
            if (estatisticas.ppg) {
                document.getElementById('ppg').value = estatisticas.ppg;
                marcarCampoComoJogos('ppg');
            }
            
            if (estatisticas.ppg_casa) {
                document.getElementById('ppgCasa').value = estatisticas.ppg_casa;
                marcarCampoComoJogos('ppgCasa');
            }
            
            if (estatisticas.ppg_fora) {
                document.getElementById('ppgFora').value = estatisticas.ppg_fora;
                marcarCampoComoJogos('ppgFora');
            }
            
            if (estatisticas.aproveitamento_casa) {
                document.getElementById('aproveitamentoCasa').value = estatisticas.aproveitamento_casa;
                marcarCampoComoJogos('aproveitamentoCasa');
            }
            
            if (estatisticas.aproveitamento_fora) {
                document.getElementById('aproveitamentoFora').value = estatisticas.aproveitamento_fora;
                marcarCampoComoJogos('aproveitamentoFora');
            }
            
            if (estatisticas.pct_vitorias) {
                document.getElementById('percentualVitorias').value = estatisticas.pct_vitorias;
                marcarCampoComoJogos('percentualVitorias');
            }
            
            if (estatisticas.media_gols_marcados) {
                document.getElementById('mediaGols').value = estatisticas.media_gols_marcados;
                marcarCampoComoJogos('mediaGols');
            }
            
            if (estatisticas.media_gols_sofridos) {
                document.getElementById('mediaSofridos').value = estatisticas.media_gols_sofridos;
                marcarCampoComoJogos('mediaSofridos');
            }
            
            if (estatisticas.clean_sheets !== undefined) {
                document.getElementById('cleanSheets').value = estatisticas.clean_sheets;
                marcarCampoComoJogos('cleanSheets');
            }
            
            if (estatisticas.pct_clean_sheets) {
                document.getElementById('percentualCleanSheets').value = estatisticas.pct_clean_sheets + '%';
                marcarCampoComoJogos('percentualCleanSheets');
            }
            
            if (estatisticas.pontos_ultimos_5) {
                document.getElementById('pontosUltimos5').value = estatisticas.pontos_ultimos_5;
                marcarCampoComoJogos('pontosUltimos5');
            }
            
            if (estatisticas.sequencia_atual) {
                document.getElementById('sequenciaAtual').value = estatisticas.sequencia_atual;
                marcarCampoComoJogos('sequenciaAtual');
            }
            
            // ‚úÖ ADICIONAR - Forma recente (√∫ltimos 5 resultados)
            if (estatisticas.ultimos_5_resultados) {
                document.getElementById('formaUltimos5').value = estatisticas.ultimos_5_resultados;
                marcarCampoComoJogos('formaUltimos5');
            }
        }

        // Marcar campo como derivado da tabela de jogos (cadeado verde)
        function marcarCampoComoJogos(fieldId, valor = null) {
            const field = document.getElementById(fieldId);
            if (field) {
                // Preencher valor se fornecido
                if (valor !== null) {
                    field.value = valor;
                }
                
                field.classList.remove('campo-editavel', 'campo-calculado', 'campo-pendente');
                field.classList.add('campo-bloqueado');
                field.readOnly = true;
                
                // Adicionar prote√ß√£o extra contra edi√ß√£o
                field.addEventListener('keydown', bloquearEdicao);
                field.addEventListener('paste', bloquearEdicao);
                field.addEventListener('input', bloquearEdicao);
                
                // Mostrar cadeado de prote√ß√£o autom√°tico
                mostrarCadeadoSePreenchido(fieldId);
                
                console.log(`üîí [PLANILHA] Campo ${fieldId} preenchido automaticamente: ${valor}`);
            }
        }

        // Marcar campo como pendente de atualiza√ß√£o
        function marcarCampoPendente(fieldId, valor) {
            const field = document.getElementById(fieldId);
            if (field) {
                // Preencher com valor padr√£o/exemplo
                field.value = valor;
                
                // Aplicar estilo visual de campo pendente
                field.classList.remove('campo-editavel', 'campo-bloqueado', 'campo-calculado');
                field.classList.add('campo-pendente');
                field.readOnly = false;
                
                // Atualizar √≠cone para indicar que precisa ser preenchido
                const label = field.closest('.campo-grupo')?.querySelector('label');
                if (label) {
                    const icon = label.querySelector('i');
                    if (icon) {
                        icon.className = 'fas fa-exclamation-triangle';
                        icon.style.color = '#fbbf24'; // Amarelo de alerta
                        icon.title = 'Campo precisa ser atualizado com dados reais';
                    }
                }
                
                console.log(`‚ö†Ô∏è [PENDENTE] Campo ${fieldId} marcado para atualiza√ß√£o`);
            }
        }

        // Carregar valor do elenco de dados reais
        async function carregarValorElenco(nomeClube) {
            console.log(`üîç [DEBUG] Iniciando carregarValorElenco para: ${nomeClube}`);
            
            try {
                const response = await fetch('./static/valor_elenco/mapeamento_clubes.json');
                console.log(`üîç [DEBUG] Response status: ${response.status}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                console.log(`üîç [DEBUG] Dados carregados:`, data);
                
                // Normalizar nome do clube para busca
                const clubeNormalizado = nomeClube.toLowerCase().replace(/\s+/g, '_');
                console.log(`üîç [DEBUG] Clube normalizado: ${clubeNormalizado}`);
                
                // Buscar no mapeamento
                let clubeEncontrado = null;
                for (const [key, clube] of Object.entries(data.mapeamento)) {
                    console.log(`üîç [DEBUG] Testando key: ${key} vs ${clubeNormalizado}`);
                    if (key === clubeNormalizado || 
                        clube.nomes_alternativos.some(alt => 
                            alt.toLowerCase().includes(nomeClube.toLowerCase()) ||
                            nomeClube.toLowerCase().includes(alt.toLowerCase())
                        )) {
                        clubeEncontrado = clube;
                        console.log(`‚úÖ [DEBUG] Clube encontrado:`, clubeEncontrado);
                        break;
                    }
                }
                
                if (clubeEncontrado) {
                    // Preencher campo com valor real
                    const field = document.getElementById('valorElenco');
                    console.log(`üîç [DEBUG] Campo valorElenco encontrado:`, field);
                    
                    if (field) {
                        field.value = clubeEncontrado.valor_elenco_euros;
                        field.classList.remove('campo-pendente', 'campo-editavel');
                        field.classList.add('campo-calculado');
                        field.readOnly = true;
                        
                        // Atualizar √≠cone para calculadora
                        const label = field.closest('tr')?.querySelector('td strong');
                        if (label) {
                            const icon = label.querySelector('i');
                            if (icon) {
                                icon.className = 'fas fa-calculator';
                                icon.style.color = '#60a5fa'; // Azul
                                icon.title = `Valor real do elenco: ‚Ç¨${clubeEncontrado.valor_elenco_euros}M (Posi√ß√£o mundial: ${clubeEncontrado.posicao_mundial}¬∫)`;
                            }
                        }
                        
                        console.log(`üí∞ [VALOR ELENCO] ${clubeEncontrado.nome_oficial}: ‚Ç¨${clubeEncontrado.valor_elenco_euros} milh√µes (${clubeEncontrado.posicao_mundial}¬∫ mundial)`);
                        
                        // Verifica√ß√£o final
                        setTimeout(() => {
                            const finalCheck = document.getElementById('valorElenco');
                            console.log(`üîç [DEBUG] Verifica√ß√£o final - Campo valorElenco:`, {
                                element: finalCheck,
                                value: finalCheck?.value,
                                classList: finalCheck?.classList.toString(),
                                style: finalCheck?.style.cssText,
                                visible: finalCheck?.offsetHeight > 0
                            });
                        }, 100);
                        
                    } else {
                        console.error(`‚ùå [DEBUG] Campo valorElenco n√£o encontrado!`);
                    }
                } else {
                    console.log(`‚ÑπÔ∏è [VALOR ELENCO] Clube ${nomeClube} n√£o encontrado na base de dados mundial`);
                }
                
            } catch (error) {
                console.error(`‚ùå [VALOR ELENCO] Erro ao carregar dados: ${error.message}`);
            }
        }

        // Fun√ß√£o para bloquear tentativas de edi√ß√£o
        function bloquearEdicao(event) {
            event.preventDefault();
            event.stopPropagation();
            
            // Mostrar alerta visual
            const field = event.target;
            const originalBorder = field.style.border;
            field.style.border = '2px solid #dc3545';
            field.style.boxShadow = '0 0 8px rgba(220, 53, 69, 0.6)';
            
            // Restaurar estilo ap√≥s 1 segundo
            setTimeout(() => {
                field.style.border = originalBorder;
                field.style.boxShadow = '';
            }, 1000);
            
            console.log('üö´ Tentativa de edi√ß√£o bloqueada em campo protegido');
            return false;
        }

        // Preencher com dados reais da classifica√ß√£o
        function preencherDadosReais(dadosClube) {
            // CAMPOS BLOQUEADOS - Dados da classifica√ß√£o (SOMENTE LEITURA)
            const camposClassificacao = [
                'posicaoAtual', 'pontosTotal', 'jogosDisputados', 'vitorias', 
                'empates', 'derrotas', 'golsMarcados', 'golsSofridos', 'formaUltimos5'
            ];
            
            // Preencher e bloquear campos da classifica√ß√£o
            document.getElementById('posicaoAtual').value = dadosClube.posicao || '';
            document.getElementById('pontosTotal').value = dadosClube.pontos || '';
            document.getElementById('jogosDisputados').value = dadosClube.jogos || '';
            document.getElementById('vitorias').value = dadosClube.vitorias || '';
            document.getElementById('empates').value = dadosClube.empates || '';
            document.getElementById('derrotas').value = dadosClube.derrotas || '';
            document.getElementById('golsMarcados').value = dadosClube.gols_pro || '';
            document.getElementById('golsSofridos').value = dadosClube.gols_contra || '';
            document.getElementById('formaUltimos5').value = dadosClube.ultimos_jogos || '';
            
            // GARANTIR que todos os campos da classifica√ß√£o sejam SOMENTE LEITURA
            camposClassificacao.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.readOnly = true;
                    field.classList.add('campo-bloqueado');
                    field.classList.remove('campo-editavel');
                    console.log(`üîí [CLASSIFICA√á√ÉO] Campo ${fieldId} bloqueado para edi√ß√£o`);
                }
            });
            
            // CAMPOS EDIT√ÅVEIS - Dados complementares (valores padr√£o)
            // Marcar campos que precisam ser atualizados com dados reais
            marcarCampoPendente('chutesPorJogo', 14.2);
            marcarCampoPendente('posseBola', 58.3);
            // ‚úÖ REMOVIDO - Esses campos ser√£o preenchidos AUTOMATICAMENTE pelos dados dos jogos
            // Clean Sheets, PPG Casa/Fora, Aproveitamento, Pontos √öltimos 5, Sequ√™ncia
            // ser√£o calculados pela fun√ß√£o carregarDadosJogosClube() se houver dados dispon√≠veis
            // Marcar campos cr√≠ticos que precisam ser atualizados
            marcarCampoPendente('tendencia', 'Est√°vel');
            marcarCampoPendente('elencoTotal', 40);
            marcarCampoPendente('pctProvaveis', 42.5);
            marcarCampoPendente('valorElenco', 85.0);
            marcarCampoPendente('ratingMedio', 4.6);
            marcarCampoPendente('desfalques', 'Nenhum desfalque importante');
            marcarCampoPendente('motivacao', `${dadosClube.zona || 'Meio da tabela'} - Posi√ß√£o ${dadosClube.posicao}`);
            marcarCampoPendente('proximosJogos', 'A definir');
            
            // Calcular campos autom√°ticos
            calcularPPG();
            calcularPercentuais();
            calcularMedias();
            calcularCleanSheets();
            
            console.log(`‚úÖ Dados de ${dadosClube.time} carregados com sucesso!`);
        }

        // Preencher dados de exemplo do Corinthians
        function preencherDadosCorinthians() {
            document.getElementById('posicaoAtual').value = 10;
            document.getElementById('pontosTotal').value = 29;
            document.getElementById('jogosDisputados').value = 24;
            document.getElementById('vitorias').value = 7;
            document.getElementById('empates').value = 8;
            document.getElementById('derrotas').value = 9;
            document.getElementById('golsMarcados').value = 28;
            document.getElementById('golsSofridos').value = 28;
            
            // Marcar campos que precisam ser atualizados com dados reais
            // Dados ofensivos espec√≠ficos do Corinthians (da planilha)
            marcarCampoComoJogos('chutesPorJogo', 10.9);
            marcarCampoComoJogos('posseBola', 53.7);
            marcarCampoComoJogos('passesCertos', 342);
            marcarCampoPendente('tendencia', 'Irregular');
            marcarCampoPendente('elencoTotal', 32);
            marcarCampoPendente('pctProvaveis', 38.5);
            marcarCampoPendente('valorElenco', 110.45);
            marcarCampoPendente('ratingMedio', 3.8);
            marcarCampoPendente('desfalques', 'Yuri Alberto (suspenso)');
            marcarCampoPendente('motivacao', 'Luta contra rebaixamento - situa√ß√£o delicada');
            marcarCampoPendente('proximosJogos', 'FLA(f), PAL(c), BOT(f)');
            
            // Calcular campos autom√°ticos
            calcularPPG();
            calcularPercentuais();
            calcularMedias();
            calcularCleanSheets();
        }

        // Preencher dados de exemplo do Flamengo
        function preencherDadosFlamengo() {
            document.getElementById('posicaoAtual').value = 2;
            document.getElementById('pontosTotal').value = 58;
            document.getElementById('jogosDisputados').value = 28;
            document.getElementById('vitorias').value = 17;
            document.getElementById('empates').value = 7;
            document.getElementById('derrotas').value = 4;
            document.getElementById('golsMarcados').value = 52;
            document.getElementById('golsSofridos').value = 32;
            // Dados ofensivos espec√≠ficos do Flamengo (da planilha)
            marcarCampoComoJogos('chutesPorJogo', 14.7);
            marcarCampoComoJogos('posseBola', 59.8);
            marcarCampoComoJogos('passesCertos', 412);
            marcarCampoPendente('tendencia', 'Est√°vel');
            marcarCampoPendente('elencoTotal', 40);
            marcarCampoPendente('pctProvaveis', 42.5);
            marcarCampoPendente('valorElenco', 85.0);
            marcarCampoPendente('ratingMedio', 4.6);
            marcarCampoPendente('desfalques', 'Arrascaeta (les√£o), Vi√±a (suspenso)');
            marcarCampoPendente('motivacao', 'Briga pelo t√≠tulo - 6 pts do l√≠der');
            marcarCampoPendente('proximosJogos', 'COR(f), PAL(c), BOT(f)');
            
            // Calcular campos autom√°ticos
            calcularPPG();
            calcularPercentuais();
            calcularMedias();
            calcularCleanSheets();
        }

        // Calcular PPG (Pontos por Jogo)
        function calcularPPG() {
            const pontos = parseFloat(document.getElementById('pontosTotal').value) || 0;
            const jogos = parseFloat(document.getElementById('jogosDisputados').value) || 0;
            
            if (jogos > 0) {
                const ppg = (pontos / jogos).toFixed(2);
                document.getElementById('ppg').value = ppg;
            } else {
                document.getElementById('ppg').value = '';
            }
        }

        // Calcular percentuais
        function calcularPercentuais() {
            const vitorias = parseFloat(document.getElementById('vitorias').value) || 0;
            const empates = parseFloat(document.getElementById('empates').value) || 0;
            const derrotas = parseFloat(document.getElementById('derrotas').value) || 0;
            const total = vitorias + empates + derrotas;
            
            if (total > 0) {
                const pctVitorias = ((vitorias / total) * 100).toFixed(1);
                document.getElementById('percentualVitorias').value = pctVitorias + '%';
            } else {
                document.getElementById('percentualVitorias').value = '';
            }
        }

        // Calcular m√©dias de gols
        function calcularMedias() {
            const jogos = parseFloat(document.getElementById('jogosDisputados').value) || 0;
            const golsMarcados = parseFloat(document.getElementById('golsMarcados').value) || 0;
            const golsSofridos = parseFloat(document.getElementById('golsSofridos').value) || 0;
            
            if (jogos > 0) {
                const mediaGolsMarcados = (golsMarcados / jogos).toFixed(2);
                const mediaGolsSofridos = (golsSofridos / jogos).toFixed(2);
                
                document.getElementById('mediaGols').value = mediaGolsMarcados;
                document.getElementById('mediaSofridos').value = mediaGolsSofridos;
            } else {
                document.getElementById('mediaGols').value = '';
                document.getElementById('mediaSofridos').value = '';
            }
        }

        // Calcular percentual de Clean Sheets
        function calcularCleanSheets() {
            const jogos = parseFloat(document.getElementById('jogosDisputados').value) || 0;
            const cleanSheets = parseFloat(document.getElementById('cleanSheets').value) || 0;
            
            if (jogos > 0) {
                const pctCleanSheets = ((cleanSheets / jogos) * 100).toFixed(1);
                document.getElementById('percentualCleanSheets').value = pctCleanSheets + '%';
            } else {
                document.getElementById('percentualCleanSheets').value = '';
            }
        }

        // Salvar estat√≠sticas (incluindo campos edit√°veis)
        async function salvarEstatisticas() {
            const clubeSelecionado = document.getElementById('clubeEstatisticas').value;
            
            if (!clubeSelecionado) {
                mostrarErro('Selecione um clube primeiro!');
                return;
            }

            // Coletar dados dos campos edit√°veis
            const dadosEditaveis = {
                clube: clubeSelecionado,
                elencoTotal: document.getElementById('elencoTotal').value,
                pctProvaveis: document.getElementById('pctProvaveis').value,
                valorElenco: document.getElementById('valorElenco').value,
                ratingMedio: document.getElementById('ratingMedio').value,
                chutesPorJogo: document.getElementById('chutesPorJogo').value,
                posseBola: document.getElementById('posseBola').value,
                tendencia: document.getElementById('tendencia').value,
                desfalques: document.getElementById('desfalques').value,
                motivacao: document.getElementById('motivacao').value,
                proximosJogos: document.getElementById('proximosJogos').value
            };
            
            try {
                const response = await fetch('/api/admin/estatisticas-editaveis', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        admin_key: localStorage.getItem('admin_key'),
                        dados: dadosEditaveis
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    mostrarSucesso(`Estat√≠sticas do ${clubeSelecionado} salvas com sucesso!`);
                    console.log('üìä Estat√≠sticas salvas para:', clubeSelecionado);
                } else {
                    mostrarErro('Erro ao salvar: ' + result.message);
                }
            } catch (error) {
                console.error('Erro ao salvar estat√≠sticas:', error);
                mostrarErro('Erro ao salvar estat√≠sticas');
            }
        }

        // Fun√ß√µes removidas: limparFormulario, previewEstatisticas, verHistorico
        // Mantida apenas a fun√ß√£o salvarEstatisticas por ser √∫til

        // === INTEGRA√á√ÉO COM PLANILHA DE CLUBES ===
        function abrirPlanilhaClubes() {
            // Abrir planilha em nova aba
            const planilhaUrl = './models/EstatisticasElenco/planilha_clubes_futebol.html';
            const planilhaWindow = window.open(planilhaUrl, '_blank', 'width=1400,height=900,scrollbars=yes,resizable=yes');
            
            if (planilhaWindow) {
                console.log('üìä [PLANILHA] Abrindo planilha de clubes...');
                
                // Verificar se h√° dados salvos da planilha
                const dadosPlantel = localStorage.getItem('estatisticasPlantel');
                if (dadosPlantel) {
                    try {
                        const dados = JSON.parse(dadosPlantel);
                        console.log('üìä [PLANILHA] Dados encontrados:', dados);
                        
                        // Mostrar notifica√ß√£o
                        mostrarSucesso(`üìä Planilha aberta! Dados dispon√≠veis: ${dados.celulasProtegidas || 0} campos protegidos`);
                        
                        // Opcional: Preencher campos da Central Admin com dados da planilha
                        preencherDadosPlanilha(dados);
                        
                    } catch (error) {
                        console.error('‚ùå [PLANILHA] Erro ao processar dados:', error);
                    }
                } else {
                    mostrarInfo('üìä Planilha aberta! Edite os dados e salve para sincronizar com a Central Admin.');
                }
            } else {
                mostrarErro('‚ùå N√£o foi poss√≠vel abrir a planilha. Verifique se o pop-up foi bloqueado.');
            }
        }

        // Fun√ß√£o para preencher dados da planilha na Central Admin
        function preencherDadosPlanilha(dados) {
            const clubeSelecionado = document.getElementById('clubeEstatisticas').value;
            
            if (!clubeSelecionado) {
                mostrarInfo('üí° Selecione um clube para sincronizar os dados da planilha.');
                return;
            }
            
            // Procurar dados do clube selecionado na planilha
            let clubeEncontrado = null;
            Object.values(dados.dadosEditados || {}).forEach(tabela => {
                const clube = tabela.find(c => 
                    c.clube.toLowerCase().includes(clubeSelecionado.toLowerCase()) ||
                    clubeSelecionado.toLowerCase().includes(c.clube.toLowerCase())
                );
                if (clube && !clubeEncontrado) {
                    clubeEncontrado = clube;
                }
            });
            
            if (clubeEncontrado) {
                console.log('üìä [SYNC] Sincronizando dados do clube:', clubeEncontrado);
                
                // === SINCRONIZA√á√ÉO AUTOM√ÅTICA - ESTAT√çSTICA PLANTEL ===
                if (clubeEncontrado.plantel) {
                    const field = document.getElementById('elencoTotal');
                    if (field && !field.readOnly) {
                        field.value = clubeEncontrado.plantel;
                        marcarCampoComoJogos('elencoTotal');
                        mostrarCadeadoSePreenchido('elencoTotal');
                    }
                }
                
                if (clubeEncontrado.valorTotal) {
                    const field = document.getElementById('valorElenco');
                    if (field && !field.readOnly) {
                        // Extrair n√∫mero do valor (ex: "‚Ç¨ 195.90 mi." -> 195.90)
                        const valorNumerico = clubeEncontrado.valorTotal
                            .replace(/[‚Ç¨\s]/g, '')
                            .replace('mi.', '')
                            .replace(',', '.');
                        field.value = valorNumerico;
                        marcarCampoComoJogos('valorElenco');
                        mostrarCadeadoSePreenchido('valorElenco');
                    }
                }
                
                // === SINCRONIZA√á√ÉO AUTOM√ÅTICA - DADOS OFENSIVOS ===
                if (clubeEncontrado.chutesJogo) {
                    const field = document.getElementById('chutesPorJogo');
                    if (field && !field.readOnly) {
                        field.value = clubeEncontrado.chutesJogo;
                        marcarCampoComoJogos('chutesPorJogo');
                        mostrarCadeadoSePreenchido('chutesPorJogo');
                    }
                }
                
                if (clubeEncontrado.posseBola) {
                    const field = document.getElementById('posseBola');
                    if (field && !field.readOnly) {
                        field.value = clubeEncontrado.posseBola.replace('%', '');
                        marcarCampoComoJogos('posseBola');
                        mostrarCadeadoSePreenchido('posseBola');
                    }
                }
                
                if (clubeEncontrado.passesCertos) {
                    const field = document.getElementById('passesCertos');
                    if (field && !field.readOnly) {
                        field.value = clubeEncontrado.passesCertos;
                        marcarCampoComoJogos('passesCertos');
                        mostrarCadeadoSePreenchido('passesCertos');
                    }
                }
                
                // Mostrar resumo da sincroniza√ß√£o
                const dadosSincronizados = [];
                if (clubeEncontrado.plantel) dadosSincronizados.push(`üìä Plantel: ${clubeEncontrado.plantel}`);
                if (clubeEncontrado.valorTotal) dadosSincronizados.push(`üí∞ Valor: ${clubeEncontrado.valorTotal}`);
                if (clubeEncontrado.chutesJogo) dadosSincronizados.push(`‚öΩ Chutes: ${clubeEncontrado.chutesJogo}/jogo`);
                if (clubeEncontrado.posseBola) dadosSincronizados.push(`üìä Posse: ${clubeEncontrado.posseBola}`);
                if (clubeEncontrado.passesCertos) dadosSincronizados.push(`üîÑ Passes: ${clubeEncontrado.passesCertos}`);
                
                mostrarSucesso(`‚úÖ ${clubeEncontrado.clube} - Dados sincronizados automaticamente!\n\n${dadosSincronizados.join('\n')}\n\nüîí Campos protegidos com cadeados`);
            } else {
                mostrarInfo(`‚ÑπÔ∏è Clube "${clubeSelecionado}" n√£o encontrado na planilha editada.`);
            }
        }

        // Fun√ß√£o para sincronizar dados ofensivos da planilha
        function sincronizarDadosOfensivos() {
            console.log('‚öΩ [SYNC] Bot√£o Dados Ofensivos clicado - Usando sincroniza√ß√£o principal...');
            
            // Verificar se h√° dados da planilha
            const dadosPlantel = localStorage.getItem('estatisticasPlantel');
            if (!dadosPlantel) {
                mostrarInfo('üìä Dados n√£o encontrados!\n\nüí° Para sincronizar:\n1. Abra a planilha (bot√£o "üìä Planilha")\n2. Edite os dados do clube\n3. Salve na planilha\n4. Tente novamente');
                return;
            }
            
            try {
                const dados = JSON.parse(dadosPlantel);
                // Usar a fun√ß√£o principal que j√° faz tudo
                preencherDadosPlanilha(dados);
            } catch (error) {
                console.error('‚ùå [SYNC] Erro ao processar dados:', error);
                mostrarErro('‚ùå Erro ao processar dados da planilha.');
            }
        }

        // Fun√ß√£o para preencher dados autom√°ticos da planilha
        async function preencherDadosAutomaticosPlanilha(clubeSelecionado) {
            console.log(`üìä [AUTO] Preenchendo dados autom√°ticos da planilha para: ${clubeSelecionado}`);
            
            // Primeiro, tentar dados da planilha (localStorage)
            const dadosPlantel = localStorage.getItem('estatisticasPlantel');
            if (dadosPlantel) {
                try {
                    const dados = JSON.parse(dadosPlantel);
                    preencherDadosPlanilha(dados);
                    return; // Se encontrou na planilha, usar esses dados
                } catch (error) {
                    console.error('‚ùå Erro ao processar dados da planilha:', error);
                }
            }
            
            // Se n√£o h√° dados da planilha, usar dados hardcoded por clube
            if (clubeSelecionado.toLowerCase().includes('flamengo')) {
                console.log('üî¥ [AUTO] Preenchendo dados do Flamengo...');
                marcarCampoComoJogos('chutesPorJogo', 14.7);
                marcarCampoComoJogos('posseBola', 59.8);
                marcarCampoComoJogos('passesCertos', 412);
                marcarCampoComoJogos('elencoTotal', 31);
                marcarCampoComoJogos('valorElenco', 195.90);
                
            } else if (clubeSelecionado.toLowerCase().includes('corinthians')) {
                console.log('‚ö´ [AUTO] Preenchendo dados do Corinthians...');
                marcarCampoComoJogos('chutesPorJogo', 10.9);
                marcarCampoComoJogos('posseBola', 53.7);
                marcarCampoComoJogos('passesCertos', 342);
                marcarCampoComoJogos('elencoTotal', 32);
                marcarCampoComoJogos('valorElenco', 110.45);
                
            } else {
                console.log(`‚ÑπÔ∏è [AUTO] Clube ${clubeSelecionado} n√£o possui dados autom√°ticos configurados`);
            }
        }

        // Fun√ß√£o para verificar dados da planilha automaticamente
        function verificarDadosPlanilha() {
            const dados = localStorage.getItem('estatisticasPlantel');
            if (dados) {
                try {
                    const plantelData = JSON.parse(dados);
                    const timestamp = new Date(plantelData.timestamp);
                    const agora = new Date();
                    const diffMinutos = Math.floor((agora - timestamp) / (1000 * 60));
                    
                    if (diffMinutos < 60) { // Dados recentes (menos de 1 hora)
                        console.log(`üìä [PLANILHA] Dados dispon√≠veis (${diffMinutos}min atr√°s):`, plantelData);
                        return plantelData;
                    }
                } catch (error) {
                    console.error('‚ùå [PLANILHA] Erro ao verificar dados:', error);
                }
            }
            return null;
        }

        // === SISTEMA DE AJUDA EDUCATIVO ===
        const helpContent = {
            ppg: {
                title: "PPG - Pontos Por Jogo",
                icon: "üìä",
                definition: "M√©dia de pontos conquistados por partida disputada. √â um dos principais indicadores de desempenho de uma equipe.",
                formula: "PPG = Total de Pontos √∑ Total de Jogos",
                examples: [
                    { value: "2.22", label: "Flamengo atual" },
                    { value: "3.00", label: "Time perfeito" }
                ],
                interpretation: "Escala de Interpreta√ß√£o:",
                scale: [
                    { range: "2.5+", label: "Excelente", class: "excellent" },
                    { range: "2.0-2.4", label: "Muito Bom", class: "good" },
                    { range: "1.5-1.9", label: "M√©dio", class: "average" },
                    { range: "<1.5", label: "Ruim", class: "poor" }
                ]
            },
            cleansheet: {
                title: "Clean Sheet - Jogo Sem Sofrer Gols",
                icon: "üõ°Ô∏è",
                definition: "N√∫mero de partidas onde o time n√£o sofreu nenhum gol. Indica a solidez defensiva da equipe.",
                formula: "Clean Sheets = Jogos com 0 gols sofridos",
                examples: [
                    { value: "12", label: "Flamengo (exemplo)" },
                    { value: "15", label: "Defesa s√≥lida" }
                ],
                interpretation: "Interpreta√ß√£o por temporada (38 jogos):",
                scale: [
                    { range: "15+", label: "Defesa Excelente", class: "excellent" },
                    { range: "10-14", label: "Defesa Boa", class: "good" },
                    { range: "6-9", label: "Defesa M√©dia", class: "average" },
                    { range: "<6", label: "Defesa Fr√°gil", class: "poor" }
                ]
            },
            ppg_casa: {
                title: "PPG Casa - Pontos Por Jogo em Casa",
                icon: "üè†",
                definition: "M√©dia de pontos conquistados especificamente nos jogos disputados em casa (como mandante). Indica a for√ßa do time no seu pr√≥prio est√°dio.",
                formula: "PPG Casa = Pontos em Casa √∑ Jogos em Casa",
                examples: [
                    { value: "2.31", label: "Flamengo (exemplo)" },
                    { value: "2.50", label: "Forte mandante" }
                ],
                interpretation: "Interpreta√ß√£o do desempenho em casa:",
                scale: [
                    { range: "2.5+", label: "Fortaleza Absoluta", class: "excellent" },
                    { range: "2.0-2.4", label: "Mandante Forte", class: "good" },
                    { range: "1.5-1.9", label: "Mandante M√©dio", class: "average" },
                    { range: "<1.5", label: "Casa Fr√°gil", class: "poor" }
                ]
            },
            ppg_fora: {
                title: "PPG Fora - Pontos Por Jogo Fora de Casa",
                icon: "‚úàÔ∏è",
                definition: "M√©dia de pontos conquistados especificamente nos jogos disputados fora de casa (como visitante). Indica a capacidade do time de pontuar longe de seus dom√≠nios.",
                formula: "PPG Fora = Pontos Fora √∑ Jogos Fora",
                examples: [
                    { value: "1.83", label: "Flamengo (exemplo)" },
                    { value: "2.00", label: "Bom visitante" }
                ],
                interpretation: "Interpreta√ß√£o do desempenho fora:",
                scale: [
                    { range: "2.0+", label: "Visitante Excepcional", class: "excellent" },
                    { range: "1.5-1.9", label: "Visitante Bom", class: "good" },
                    { range: "1.0-1.4", label: "Visitante M√©dio", class: "average" },
                    { range: "<1.0", label: "Visitante Fraco", class: "poor" }
                ]
            }
        };

        function mostrarAjuda(termo) {
            const content = helpContent[termo];
            if (!content) return;

            const modal = document.getElementById('helpModal');
            const titleText = document.getElementById('helpModalTitleText');
            const body = document.getElementById('helpModalBody');

            titleText.textContent = content.title;

            body.innerHTML = `
                <div class="help-definition">
                    <h3>${content.icon} ${content.title}</h3>
                    <p>${content.definition}</p>
                </div>

                <div class="help-formula">
                    ${content.formula}
                </div>

                <div class="help-examples">
                    ${content.examples.map(ex => `
                        <div class="help-example">
                            <div class="help-example-value">${ex.value}</div>
                            <div class="help-example-label">${ex.label}</div>
                        </div>
                    `).join('')}
                </div>

                <div class="help-interpretation">
                    <h4>${content.interpretation}</h4>
                    <div class="help-scale">
                        ${content.scale.map(item => `
                            <div class="help-scale-item help-scale-${item.class}">
                                <strong>${item.range}</strong><br>
                                ${item.label}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            modal.style.display = 'block';
            document.body.style.overflow = 'hidden'; // Prevenir scroll
        }

        function fecharAjuda() {
            const modal = document.getElementById('helpModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto'; // Restaurar scroll
        }

        // Fechar modal clicando fora dele
        window.onclick = function(event) {
            const modal = document.getElementById('helpModal');
            if (event.target === modal) {
                fecharAjuda();
            }
        }

        // Fechar modal com ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                fecharAjuda();
            }
        });

        // === DADOS DOS JOGOS DO FLAMENGO ===
        const jogosFlamengo = [
            {data: '2025-03-29', timeCasa: 'Fla', golsCasa: 1, golsVisitante: 1, timeVisitante: 'Int', local: 'Rio de Janeiro - RJ', resultado: 'Empate', pontos: 1},
            {data: '2025-04-06', timeCasa: 'Vit', golsCasa: 1, golsVisitante: 2, timeVisitante: 'Fla', local: 'Salvador - BA', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-04-13', timeCasa: 'Gr√™', golsCasa: 0, golsVisitante: 2, timeVisitante: 'Fla', local: 'Porto Alegre - RS', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-04-16', timeCasa: 'Fla', golsCasa: 6, golsVisitante: 0, timeVisitante: 'Juv', local: 'Rio de Janeiro - RJ', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-04-19', timeCasa: 'Vas', golsCasa: 0, golsVisitante: 0, timeVisitante: 'Fla', local: 'Rio de Janeiro - RJ', resultado: 'Empate', pontos: 1},
            {data: '2025-04-27', timeCasa: 'Fla', golsCasa: 4, golsVisitante: 0, timeVisitante: 'Cor', local: 'Rio de Janeiro - RJ', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-05-04', timeCasa: 'Cru', golsCasa: 2, golsVisitante: 1, timeVisitante: 'Fla', local: 'Belo Horizonte - MG', resultado: 'Derrota', pontos: 0},
            {data: '2025-05-10', timeCasa: 'Fla', golsCasa: 1, golsVisitante: 0, timeVisitante: 'Bah', local: 'Rio de Janeiro - RJ', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-05-18', timeCasa: 'Fla', golsCasa: 0, golsVisitante: 0, timeVisitante: 'Bot', local: 'Rio de Janeiro - RJ', resultado: 'Empate', pontos: 1},
            {data: '2025-05-25', timeCasa: 'Pal', golsCasa: 0, golsVisitante: 2, timeVisitante: 'Fla', local: 'Sao Paulo - SP', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-06-01', timeCasa: 'Fla', golsCasa: 5, golsVisitante: 0, timeVisitante: 'For', local: 'Rio de Janeiro - RJ', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-07-12', timeCasa: 'Fla', golsCasa: 2, golsVisitante: 0, timeVisitante: 'S√£o', local: 'Rio de Janeiro - RJ', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-07-16', timeCasa: 'San', golsCasa: 1, golsVisitante: 0, timeVisitante: 'Fla', local: 'Santos - SP', resultado: 'Derrota', pontos: 0},
            {data: '2025-07-20', timeCasa: 'Fla', golsCasa: 1, golsVisitante: 0, timeVisitante: 'Flu', local: 'Rio de Janeiro - RJ', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-07-23', timeCasa: 'Red', golsCasa: 1, golsVisitante: 2, timeVisitante: 'Fla', local: 'Braganca Paulista - SP', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-07-27', timeCasa: 'Fla', golsCasa: 1, golsVisitante: 0, timeVisitante: 'Atl', local: 'Rio de Janeiro - RJ', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-08-03', timeCasa: 'Cea', golsCasa: 1, golsVisitante: 1, timeVisitante: 'Fla', local: 'Fortaleza - CE', resultado: 'Empate', pontos: 1},
            {data: '2025-08-09', timeCasa: 'Fla', golsCasa: 2, golsVisitante: 1, timeVisitante: 'Mir', local: 'Rio de Janeiro - RJ', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-08-17', timeCasa: 'Int', golsCasa: 1, golsVisitante: 3, timeVisitante: 'Fla', local: 'Rio - Porto Alegre', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-08-25', timeCasa: 'Fla', golsCasa: 8, golsVisitante: 0, timeVisitante: 'Vit', local: 'Rio de Janeiro - RJ', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-08-31', timeCasa: 'Fla', golsCasa: 1, golsVisitante: 1, timeVisitante: 'Gr√™', local: 'Rio de Janeiro - RJ', resultado: 'Empate', pontos: 1},
            {data: '2025-09-14', timeCasa: 'Juv', golsCasa: 0, golsVisitante: 2, timeVisitante: 'Fla', local: 'Caxias do Sul - RS', resultado: 'Vit√≥ria', pontos: 3},
            {data: '2025-09-21', timeCasa: 'Fla', golsCasa: 1, golsVisitante: 1, timeVisitante: 'Vas', local: 'Rio de Janeiro - RJ', resultado: 'Empate', pontos: 1}
        ];

        // === FUN√á√ïES DA TABELA DE JOGOS ===
        async function abrirTabelaJogos() {
            const modal = document.getElementById('jogosModal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            // Obter clube selecionado
            const clubeSelecionado = document.getElementById('clubeEstatisticas').value;
            let clubeArquivo = clubeSelecionado.toLowerCase();
            
            // Mapear nome do clube para o formato usado nos arquivos
            if (clubeArquivo.includes('flamengo')) {
                clubeArquivo = 'flamengo';
            } else if (clubeArquivo.includes('corinthians')) {
                clubeArquivo = 'corinthians';
            }
            
            console.log(`üìä [MODAL] Abrindo tabela de jogos para: ${clubeArquivo}`);
            
            // Carregar jogos da API do clube selecionado
            await carregarJogosDoClube(clubeArquivo);
        }

        function fecharTabelaJogos() {
            const modal = document.getElementById('jogosModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Vari√°vel global para armazenar jogos carregados
        let jogosCarregados = [];
        let clubeAtual = '';

        async function carregarJogosDoClube(clube) {
            try {
                console.log(`üìä [JOGOS] Carregando jogos de ${clube}...`);
                
                const response = await fetch(`/api/admin/jogos/${clube}`);
                const data = await response.json();
                
                if (data.success) {
                    jogosCarregados = data.data.jogos;
                    clubeAtual = clube;
                    console.log(`‚úÖ [JOGOS] ${jogosCarregados.length} jogos carregados para ${clube}`);
                    
                    // Atualizar t√≠tulo do modal com nome amig√°vel
                    const tituloModal = document.querySelector('#jogosModal h3');
                    if (tituloModal) {
                        let nomeAmigavel = clube.toUpperCase();
                        if (clube === 'flamengo') {
                            nomeAmigavel = 'üî• FLAMENGO';
                        } else if (clube === 'corinthians') {
                            nomeAmigavel = '‚ö´ CORINTHIANS';
                        }
                        tituloModal.textContent = `Tabela de Jogos - ${nomeAmigavel}`;
                    }
                    
                    carregarJogosNaTabela();
                    atualizarResumoEstatistico();
                } else {
                    console.error('‚ùå [JOGOS] Erro ao carregar jogos:', data.error);
                    alert('Erro ao carregar jogos: ' + data.error);
                }
                
            } catch (error) {
                console.error('‚ùå [JOGOS] Erro na requisi√ß√£o:', error);
                alert('Erro ao conectar com o servidor');
            }
        }

        function carregarJogosNaTabela() {
            const tbody = document.getElementById('jogosTableBody');
            tbody.innerHTML = '';
            
            jogosCarregados.forEach((jogo, index) => {
                const row = document.createElement('tr');
                row.style.cssText = 'border-bottom: 1px solid #333; color: white;';
                
                const placar = `${jogo.gols_casa} x ${jogo.gols_visitante}`;
                const dataFormatada = new Date(jogo.data).toLocaleDateString('pt-BR');
                
                row.innerHTML = `
                    <td style="padding: 10px; text-align: center;">${dataFormatada}</td>
                    <td style="padding: 10px; text-align: center; font-weight: bold;">${jogo.time_casa}</td>
                    <td style="padding: 10px; text-align: center; font-weight: bold; color: #00E38C;">${placar}</td>
                    <td style="padding: 10px; text-align: center; font-weight: bold;">${jogo.time_visitante}</td>
                    <td style="padding: 10px; text-align: center; font-size: 12px;">${jogo.local}</td>
                    <td style="padding: 10px; text-align: center;">
                        <span style="padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: bold; 
                                     background: ${jogo.resultado === 'Vit√≥ria' ? '#28a745' : jogo.resultado === 'Empate' ? '#ffc107' : '#dc3545'}; 
                                     color: white;">${jogo.resultado}</span>
                    </td>
                    <td style="padding: 10px; text-align: center; font-weight: bold; color: #00E38C;">${jogo.pontos}</td>
                    <td style="padding: 10px; text-align: center;">
                        <button onclick="editarJogo(${index})" style="background: #17a2b8; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; margin-right: 5px;">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="removerJogo(${index})" style="background: #dc3545; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function atualizarResumoEstatistico() {
            const totalJogos = jogosCarregados.length;
            const vitorias = jogosCarregados.filter(j => j.resultado === 'Vit√≥ria').length;
            const empates = jogosCarregados.filter(j => j.resultado === 'Empate').length;
            const derrotas = jogosCarregados.filter(j => j.resultado === 'Derrota').length;
            const totalPontos = jogosCarregados.reduce((sum, j) => sum + j.pontos, 0);
            const ppg = totalJogos > 0 ? (totalPontos / totalJogos).toFixed(2) : '0.00';
            
            document.getElementById('totalJogos').textContent = totalJogos;
            document.getElementById('totalVitorias').textContent = vitorias;
            document.getElementById('totalEmpates').textContent = empates;
            document.getElementById('totalDerrotas').textContent = derrotas;
            document.getElementById('ppgCalculado').textContent = ppg;
        }

        function adicionarNovoJogo() {
            alert('Funcionalidade de adicionar novo jogo ser√° implementada em breve!');
        }

        function editarJogo(index) {
            alert(`Editar jogo ${index + 1} ser√° implementado em breve!`);
        }

        async function removerJogo(index) {
            if (confirm('Tem certeza que deseja remover este jogo?')) {
                try {
                    console.log(`üóëÔ∏è [JOGOS] Removendo jogo ${index} de ${clubeAtual}...`);
                    
                    const response = await fetch(`/api/admin/jogos/${clubeAtual}/${index}`, {
                        method: 'DELETE'
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        console.log('‚úÖ [JOGOS] Jogo removido com sucesso');
                        // Recarregar jogos da API
                        await carregarJogosDoClube(clubeAtual);
                    } else {
                        console.error('‚ùå [JOGOS] Erro ao remover jogo:', data.error);
                        alert('Erro ao remover jogo: ' + data.error);
                    }
                    
                } catch (error) {
                    console.error('‚ùå [JOGOS] Erro na requisi√ß√£o:', error);
                    alert('Erro ao conectar com o servidor');
                }
            }
        }

        // === FUN√á√ÉO PARA ATUALIZAR DASHBOARD (uso interno apenas) ===
        async function atualizarDashboard() {
            try {
                console.log('üìä [DASHBOARD] Atualizando estat√≠sticas...');
                
                // Verificar se os elementos existem
                const totalEl = document.getElementById('totalClubes');
                const serieAEl = document.getElementById('serieAClubes');
                const serieBEl = document.getElementById('serieBClubes');
                const ultimaSyncEl = document.getElementById('ultimaSync');
                
                console.log('üîç [DASHBOARD] Elementos encontrados:', {
                    totalClubes: !!totalEl,
                    serieAClubes: !!serieAEl,
                    serieBClubes: !!serieBEl,
                    ultimaSync: !!ultimaSyncEl
                });
                
                const response = await fetch('/api/admin/dashboard-stats');
                const data = await response.json();
                
                console.log('üì° [DASHBOARD] Resposta da API:', data);
                
                if (data.success) {
                    const stats = data.data;
                    
                    // Atualizar n√∫meros
                    if (totalEl) totalEl.textContent = stats.total_clubes || 0;
                    if (serieAEl) serieAEl.textContent = stats.serie_a || 0;
                    if (serieBEl) serieBEl.textContent = stats.serie_b || 0;
                    
                    // Atualizar √∫ltima sincroniza√ß√£o
                    if (ultimaSyncEl) {
                        if (stats.ultima_sincronizacao) {
                            const dataObj = new Date(stats.ultima_sincronizacao);
                            const dataFormatada = dataObj.toLocaleString('pt-BR', {
                                day: '2-digit',
                                month: '2-digit',
                                year: 'numeric',
                                hour: '2-digit',
                                minute: '2-digit'
                            });
                            ultimaSyncEl.textContent = dataFormatada;
                        } else {
                            ultimaSyncEl.textContent = 'Nunca';
                        }
                    }
                    
                    console.log('‚úÖ [DASHBOARD] Estat√≠sticas atualizadas:', {
                        total: stats.total_clubes,
                        serieA: stats.serie_a,
                        serieB: stats.serie_b,
                        ultimaSync: stats.ultima_sincronizacao
                    });
                } else {
                    console.error('‚ùå [DASHBOARD] Erro:', data.error);
                }
                
            } catch (error) {
                console.error('‚ùå [DASHBOARD] Erro ao atualizar:', error);
            }
        }

        // === SISTEMA DE CADEADO MANUAL ===
        function toggleLock(fieldId) {
            const field = document.getElementById(fieldId);
            const lockIcon = document.querySelector(`[data-field="${fieldId}"]`);
            
            if (!field || !lockIcon) return;
            
            if (field.readOnly) {
                // Desbloquear campo
                field.readOnly = false;
                field.classList.remove('campo-bloqueado-manual');
                field.classList.add('campo-editavel');
                lockIcon.className = 'fas fa-unlock campo-lock-toggle';
                lockIcon.title = 'Clique para bloquear campo';
                lockIcon.style.color = '#1e40af';
                console.log(`üîì Campo ${fieldId} desbloqueado`);
            } else {
                // Bloquear campo (s√≥ se tiver valor)
                if (field.value && field.value.trim() !== '') {
                    field.readOnly = true;
                    field.classList.remove('campo-editavel', 'campo-pendente');
                    field.classList.add('campo-bloqueado-manual');
                    lockIcon.className = 'fas fa-lock campo-lock-toggle';
                    lockIcon.title = 'Clique para desbloquear campo';
                    lockIcon.style.color = '#1e40af';
                    console.log(`üîí Campo ${fieldId} bloqueado com valor: ${field.value}`);
                } else {
                    alert('‚ö†Ô∏è Preencha o campo antes de bloquear!');
                }
            }
        }

        // Mostrar cadeado quando campo for preenchido
        function mostrarCadeadoSePreenchido(fieldId) {
            const field = document.getElementById(fieldId);
            const lockIcon = document.querySelector(`[data-field="${fieldId}"]`);
            
            if (field && lockIcon) {
                if (field.value && field.value.trim() !== '' && !field.readOnly) {
                    lockIcon.style.display = 'block';
                } else if (!field.value || field.value.trim() === '') {
                    lockIcon.style.display = 'none';
                }
            }
        }

        // Adicionar listeners para mostrar cadeado
        function adicionarListenersCadeado() {
            const camposComCadeado = ['elencoTotal', 'pctProvaveis', 'valorElenco', 'ratingMedio'];
            
            camposComCadeado.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('input', () => mostrarCadeadoSePreenchido(fieldId));
                    field.addEventListener('blur', () => mostrarCadeadoSePreenchido(fieldId));
                    // Verificar no carregamento
                    mostrarCadeadoSePreenchido(fieldId);
                }
            });
        }

        // === INICIALIZA√á√ÉO ===
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîê Central Admin - Loteca Inteligente carregada');
            console.log('üí° Chave padr√£o:', ADMIN_KEY);
            
            // Inicializar sistema de cadeados
            setTimeout(() => {
                adicionarListenersCadeado();
            }, 500);
            
            // Atualizar dashboard na inicializa√ß√£o (com delay para garantir que a p√°gina carregou)
            setTimeout(() => {
                console.log('‚è∞ [DASHBOARD] Iniciando atualiza√ß√£o ap√≥s delay...');
                atualizarDashboard();
            }, 1000);
            
            // Configurar listener para mudan√ßa de campeonato na aba Classifica√ß√£o
            const campeonatoSelect = document.getElementById('campeonatoSelect');
            if (campeonatoSelect) {
                campeonatoSelect.addEventListener('change', function() {
                    console.log(`üîÑ [ADMIN] Campeonato alterado para: ${this.value}`);
                    carregarClassificacao();
                });
            }
        });

        // === FUN√á√ïES DA LOTECA ===

        // Dados dos jogos atuais (baseados no site)
        const jogosAtuais = [
            { id: 1, coluna1: "CORINTHIANS/SP", coluna2: "FLAMENGO/RJ", data: "Domingo" },
            { id: 2, coluna1: "FORTALEZA/CE", coluna2: "SPORT/PE", data: "S√°bado" },
            { id: 3, coluna1: "JUVENTUDE/RS", coluna2: "INTERNACIONAL/RS", data: "S√°bado" },
            { id: 4, coluna1: "VASCO DA GAMA/RJ", coluna2: "CRUZEIRO/MG", data: "S√°bado" },
            { id: 5, coluna1: "ATHLETICO/PR", coluna2: "OPERARIO/PR", data: "S√°bado" },
            { id: 6, coluna1: "ATLETICO/MG", coluna2: "MIRASSOL/SP", data: "S√°bado" },
            { id: 7, coluna1: "GREMIO/RS", coluna2: "VITORIA/BA", data: "Domingo" },
            { id: 8, coluna1: "ASTON VILLA", coluna2: "FULHAM", data: "Domingo" },
            { id: 9, coluna1: "BAHIA/BA", coluna2: "PALMEIRAS/SP", data: "Domingo" },
            { id: 10, coluna1: "FLUMINENSE/RJ", coluna2: "BOTAFOGO/RJ", data: "Domingo" },
            { id: 11, coluna1: "CRICIUMA/SC", coluna2: "PAYSANDU/PA", data: "Domingo" },
            { id: 12, coluna1: "NEW CASTLE", coluna2: "ARSENAL", data: "Domingo" },
            { id: 13, coluna1: "BRAGANTINO/SP", coluna2: "SANTOS/SP", data: "Domingo" },
            { id: 14, coluna1: "BARCELONA", coluna2: "REAL SOCIEDAD", data: "Domingo" }
        ];

        // Lista de todos os times dispon√≠veis no banco
        let timesDisponiveis = [];

        async function carregarTimesDisponiveis() {
            try {
                console.log('üìä [LOTECA] Carregando times dispon√≠veis...');
                
                const response = await fetch(`${API_BASE}/api/admin/clubes`, {
                    headers: {
                        'Authorization': localStorage.getItem('admin_key') || ADMIN_KEY,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    timesDisponiveis = data.clubes || [];
                    console.log(`‚úÖ [LOTECA] ${timesDisponiveis.length} times carregados`);
                } else {
                    console.error('‚ùå [LOTECA] Erro ao carregar times');
                    // Times de fallback
                    timesDisponiveis = [
                        { nome: "CORINTHIANS/SP" }, { nome: "FLAMENGO/RJ" },
                        { nome: "FORTALEZA/CE" }, { nome: "SPORT/PE" },
                        // ... outros times se necess√°rio
                    ];
                }
            } catch (error) {
                console.error('üí• [LOTECA] Erro ao carregar times:', error);
                timesDisponiveis = [];
            }
        }

        function carregarJogosAtuais() {
            console.log('üéÆ [LOTECA] Carregando jogos atuais...');
            
            const tbody = document.getElementById('lotecaJogos');
            if (!tbody) return;

            tbody.innerHTML = '';

            jogosAtuais.forEach(jogo => {
                const tr = document.createElement('tr');
                tr.style.border = '1px solid #0066cc';
                
                tr.innerHTML = `
                    <td style="padding: 8px; text-align: center; border: 1px solid #0066cc; font-weight: bold;">
                        ${jogo.id}
                    </td>
                    <td style="padding: 8px; border: 1px solid #0066cc;">
                        <input type="text" class="loteca-input" id="coluna1_${jogo.id}" 
                               value="${jogo.coluna1}" 
                               onchange="atualizarJogo(${jogo.id}, 'coluna1', this.value)"
                               style="width: 100%; border: 1px solid #ddd; padding: 5px; border-radius: 3px;">
                    </td>
                    <td style="padding: 8px; text-align: center; border: 1px solid #0066cc; font-weight: bold; color: #0066cc;">
                        x
                    </td>
                    <td style="padding: 8px; border: 1px solid #0066cc;">
                        <input type="text" class="loteca-input" id="coluna2_${jogo.id}" 
                               value="${jogo.coluna2}" 
                               onchange="atualizarJogo(${jogo.id}, 'coluna2', this.value)"
                               style="width: 100%; border: 1px solid #ddd; padding: 5px; border-radius: 3px;">
                    </td>
                    <td style="padding: 8px; border: 1px solid #0066cc;">
                        <select class="loteca-select" id="data_${jogo.id}" 
                                onchange="atualizarJogo(${jogo.id}, 'data', this.value)"
                                style="width: 100%; border: 1px solid #ddd; padding: 5px; border-radius: 3px;">
                            <option value="S√°bado" ${jogo.data === 'S√°bado' ? 'selected' : ''}>S√°bado</option>
                            <option value="Domingo" ${jogo.data === 'Domingo' ? 'selected' : ''}>Domingo</option>
                            <option value="Segunda" ${jogo.data === 'Segunda' ? 'selected' : ''}>Segunda</option>
                            <option value="Ter√ßa" ${jogo.data === 'Ter√ßa' ? 'selected' : ''}>Ter√ßa</option>
                            <option value="Quarta" ${jogo.data === 'Quarta' ? 'selected' : ''}>Quarta</option>
                            <option value="Quinta" ${jogo.data === 'Quinta' ? 'selected' : ''}>Quinta</option>
                            <option value="Sexta" ${jogo.data === 'Sexta' ? 'selected' : ''}>Sexta</option>
                        </select>
                    </td>
                `;
                
                tbody.appendChild(tr);
            });

            console.log('‚úÖ [LOTECA] 14 jogos carregados na tabela');
            mostrarNotificacao('üéÆ Jogos atuais carregados!', 'success');
        }

        function atualizarJogo(id, campo, valor) {
            console.log(`üîÑ [LOTECA] Atualizando jogo ${id}, campo ${campo}: ${valor}`);
            
            const jogo = jogosAtuais.find(j => j.id === id);
            if (jogo) {
                jogo[campo] = valor;
                console.log(`‚úÖ [LOTECA] Jogo ${id} atualizado`);
            }
        }

        async function salvarJogosLoteca() {
            try {
                console.log('üíæ [LOTECA] Salvando concurso...');
                
                const numeroConcurso = document.getElementById('numeroConcurso').value;
                const dataSorteio = document.getElementById('dataSorteio').value;
                const periodoApostas = document.getElementById('periodoApostas').value;

                const concurso = {
                    numero: numeroConcurso,
                    data_sorteio: dataSorteio,
                    periodo_apostas: periodoApostas,
                    jogos: jogosAtuais
                };

                // Aqui voc√™ pode implementar o salvamento no banco
                console.log('üìä [LOTECA] Dados do concurso:', concurso);
                
                mostrarNotificacao('üíæ Concurso salvo com sucesso!', 'success');
                
            } catch (error) {
                console.error('üí• [LOTECA] Erro ao salvar:', error);
                mostrarNotificacao('‚ùå Erro ao salvar concurso!', 'error');
            }
        }

        async function gerarAnalises() {
            try {
                console.log('üéØ [LOTECA] Gerando an√°lises autom√°ticas...');
                
                // Aqui voc√™ pode implementar a gera√ß√£o de an√°lises baseadas nos dados do banco
                mostrarNotificacao('üéØ An√°lises geradas!', 'success');
                
            } catch (error) {
                console.error('üí• [LOTECA] Erro ao gerar an√°lises:', error);
                mostrarNotificacao('‚ùå Erro ao gerar an√°lises!', 'error');
            }
        }

        async function publicarNoSite() {
            try {
                console.log('üöÄ [LOTECA] Publicando no site...');
                
                // Aqui voc√™ pode implementar a publica√ß√£o autom√°tica no site
                mostrarNotificacao('üöÄ Publicado no site!', 'success');
                
            } catch (error) {
                console.error('üí• [LOTECA] Erro ao publicar:', error);
                mostrarNotificacao('‚ùå Erro ao publicar!', 'error');
            }
        }

        // Inicializar ao carregar a aba
        function inicializarLoteca() {
            console.log('üéÆ [LOTECA] Inicializando sistema...');
            carregarTimesDisponiveis();
        }

    </script>
</body>
</html>

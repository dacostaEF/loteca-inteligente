<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Debug: Sport vs Atl√©tico Mineiro</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a2e; color: #eee; }
        .success { color: #00ff88; }
        .error { color: #ff4444; }
        .warning { color: #ffaa00; }
        .box { background: #16213e; padding: 15px; margin: 10px 0; border-radius: 5px; }
        h2 { color: #00ff88; }
        pre { background: #0f0f0f; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç Debug: Sport vs Atl√©tico Mineiro</h1>
    
    <div id="resultado"></div>

    <script>
        // FUN√á√ïES DO BACKEND (SIMULADAS)
        function normalizarBackend(nome) {
            nome = nome.toLowerCase().trim();
            // Remove acentos
            nome = nome.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            return nome;
        }

        function gerarVariacoesBackend(nome) {
            const variacoes = new Set();
            const nome_lower = nome.toLowerCase().trim();
            
            // Remove acentos
            const nome_sem_acento = nome_lower.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            
            // Varia√ß√£o 1: Com underscores
            variacoes.add(nome_sem_acento.replace(/ /g, '_').replace(/-/g, '_'));
            
            // Varia√ß√£o 2: Com espa√ßos
            const nome_com_espacos = nome_sem_acento.replace(/-/g, ' ').replace(/\//g, ' ').replace(/_/g, ' ').trim();
            variacoes.add(nome_com_espacos);
            
            // Varia√ß√£o 3: Com h√≠fens
            const nome_com_hifens = nome_sem_acento.replace(/ /g, '-').replace(/\//g, '-').replace(/_/g, '-').trim();
            variacoes.add(nome_com_hifens);
            
            // Varia√ß√£o 4: Sem sufixos
            const nome_sem_estado = nome_sem_acento.replace(/[-\/\s](sp|rj|mg|rs|ce|ba|pe|pr|sc|go)$/i, '').trim();
            if (nome_sem_estado !== nome_sem_acento) {
                variacoes.add(nome_sem_estado);
            }
            
            // Varia√ß√£o 5: Primeira palavra
            const palavras = nome_sem_acento.split(/[\s\-\/]+/);
            if (palavras[0] && palavras[0].length >= 3) {
                variacoes.add(palavras[0]);
            }
            
            // Varia√ß√£o 6: √öltima palavra
            if (palavras.length > 1 && palavras[palavras.length-1].length >= 3) {
                variacoes.add(palavras[palavras.length-1]);
            }
            
            // Varia√ß√£o 7: Sem separadores
            const sem_separadores = nome_sem_acento.replace(/ /g, '').replace(/-/g, '').replace(/\//g, '');
            variacoes.add(sem_separadores);
            
            // Case variations
            const variacoes_extras = new Set();
            for (const v of variacoes) {
                variacoes_extras.add(v.toLowerCase());
                variacoes_extras.add(v.toUpperCase());
                variacoes_extras.add(v.charAt(0).toUpperCase() + v.slice(1).toLowerCase());
            }
            
            return Array.from(new Set([...variacoes, ...variacoes_extras])).sort();
        }

        // FUN√á√ïES DO FRONTEND (SIMULADAS)
        function normalizarFrontend(texto) {
            return texto
                .toLowerCase()
                .normalize('NFD').replace(/[\u0300-\u036f]/g, '') // Remove acentos
                .replace(/\/(sp|rj|mg|rs|ce|ba|pe|pr|sc|go|ing|esp|it|fra|ale|por)/gi, '') // Remove sufixos
                .replace(/[^a-z0-9\s\-]/g, '') // Mant√©m letras, n√∫meros, espa√ßos e h√≠fens
                .trim();
        }

        // TESTES
        const resultado = document.getElementById('resultado');
        
        function testar(nomeJogo, nomeCSV, titulo, cor) {
            const variacoes = gerarVariacoesBackend(nomeCSV);
            const frontendNorm = normalizarFrontend(nomeJogo);
            
            const match = variacoes.includes(frontendNorm);
            
            // Verificar match por palavra-chave
            const palavras = frontendNorm.split(/\s+/).filter(p => p.length >= 3);
            const palavraMatch = palavras.some(palavra => 
                variacoes.some(v => v.includes(palavra))
            );
            
            let html = `
                <div class="box">
                    <h2 style="color: ${cor};">${titulo}</h2>
                    <pre>
Nome no Jogo (JSON):  <span class="warning">"${nomeJogo}"</span>
Nome no CSV:          <span class="warning">"${nomeCSV}"</span>

<strong>FRONTEND normaliza para:</strong>
  "${frontendNorm}"

<strong>BACKEND gera varia√ß√µes de "${nomeCSV}":</strong>
`;
            
            variacoes.slice(0, 20).forEach((v, i) => {
                const destaque = v === frontendNorm ? ' <span class="success">‚Üê MATCH DIRETO!</span>' : '';
                html += `  ${i+1}. "${v}"${destaque}\n`;
            });
            
            if (variacoes.length > 20) {
                html += `  ... e mais ${variacoes.length - 20} varia√ß√µes\n`;
            }
            
            html += `\n<strong>RESULTADO:</strong>\n`;
            
            if (match) {
                html += `  <span class="success">‚úÖ MATCH DIRETO! "${frontendNorm}" est√° nas varia√ß√µes</span>\n`;
            } else if (palavraMatch) {
                html += `  <span class="warning">‚ö†Ô∏è MATCH POR PALAVRA-CHAVE</span>\n`;
                palavras.forEach(palavra => {
                    const matches = variacoes.filter(v => v.includes(palavra));
                    if (matches.length > 0) {
                        html += `     Palavra "${palavra}" encontrada em: ${matches.slice(0, 3).join(', ')}\n`;
                    }
                });
            } else {
                html += `  <span class="error">‚ùå NENHUM MATCH! "${frontendNorm}" N√ÉO est√° nas varia√ß√µes</span>\n`;
            }
            
            html += `</pre></div>`;
            
            resultado.innerHTML += html;
        }

        // Executar testes
        testar("Sport/PE", "Sport", "üîµ SPORT (FUNCIONA)", "#00ff88");
        testar("Atl√©tico Mineiro/MG", "Atletico-MG", "üî¥ ATL√âTICO MINEIRO (N√ÉO FUNCIONA)", "#ff4444");
        
        // An√°lise final
        resultado.innerHTML += `
            <div class="box">
                <h2>üìä AN√ÅLISE FINAL:</h2>
                <pre>
<strong class="success">Sport funciona porque:</strong>
  - Nome simples: "Sport" (uma palavra)
  - Frontend remove "/PE": "sport"
  - Backend gera: "sport", "SPORT", "Sport"
  - ‚úÖ MATCH DIRETO!

<strong class="error">Atl√©tico Mineiro N√ÉO funciona porque:</strong>
  - Nome composto no JSON: "Atl√©tico Mineiro/MG"
  - Frontend normaliza para: "atletico mineiro"
  - Backend tem no CSV: "Atletico-MG" (sem "Mineiro"!)
  - Backend gera varia√ß√µes de "Atletico-MG", n√£o de "Atletico Mineiro"
  - ‚ùå "atletico mineiro" N√ÉO est√° nas varia√ß√µes!
  - ‚ö†Ô∏è  Busca por palavra-chave "atletico" DEVE funcionar

<strong class="warning">SOLU√á√ÉO:</strong>
  1. Backend j√° gera "atletico" como varia√ß√£o (primeira palavra)
  2. Frontend DEVE buscar por palavra-chave e ENCONTRAR "atletico"
  3. Se ainda n√£o funciona, h√° problema no c√≥digo de busca por palavra-chave
                </pre>
            </div>
        `;
    </script>
</body>
</html>


<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planilha dos Clubes de Futebol</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', 'Open Sans', sans-serif;
            background: #0f0f0f;
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
            margin: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: #1a1a1a;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 1px solid #333;
        }

        /* Cabe√ßalho */
        .header {
            text-align: center;
            padding-bottom: 2rem;
            border-bottom: 1px solid #3a364f;
            margin-bottom: 2rem;
            
            /* BRILHO NEON NO HEADER */
            background: linear-gradient(135deg, 
                rgba(168, 85, 247, 0.05) 0%, 
                transparent 50%, 
                rgba(0, 227, 140, 0.05) 100%);
            border-radius: 15px;
            position: relative;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                transparent 0%, 
                rgba(168, 85, 247, 0.1) 25%, 
                transparent 50%, 
                rgba(0, 227, 140, 0.1) 75%, 
                transparent 100%);
            border-radius: 15px;
            animation: headerShimmer 4s ease-in-out infinite;
            z-index: -1;
        }
        
        @keyframes headerShimmer {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }

        .header .logo-link {
            display: inline-block;
            transition: all 0.3s ease;
            text-decoration: none;
            margin-bottom: 1rem;
        }

        .header .logo-link:hover {
            transform: scale(1.05);
            filter: brightness(1.1);
        }

        .header img.logo {
            max-width: 250px;
            height: auto;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            color: #A855F7;
            margin: 0;
        }

        .header p {
            font-size: 1.1rem;
            color: #94a3b8;
            max-width: 600px;
            margin: 0.5rem auto 0;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid #333;
            background: #2a2a2a;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: #adb5bd;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab:hover {
            background: #333;
            color: #ffffff;
        }

        .tab.active {
            color: #6f42c1;
            border-bottom-color: #6f42c1;
            background: #1a1a1a;
        }

        .tab.active.serie-a {
            color: #00E38C;
            border-bottom-color: #00E38C;
        }

        .tab.active.serie-b {
            color: #fbbf24;
            border-bottom-color: #fbbf24;
        }

        .export-section {
            padding: 20px;
            background: #2a2a2a;
            border-bottom: 1px solid #333;
        }

        .export-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #6f42c1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background 0.3s ease;
            margin-right: 10px;
        }

        .export-btn:hover {
            background: #5a2d91;
        }

        .export-btn.serie-a {
            background: #00E38C;
        }

        .export-btn.serie-a:hover {
            background: #00B377;
        }

        .export-btn.serie-b {
            background: #fbbf24;
        }

        .export-btn.serie-b:hover {
            background: #f59e0b;
        }

        .content {
            padding: 30px;
            background: #1a1a1a;
        }

        .content h2 {
            font-size: 1.5rem;
            color: #ffffff;
            margin-bottom: 20px;
            text-shadow: 0 2px 4px rgba(111, 66, 193, 0.3);
        }

        .info-box {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            border: 1px solid #333;
        }

        .info-box.blue {
            background: #1e3a8a;
            color: #bfdbfe;
            border-color: #3b82f6;
        }

        .info-box.yellow {
            background: #92400e;
            color: #fde68a;
            border-color: #f59e0b;
        }

        .table-container {
            overflow-x: auto;
            overflow-y: auto;
            max-height: 600px;
            border-radius: 8px;
            border: 1px solid #333;
            background: #2a2a2a;
        }

        /* Scrollbar espec√≠fica para S√©rie B com mais altura */
        .table-container.serie-b-scroll {
            max-height: 500px;
            overflow-y: scroll;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #2a2a2a;
        }

        th {
            background: #6f42c1;
            color: white;
            padding: 12px 16px;
            text-align: left;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .serie-a th {
            background: #00E38C;
        }

        .serie-b th {
            background: #fbbf24;
        }

        td {
            padding: 12px 16px;
            border-bottom: 1px solid #333;
            font-size: 0.9rem;
            color: #ffffff;
            background: #2a2a2a;
        }

        tr:nth-child(even) td {
            background: #1e1e1e;
        }

        tr:hover td {
            background: #333 !important;
        }

        .valor-cell {
            font-weight: 600;
            color: #00E38C;
        }

        .percentual-positivo {
            color: #00E38C;
            font-weight: 600;
        }

        .percentual-negativo {
            color: #ef4444;
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .footer {
            background: #2a2a2a;
            padding: 20px;
            text-align: center;
            border-top: 1px solid #333;
            color: #adb5bd;
            font-size: 0.8rem;
        }

        .editable {
            background: rgba(0, 227, 140, 0.15) !important;
            border: 1px dashed #00E38C !important;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: text;
            color: #60a5fa !important;
            position: relative;
        }

        .editable:focus {
            outline: 2px solid #00E38C !important;
            background: rgba(0, 227, 140, 0.25) !important;
        }

        .locked {
            background: rgba(239, 68, 68, 0.15) !important;
            border: 1px solid #ef4444 !important;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: not-allowed;
            color: #fca5a5 !important;
            position: relative;
        }

        .cell-lock {
            position: absolute;
            right: 2px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            font-size: 10px;
            color: #00E38C;
            background: rgba(0, 0, 0, 0.7);
            padding: 2px 4px;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .cell-lock.locked {
            color: #ef4444;
        }

        .cell-lock:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: translateY(-50%) scale(1.1);
        }

        .edit-btn {
            background: #6f42c1;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 8px;
            transition: background 0.3s ease;
        }

        .edit-btn:hover {
            background: #5a2d91;
        }

        .save-btn {
            background: #00E38C;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            margin: 20px 0;
            transition: background 0.3s ease;
        }

        .save-btn:hover {
            background: #00B377;
        }

        /* Scrollbar personalizada */
        .table-container::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .table-container::-webkit-scrollbar-track {
            background: #1a1a1a;
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: #6f42c1;
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: #5a2d91;
        }

        .table-container::-webkit-scrollbar-corner {
            background: #1a1a1a;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <a href="https://www.loteriasinteligente.com.br/" target="_blank" rel="noopener noreferrer" class="logo-link">
                <img src="../../static/Logo_loteraisinteligente.png" alt="Logo Loterias Inteligente - Visite nosso site" class="logo">
            </a>
            <h1>Raio-X da Loteca</h1>
            <p>Planilha dos Clubes de Futebol<br>
            Dados atualizados - Observat√≥rio do Futebol e Transfermarkt</p>
        </header>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('top100')">
                Top 100 Clubes Mais Valiosos
            </button>
            <button class="tab" onclick="showTab('serieA')">
                S√©rie A Brasileir√£o
            </button>
            <button class="tab" onclick="showTab('serieB')">
                S√©rie B Brasileir√£o
            </button>
        </div>

        <!-- Export Section -->
        <div class="export-section">
            <button class="export-btn" id="exportBtn" onclick="exportCurrentTab()">
                üì• Baixar Dados (CSV)
            </button>
            <button class="save-btn" onclick="saveChanges()">
                üíæ Salvar Altera√ß√µes
            </button>
        </div>

        <!-- Content -->
        <div class="content">
            <!-- Top 100 Tab -->
            <div id="top100" class="tab-content active">
                <h2>Top 100 Clubes Mais Valiosos do Mundo
                    <span style="font-size: 0.8rem; color: #6b7280; margin-left: 10px;">(Observat√≥rio do Futebol - 17/09/2025)</span>
                </h2>
                <div class="table-container">
                    <table id="top100Table">
                        <thead>
                            <tr>
                                <th>Posi√ß√£o</th>
                                <th>Clube</th>
                                <th>Pa√≠s</th>
                                <th>Valor de Mercado</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="top100Body">
                            <!-- Dados ser√£o inseridos via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- S√©rie A Tab -->
            <div id="serieA" class="tab-content">
                <h2>S√©rie A do Campeonato Brasileiro
                    <span style="font-size: 0.8rem; color: #6b7280; margin-left: 10px;">(Transfermarkt - Valores em Euros)</span>
                </h2>
                <div class="info-box blue">
                    <p><strong>Resumo:</strong> 658 jogadores, idade m√©dia de 27.6 anos, 154 estrangeiros, valor m√©dio de ‚Ç¨ 2.76 mi. por jogador</p>
                    <p style="margin-top: 5px;"><strong>Valor total:</strong> ‚Ç¨ 1.82 bilh√µes</p>
                </div>
                <div class="table-container">
                    <table id="serieATable" class="serie-a">
                        <thead>
                            <tr>
                                <th>Posi√ß√£o</th>
                                <th>Clube</th>
                                <th>Plantel</th>
                                <th>Idade M√©dia</th>
                                <th>Estrangeiros</th>
                                <th>Valor M√©dio</th>
                                <th>Valor Total</th>
                                <th>Posse Bola (%)</th>
                                <th>Passes Certos</th>
                                <th>Chutes/Jogo</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="serieABody">
                            <!-- Dados ser√£o inseridos via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- S√©rie B Tab -->
            <div id="serieB" class="tab-content">
                <h2>S√©rie B do Campeonato Brasileiro
                    <span style="font-size: 0.8rem; color: #6b7280; margin-left: 10px;">(Transfermarkt - Valores em Euros)</span>
                </h2>
                <div class="info-box yellow">
                    <p><strong>Resumo:</strong> 714 jogadores, idade m√©dia de 27.7 anos, 72 estrangeiros, valor m√©dio de ‚Ç¨ 324 mil por jogador</p>
                    <p style="margin-top: 5px;"><strong>Valor total:</strong> ‚Ç¨ 231.60 milh√µes</p>
                </div>
                <div class="table-container serie-b-scroll">
                    <table id="serieBTable" class="serie-b">
                        <thead>
                            <tr>
                                <th>Posi√ß√£o</th>
                                <th>Clube</th>
                                <th>Plantel</th>
                                <th>Idade M√©dia</th>
                                <th>Estrangeiros</th>
                                <th>Valor M√©dio</th>
                                <th>Valor Total</th>
                                <th>Posse Bola (%)</th>
                                <th>Passes Certos</th>
                                <th>Chutes/Jogo</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="serieBBody">
                            <!-- Dados ser√£o inseridos via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>Dados compilados do Observat√≥rio do Futebol (17/09/2025) e Transfermarkt.com.br</p>
            <p style="margin-top: 5px;">Planilha edit√°vel - Clique nos valores para editar</p>
        </div>
    </div>

    <script>
        // Dados dos clubes
        const top100Clubs = [
            { posicao: 1, clube: "Real Madrid", pais: "Espanha", valor: "‚Ç¨ 1.726 M" },
            { posicao: 2, clube: "Manchester City", pais: "Inglaterra", valor: "‚Ç¨ 1.538 M" },
            { posicao: 3, clube: "Barcelona FC", pais: "Espanha", valor: "‚Ç¨ 1.508 M" },
            { posicao: 4, clube: "Manchester United", pais: "Inglaterra", valor: "‚Ç¨ 1.394 M" },
            { posicao: 5, clube: "Liverpool FC", pais: "Inglaterra", valor: "‚Ç¨ 1.363 M" },
            { posicao: 6, clube: "Arsenal FC", pais: "Inglaterra", valor: "‚Ç¨ 1.262 M" },
            { posicao: 7, clube: "Chelsea FC", pais: "Inglaterra", valor: "‚Ç¨ 1.174 M" },
            { posicao: 8, clube: "PSG", pais: "Fran√ßa", valor: "‚Ç¨ 1.137 M" },
            { posicao: 9, clube: "Tottenham", pais: "Inglaterra", valor: "‚Ç¨ 1.108 M" },
            { posicao: 10, clube: "Bayern Munich", pais: "Alemanha", valor: "‚Ç¨ 1.074 M" },
            { posicao: 11, clube: "Newcastle United", pais: "Inglaterra", valor: "‚Ç¨ 945 M" },
            { posicao: 12, clube: "Atletico Madrid", pais: "Espanha", valor: "‚Ç¨ 939 M" },
            { posicao: 13, clube: "Juventus FC", pais: "It√°lia", valor: "‚Ç¨ 936 M" },
            { posicao: 14, clube: "Borussia Dortmund", pais: "Alemanha", valor: "‚Ç¨ 913 M" },
            { posicao: 15, clube: "AC Milan", pais: "It√°lia", valor: "‚Ç¨ 893 M" },
            { posicao: 16, clube: "West Ham United", pais: "Inglaterra", valor: "‚Ç¨ 859 M" },
            { posicao: 17, clube: "Brighton & Hove Albion", pais: "Inglaterra", valor: "‚Ç¨ 849 M" },
            { posicao: 18, clube: "Aston Villa", pais: "Inglaterra", valor: "‚Ç¨ 838 M" },
            { posicao: 19, clube: "Napoli", pais: "It√°lia", valor: "‚Ç¨ 831 M" },
            { posicao: 20, clube: "Inter Milan", pais: "It√°lia", valor: "‚Ç¨ 818 M" },
            { posicao: 21, clube: "Bayer Leverkusen", pais: "Alemanha", valor: "‚Ç¨ 803 M" },
            { posicao: 22, clube: "Crystal Palace", pais: "Inglaterra", valor: "‚Ç¨ 743 M" },
            { posicao: 23, clube: "RB Leipzig", pais: "Alemanha", valor: "‚Ç¨ 733 M" },
            { posicao: 24, clube: "Fulham FC", pais: "Inglaterra", valor: "‚Ç¨ 712 M" },
            { posicao: 25, clube: "Wolverhampton", pais: "Inglaterra", valor: "‚Ç¨ 706 M" },
            { posicao: 26, clube: "AS Roma", pais: "It√°lia", valor: "‚Ç¨ 700 M" },
            { posicao: 27, clube: "Everton FC", pais: "Inglaterra", valor: "‚Ç¨ 697 M" },
            { posicao: 28, clube: "Brentford FC", pais: "Inglaterra", valor: "‚Ç¨ 694 M" },
            { posicao: 29, clube: "Leicester City", pais: "Inglaterra", valor: "‚Ç¨ 664 M" },
            { posicao: 30, clube: "Valencia CF", pais: "Espanha", valor: "‚Ç¨ 647 M" },
            { posicao: 31, clube: "Sevilla FC", pais: "Espanha", valor: "‚Ç¨ 639 M" },
            { posicao: 32, clube: "Brighton & Hove Albion", pais: "Inglaterra", valor: "‚Ç¨ 637 M" },
            { posicao: 33, clube: "Leeds United", pais: "Inglaterra", valor: "‚Ç¨ 632 M" },
            { posicao: 34, clube: "AFC Bournemouth", pais: "Inglaterra", valor: "‚Ç¨ 630 M" },
            { posicao: 35, clube: "Lazio", pais: "It√°lia", valor: "‚Ç¨ 627 M" },
            { posicao: 36, clube: "Eintracht Frankfurt", pais: "Alemanha", valor: "‚Ç¨ 623 M" },
            { posicao: 37, clube: "Atalanta BC", pais: "It√°lia", valor: "‚Ç¨ 618 M" },
            { posicao: 38, clube: "Nottingham Forest", pais: "Inglaterra", valor: "‚Ç¨ 606 M" },
            { posicao: 39, clube: "Sheffield United", pais: "Inglaterra", valor: "‚Ç¨ 594 M" },
            { posicao: 40, clube: "Burnley FC", pais: "Inglaterra", valor: "‚Ç¨ 584 M" },
            { posicao: 41, clube: "Fiorentina", pais: "It√°lia", valor: "‚Ç¨ 575 M" },
            { posicao: 42, clube: "Real Sociedad", pais: "Espanha", valor: "‚Ç¨ 569 M" },
            { posicao: 43, clube: "Luton Town", pais: "Inglaterra", valor: "‚Ç¨ 564 M" },
            { posicao: 44, clube: "FC Porto", pais: "Portugal", valor: "‚Ç¨ 558 M" },
            { posicao: 45, clube: "Southampton FC", pais: "Inglaterra", valor: "‚Ç¨ 554 M" },
            { posicao: 46, clube: "Olympique Marseille", pais: "Fran√ßa", valor: "‚Ç¨ 547 M" },
            { posicao: 47, clube: "Athletic Bilbao", pais: "Espanha", valor: "‚Ç¨ 531 M" },
            { posicao: 48, clube: "AS Monaco", pais: "Fran√ßa", valor: "‚Ç¨ 527 M" },
            { posicao: 49, clube: "VfL Wolfsburg", pais: "Alemanha", valor: "‚Ç¨ 524 M" },
            { posicao: 50, clube: "Real Betis", pais: "Espanha", valor: "‚Ç¨ 519 M" },
            { posicao: 51, clube: "Olympique Lyon", pais: "Fran√ßa", valor: "‚Ç¨ 514 M" },
            { posicao: 52, clube: "Villarreal CF", pais: "Espanha", valor: "‚Ç¨ 508 M" },
            { posicao: 53, clube: "FC Salzburg", pais: "√Åustria", valor: "‚Ç¨ 503 M" },
            { posicao: 54, clube: "Union Berlin", pais: "Alemanha", valor: "‚Ç¨ 501 M" },
            { posicao: 55, clube: "Sporting CP", pais: "Portugal", valor: "‚Ç¨ 497 M" },
            { posicao: 56, clube: "Ajax Amsterdam", pais: "Holanda", valor: "‚Ç¨ 487 M" },
            { posicao: 57, clube: "FC Copenhagen", pais: "Dinamarca", valor: "‚Ç¨ 484 M" },
            { posicao: 58, clube: "Celta Vigo", pais: "Espanha", valor: "‚Ç¨ 473 M" },
            { posicao: 59, clube: "Girona FC", pais: "Espanha", valor: "‚Ç¨ 470 M" },
            { posicao: 60, clube: "Getafe CF", pais: "Espanha", valor: "‚Ç¨ 465 M" },
            { posicao: 61, clube: "FC Twente", pais: "Holanda", valor: "‚Ç¨ 462 M" },
            { posicao: 62, clube: "Hertha BSC", pais: "Alemanha", valor: "‚Ç¨ 456 M" },
            { posicao: 63, clube: "Schalke 04", pais: "Alemanha", valor: "‚Ç¨ 453 M" },
            { posicao: 64, clube: "FC Koln", pais: "Alemanha", valor: "‚Ç¨ 447 M" },
            { posicao: 65, clube: "VfB Stuttgart", pais: "Alemanha", valor: "‚Ç¨ 441 M" },
            { posicao: 66, clube: "SC Freiburg", pais: "Alemanha", valor: "‚Ç¨ 438 M" },
            { posicao: 67, clube: "TSG Hoffenheim", pais: "Alemanha", valor: "‚Ç¨ 435 M" },
            { posicao: 68, clube: "Borussia M'gladbach", pais: "Alemanha", valor: "‚Ç¨ 432 M" },
            { posicao: 69, clube: "FSV Mainz 05", pais: "Alemanha", valor: "‚Ç¨ 429 M" },
            { posicao: 70, clube: "FC Augsburg", pais: "Alemanha", valor: "‚Ç¨ 423 M" },
            { posicao: 71, clube: "SV Werder Bremen", pais: "Alemanha", valor: "‚Ç¨ 420 M" },
            { posicao: 72, clube: "FC St. Pauli", pais: "Alemanha", valor: "‚Ç¨ 416 M" },
            { posicao: 73, clube: "Hamburger SV", pais: "Alemanha", valor: "‚Ç¨ 413 M" },
            { posicao: 74, clube: "Hannover 96", pais: "Alemanha", valor: "‚Ç¨ 410 M" },
            { posicao: 75, clube: "Fortuna D√ºsseldorf", pais: "Alemanha", valor: "‚Ç¨ 407 M" },
            { posicao: 76, clube: "1. FC N√ºrnberg", pais: "Alemanha", valor: "‚Ç¨ 404 M" },
            { posicao: 77, clube: "Karlsruher SC", pais: "Alemanha", valor: "‚Ç¨ 401 M" },
            { posicao: 78, clube: "SV Darmstadt 98", pais: "Alemanha", valor: "‚Ç¨ 398 M" },
            { posicao: 79, clube: "Eintracht Braunschweig", pais: "Alemanha", valor: "‚Ç¨ 395 M" },
            { posicao: 80, clube: "FC Hansa Rostock", pais: "Alemanha", valor: "‚Ç¨ 392 M" },
            { posicao: 81, clube: "1. FC Magdeburg", pais: "Alemanha", valor: "‚Ç¨ 389 M" },
            { posicao: 82, clube: "SC Paderborn 07", pais: "Alemanha", valor: "‚Ç¨ 386 M" },
            { posicao: 83, clube: "SpVgg Greuther F√ºrth", pais: "Alemanha", valor: "‚Ç¨ 383 M" },
            { posicao: 84, clube: "SSV Jahn Regensburg", pais: "Alemanha", valor: "‚Ç¨ 380 M" },
            { posicao: 85, clube: "SV Sandhausen", pais: "Alemanha", valor: "‚Ç¨ 377 M" },
            { posicao: 86, clube: "Dynamo Dresden", pais: "Alemanha", valor: "‚Ç¨ 374 M" },
            { posicao: 87, clube: "FC Erzgebirge Aue", pais: "Alemanha", valor: "‚Ç¨ 371 M" },
            { posicao: 88, clube: "1. FC Heidenheim", pais: "Alemanha", valor: "‚Ç¨ 368 M" },
            { posicao: 89, clube: "SV Wehen Wiesbaden", pais: "Alemanha", valor: "‚Ç¨ 365 M" },
            { posicao: 90, clube: "TSV 1860 M√ºnchen", pais: "Alemanha", valor: "‚Ç¨ 362 M" },
            { posicao: 91, clube: "FC Ingolstadt 04", pais: "Alemanha", valor: "‚Ç¨ 359 M" },
            { posicao: 92, clube: "MSV Duisburg", pais: "Alemanha", valor: "‚Ç¨ 356 M" },
            { posicao: 93, clube: "W√ºrzburger Kickers", pais: "Alemanha", valor: "‚Ç¨ 353 M" },
            { posicao: 94, clube: "KFC Uerdingen 05", pais: "Alemanha", valor: "‚Ç¨ 350 M" },
            { posicao: 95, clube: "Viktoria K√∂ln", pais: "Alemanha", valor: "‚Ç¨ 347 M" },
            { posicao: 96, clube: "SC Verl", pais: "Alemanha", valor: "‚Ç¨ 344 M" },
            { posicao: 97, clube: "FC Bayern M√ºnchen II", pais: "Alemanha", valor: "‚Ç¨ 341 M" },
            { posicao: 98, clube: "SV Meppen", pais: "Alemanha", valor: "‚Ç¨ 338 M" },
            { posicao: 99, clube: "Chemnitzer FC", pais: "Alemanha", valor: "‚Ç¨ 335 M" },
            { posicao: 100, clube: "VfL Osnabr√ºck", pais: "Alemanha", valor: "‚Ç¨ 332 M" }
        ];

        const serieAClubs = [
            { posicao: 1, clube: "SE Palmeiras", plantel: 29, idadeMedia: 26.3, estrangeiros: 8, valorMedio: "‚Ç¨ 7.32 mi.", valorTotal: "‚Ç¨ 212.15 mi.", posseBola: "58.2%", passesCertos: "385", chutesJogo: "13.4" },
            { posicao: 2, clube: "CR Flamengo", plantel: 31, idadeMedia: 28.4, estrangeiros: 10, valorMedio: "‚Ç¨ 6.32 mi.", valorTotal: "‚Ç¨ 195.90 mi.", posseBola: "59.8%", passesCertos: "412", chutesJogo: "14.7" },
            { posicao: 3, clube: "Botafogo FR", plantel: 31, idadeMedia: 27.4, estrangeiros: 11, valorMedio: "‚Ç¨ 4.46 mi.", valorTotal: "‚Ç¨ 138.35 mi.", posseBola: "56.1%", passesCertos: "368", chutesJogo: "12.9" },
            { posicao: 4, clube: "Cruzeiro EC", plantel: 31, idadeMedia: 26.6, estrangeiros: 6, valorMedio: "‚Ç¨ 4.05 mi.", valorTotal: "‚Ç¨ 125.65 mi.", posseBola: "55.3%", passesCertos: "354", chutesJogo: "11.8" },
            { posicao: 5, clube: "SC Corinthians", plantel: 32, idadeMedia: 26.3, estrangeiros: 8, valorMedio: "‚Ç¨ 3.45 mi.", valorTotal: "‚Ç¨ 110.45 mi.", posseBola: "53.7%", passesCertos: "342", chutesJogo: "10.9" },
            { posicao: 6, clube: "CR Vasco da Gama", plantel: 36, idadeMedia: 26.5, estrangeiros: 9, valorMedio: "‚Ç¨ 3.00 mi.", valorTotal: "‚Ç¨ 108.15 mi.", posseBola: "54.2%", passesCertos: "348", chutesJogo: "11.3" },
            { posicao: 7, clube: "EC Bahia", plantel: 29, idadeMedia: 27.6, estrangeiros: 5, valorMedio: "‚Ç¨ 3.50 mi.", valorTotal: "‚Ç¨ 101.50 mi.", posseBola: "52.8%", passesCertos: "335", chutesJogo: "10.4" },
            { posicao: 8, clube: "Atl√©tico Mineiro", plantel: 32, idadeMedia: 26.8, estrangeiros: 6, valorMedio: "‚Ç¨ 3.04 mi.", valorTotal: "‚Ç¨ 97.40 mi.", posseBola: "57.1%", passesCertos: "378", chutesJogo: "12.1" },
            { posicao: 9, clube: "Fluminense FC", plantel: 34, idadeMedia: 28.9, estrangeiros: 11, valorMedio: "‚Ç¨ 2.77 mi.", valorTotal: "‚Ç¨ 94.10 mi.", posseBola: "56.4%", passesCertos: "371", chutesJogo: "11.7" },
            { posicao: 10, clube: "RB Bragantino", plantel: 36, idadeMedia: 25.1, estrangeiros: 8, valorMedio: "‚Ç¨ 2.52 mi.", valorTotal: "‚Ç¨ 90.70 mi.", posseBola: "54.8%", passesCertos: "356", chutesJogo: "11.2" },
            { posicao: 11, clube: "S√£o Paulo FC", plantel: 34, idadeMedia: 27.9, estrangeiros: 11, valorMedio: "‚Ç¨ 2.64 mi.", valorTotal: "‚Ç¨ 89.85 mi.", posseBola: "55.6%", passesCertos: "362", chutesJogo: "11.5" },
            { posicao: 12, clube: "Gr√™mio FBPA", plantel: 38, idadeMedia: 27.7, estrangeiros: 12, valorMedio: "‚Ç¨ 2.28 mi.", valorTotal: "‚Ç¨ 86.45 mi.", posseBola: "53.2%", passesCertos: "339", chutesJogo: "10.6" },
            { posicao: 13, clube: "SC Internacional", plantel: 29, idadeMedia: 27.0, estrangeiros: 9, valorMedio: "‚Ç¨ 2.97 mi.", valorTotal: "‚Ç¨ 86.00 mi.", posseBola: "52.5%", passesCertos: "331", chutesJogo: "10.2" },
            { posicao: 14, clube: "Santos FC", plantel: 33, idadeMedia: 26.6, estrangeiros: 9, valorMedio: "‚Ç¨ 2.51 mi.", valorTotal: "‚Ç¨ 82.80 mi.", posseBola: "51.9%", passesCertos: "326", chutesJogo: "9.8" },
            { posicao: 15, clube: "Fortaleza EC", plantel: 37, idadeMedia: 29.2, estrangeiros: 10, valorMedio: "‚Ç¨ 1.28 mi.", valorTotal: "‚Ç¨ 47.18 mi.", posseBola: "49.3%", passesCertos: "298", chutesJogo: "8.7" },
            { posicao: 16, clube: "Sport Recife", plantel: 31, idadeMedia: 29.1, estrangeiros: 6, valorMedio: "‚Ç¨ 1.27 mi.", valorTotal: "‚Ç¨ 39.25 mi.", posseBola: "48.1%", passesCertos: "287", chutesJogo: "8.2" },
            { posicao: 17, clube: "EC Vit√≥ria", plantel: 34, idadeMedia: 28.2, estrangeiros: 6, valorMedio: "‚Ç¨ 985 mil", valorTotal: "‚Ç¨ 33.50 mi.", posseBola: "47.6%", passesCertos: "282", chutesJogo: "7.9" },
            { posicao: 18, clube: "Cear√° SC", plantel: 32, idadeMedia: 29.2, estrangeiros: 3, valorMedio: "‚Ç¨ 1.03 mi.", valorTotal: "‚Ç¨ 32.85 mi.", posseBola: "46.8%", passesCertos: "276", chutesJogo: "7.6" },
            { posicao: 19, clube: "EC Juventude", plantel: 36, idadeMedia: 28.1, estrangeiros: 5, valorMedio: "‚Ç¨ 644 mil", valorTotal: "‚Ç¨ 23.20 mi.", posseBola: "45.2%", passesCertos: "268", chutesJogo: "7.1" },
            { posicao: 20, clube: "Mirassol FC", plantel: 33, idadeMedia: 29.2, estrangeiros: 1, valorMedio: "‚Ç¨ 683 mil", valorTotal: "‚Ç¨ 22.53 mi.", posseBola: "44.7%", passesCertos: "264", chutesJogo: "6.8" }
        ];

        const serieBClubs = [
            { posicao: 1, clube: "Athletico Paranaense", plantel: 33, idadeMedia: 26.5, estrangeiros: 10, valorMedio: "‚Ç¨ 1.17 mi.", valorTotal: "‚Ç¨ 38.48 mi.", posseBola: "54.8%", passesCertos: "356", chutesJogo: "11.2" },
            { posicao: 2, clube: "Clube do Remo", plantel: 40, idadeMedia: 27.4, estrangeiros: 7, valorMedio: "‚Ç¨ 408 mil", valorTotal: "‚Ç¨ 16.30 mi.", posseBola: "48.3%", passesCertos: "289", chutesJogo: "8.4" },
            { posicao: 3, clube: "Coritiba FC", plantel: 30, idadeMedia: 28.9, estrangeiros: 4, valorMedio: "‚Ç¨ 529 mil", valorTotal: "‚Ç¨ 15.88 mi.", posseBola: "49.7%", passesCertos: "302", chutesJogo: "8.9" },
            { posicao: 4, clube: "Am√©rica Mineiro", plantel: 38, idadeMedia: 27.5, estrangeiros: 4, valorMedio: "‚Ç¨ 382 mil", valorTotal: "‚Ç¨ 14.53 mi.", posseBola: "47.2%", passesCertos: "278", chutesJogo: "7.8" },
            { posicao: 5, clube: "Cuiab√° EC", plantel: 31, idadeMedia: 26.6, estrangeiros: 3, valorMedio: "‚Ç¨ 445 mil", valorTotal: "‚Ç¨ 13.80 mi.", posseBola: "48.6%", passesCertos: "294", chutesJogo: "8.3" },
            { posicao: 6, clube: "Atl√©tico Goianiense", plantel: 34, idadeMedia: 27.2, estrangeiros: 4, valorMedio: "‚Ç¨ 382 mil", valorTotal: "‚Ç¨ 12.98 mi.", posseBola: "46.8%", passesCertos: "275", chutesJogo: "7.5" },
            { posicao: 7, clube: "Gr√™mio Novorizontino", plantel: 30, idadeMedia: 29.9, estrangeiros: 1, valorMedio: "‚Ç¨ 423 mil", valorTotal: "‚Ç¨ 12.70 mi.", posseBola: "45.1%", passesCertos: "265", chutesJogo: "7.0" },
            { posicao: 8, clube: "Goi√°s EC", plantel: 29, idadeMedia: 29.2, estrangeiros: 3, valorMedio: "‚Ç¨ 417 mil", valorTotal: "‚Ç¨ 12.10 mi.", posseBola: "44.9%", passesCertos: "262", chutesJogo: "6.9" },
            { posicao: 9, clube: "Crici√∫ma EC", plantel: 49, idadeMedia: 26.4, estrangeiros: 1, valorMedio: "‚Ç¨ 227 mil", valorTotal: "‚Ç¨ 11.10 mi.", posseBola: "42.6%", passesCertos: "241", chutesJogo: "6.2" },
            { posicao: 10, clube: "CRB", plantel: 28, idadeMedia: 28.0, estrangeiros: 2, valorMedio: "‚Ç¨ 369 mil", valorTotal: "‚Ç¨ 10.33 mi.", posseBola: "43.8%", passesCertos: "248", chutesJogo: "6.5" },
            { posicao: 11, clube: "Ponte Preta", plantel: 35, idadeMedia: 27.8, estrangeiros: 3, valorMedio: "‚Ç¨ 295 mil", valorTotal: "‚Ç¨ 10.33 mi.", posseBola: "42.1%", passesCertos: "235", chutesJogo: "6.1" },
            { posicao: 12, clube: "Ava√≠ FC", plantel: 32, idadeMedia: 28.5, estrangeiros: 2, valorMedio: "‚Ç¨ 321 mil", valorTotal: "‚Ç¨ 10.27 mi.", posseBola: "41.8%", passesCertos: "232", chutesJogo: "5.9" },
            { posicao: 13, clube: "Oper√°rio PR", plantel: 30, idadeMedia: 29.0, estrangeiros: 1, valorMedio: "‚Ç¨ 342 mil", valorTotal: "‚Ç¨ 10.26 mi.", posseBola: "41.5%", passesCertos: "228", chutesJogo: "5.8" },
            { posicao: 14, clube: "Guarani FC", plantel: 33, idadeMedia: 28.7, estrangeiros: 2, valorMedio: "‚Ç¨ 306 mil", valorTotal: "‚Ç¨ 10.10 mi.", posseBola: "40.9%", passesCertos: "225", chutesJogo: "5.6" },
            { posicao: 15, clube: "Paysandu SC", plantel: 31, idadeMedia: 27.9, estrangeiros: 1, valorMedio: "‚Ç¨ 325 mil", valorTotal: "‚Ç¨ 10.08 mi.", posseBola: "40.6%", passesCertos: "222", chutesJogo: "5.5" },
            { posicao: 16, clube: "Vila Nova FC", plantel: 29, idadeMedia: 28.3, estrangeiros: 2, valorMedio: "‚Ç¨ 345 mil", valorTotal: "‚Ç¨ 10.01 mi.", posseBola: "40.2%", passesCertos: "218", chutesJogo: "5.3" },
            { posicao: 17, clube: "Londrina EC", plantel: 34, idadeMedia: 29.1, estrangeiros: 1, valorMedio: "‚Ç¨ 294 mil", valorTotal: "‚Ç¨ 9.996 mi.", posseBola: "39.8%", passesCertos: "215", chutesJogo: "5.2" },
            { posicao: 18, clube: "Chapecoense", plantel: 32, idadeMedia: 28.8, estrangeiros: 0, valorMedio: "‚Ç¨ 312 mil", valorTotal: "‚Ç¨ 9.984 mi.", posseBola: "39.4%", passesCertos: "212", chutesJogo: "5.0" },
            { posicao: 19, clube: "Brusque FC", plantel: 30, idadeMedia: 29.5, estrangeiros: 1, valorMedio: "‚Ç¨ 330 mil", valorTotal: "‚Ç¨ 9.90 mi.", posseBola: "39.1%", passesCertos: "208", chutesJogo: "4.9" },
            { posicao: 20, clube: "Ituano FC", plantel: 28, idadeMedia: 30.2, estrangeiros: 0, valorMedio: "‚Ç¨ 353 mil", valorTotal: "‚Ç¨ 9.884 mi.", posseBola: "38.7%", passesCertos: "205", chutesJogo: "4.7" }
        ];

        let currentTab = 'top100';

        // Fun√ß√£o para mostrar tabs
        function showTab(tabName) {
            // Esconder todas as tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remover classe active de todos os bot√µes
            document.querySelectorAll('.tab').forEach(btn => {
                btn.classList.remove('active', 'serie-a', 'serie-b');
            });
            
            // Mostrar tab selecionada
            document.getElementById(tabName).classList.add('active');
            
            // Ativar bot√£o correspondente
            const activeBtn = event.target;
            activeBtn.classList.add('active');
            
            if (tabName === 'serieA') {
                activeBtn.classList.add('serie-a');
                document.getElementById('exportBtn').className = 'export-btn serie-a';
            } else if (tabName === 'serieB') {
                activeBtn.classList.add('serie-b');
                document.getElementById('exportBtn').className = 'export-btn serie-b';
            } else {
                document.getElementById('exportBtn').className = 'export-btn';
            }
            
            currentTab = tabName;
        }

        // Fun√ß√£o para tornar c√©lula edit√°vel
        function makeEditable(cell, originalValue) {
            // Verificar se a c√©lula est√° travada
            if (cell.classList.contains('locked')) {
                alert('üîí Esta c√©lula est√° travada! Clique no cadeado para desbloquear.');
                return;
            }
            
            if (cell.classList.contains('editable')) return;
            
            cell.classList.add('editable');
            cell.contentEditable = true;
            cell.style.position = 'relative';
            
            // Adicionar cadeado se n√£o existir
            if (!cell.querySelector('.cell-lock')) {
                const lockIcon = document.createElement('span');
                lockIcon.className = 'cell-lock';
                lockIcon.innerHTML = 'üîì';
                lockIcon.title = 'Clique para travar este campo';
                lockIcon.style.zIndex = '999';
                
                // Usar addEventListener para melhor compatibilidade
                lockIcon.addEventListener('click', function(e) {
                    e.stopPropagation();
                    e.preventDefault();
                    console.log('üñ±Ô∏è [LOCK] Click no cadeado aberto detectado!');
                    toggleCellLock(cell);
                });
                
                cell.appendChild(lockIcon);
            }
            
            cell.focus();
            
            // Selecionar todo o texto
            const range = document.createRange();
            range.selectNodeContents(cell);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            
            // Salvar ao perder foco
            cell.addEventListener('blur', function() {
                if (!cell.classList.contains('locked')) {
                    cell.contentEditable = false;
                    cell.classList.remove('editable');
                }
            });
            
            // Salvar ao pressionar Enter
            cell.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    cell.blur();
                }
            });
        }

        // Fun√ß√£o para alternar trava da c√©lula
        function toggleCellLock(cell) {
            console.log('üîÑ [LOCK] Toggle chamado para:', cell.textContent.trim());
            const lockIcon = cell.querySelector('.cell-lock');
            
            if (!lockIcon) {
                console.error('‚ùå [LOCK] √çcone de cadeado n√£o encontrado!');
                return;
            }
            
            if (cell.classList.contains('locked')) {
                // Desbloquear
                console.log('üîì [LOCK] Desbloqueando c√©lula...');
                cell.classList.remove('locked');
                cell.classList.add('editable');
                cell.contentEditable = true;
                lockIcon.innerHTML = 'üîì';
                lockIcon.title = 'Clique para travar este campo';
                lockIcon.classList.remove('locked');
                
                // Remover do localStorage
                removeCellLockState(cell);
                console.log('‚úÖ [LOCK] Campo desbloqueado:', cell.textContent.trim());
            } else {
                // Bloquear
                console.log('üîí [LOCK] Bloqueando c√©lula...');
                cell.classList.remove('editable');
                cell.classList.add('locked');
                cell.contentEditable = false;
                lockIcon.innerHTML = 'üîí';
                lockIcon.title = 'Clique para destravar este campo';
                lockIcon.classList.add('locked');
                
                // Salvar no localStorage
                saveCellLockState(cell);
                console.log('‚úÖ [LOCK] Campo travado:', cell.textContent.trim());
            }
        }

        // Fun√ß√£o para remover estado do cadeado
        function removeCellLockState(cell) {
            const row = cell.closest('tr');
            const table = cell.closest('table');
            const rowIndex = Array.from(row.parentNode.children).indexOf(row);
            const cellIndex = Array.from(row.children).indexOf(cell);
            const tableId = table.id;
            
            const locks = JSON.parse(localStorage.getItem('cellLocks') || '[]');
            const filteredLocks = locks.filter(lock => 
                !(lock.tableId === tableId && lock.rowIndex === rowIndex && lock.cellIndex === cellIndex)
            );
            
            localStorage.setItem('cellLocks', JSON.stringify(filteredLocks));
            console.log('üóëÔ∏è [LOCK] Estado removido do localStorage');
        }

        // Fun√ß√£o para salvar estado do cadeado
        function saveCellLockState(cell) {
            const row = cell.closest('tr');
            const table = cell.closest('table');
            const rowIndex = Array.from(row.parentNode.children).indexOf(row);
            const cellIndex = Array.from(row.children).indexOf(cell);
            const tableId = table.id;
            
            const lockData = {
                tableId: tableId,
                rowIndex: rowIndex,
                cellIndex: cellIndex,
                value: cell.textContent.trim(),
                timestamp: new Date().toISOString()
            };
            
            const locks = JSON.parse(localStorage.getItem('cellLocks') || '[]');
            
            // Remover lock existente para esta c√©lula
            const filteredLocks = locks.filter(lock => 
                !(lock.tableId === tableId && lock.rowIndex === rowIndex && lock.cellIndex === cellIndex)
            );
            
            // Adicionar novo lock
            filteredLocks.push(lockData);
            localStorage.setItem('cellLocks', JSON.stringify(filteredLocks));
        }

        // Fun√ß√£o para restaurar cadeados salvos
        function restoreCellLocks() {
            const locks = JSON.parse(localStorage.getItem('cellLocks') || '[]');
            console.log(`üîÑ [RESTORE] Restaurando ${locks.length} cadeados...`);
            
            locks.forEach((lock, index) => {
                const table = document.getElementById(lock.tableId);
                if (table) {
                    const tbody = table.getElementsByTagName('tbody')[0];
                    if (tbody && tbody.rows[lock.rowIndex]) {
                        const row = tbody.rows[lock.rowIndex];
                        const cell = row.cells[lock.cellIndex];
                        
                        if (cell && cell.textContent.trim() === lock.value) {
                            console.log(`üîí [RESTORE] Restaurando cadeado ${index + 1}:`, cell.textContent.trim());
                            
                            // Restaurar estado travado
                            cell.classList.add('locked');
                            cell.contentEditable = false;
                            cell.style.position = 'relative';
                            
                            // Remover cadeado existente se houver
                            const existingLock = cell.querySelector('.cell-lock');
                            if (existingLock) {
                                existingLock.remove();
                            }
                            
                            // Criar novo √≠cone de cadeado
                            const lockIcon = document.createElement('span');
                            lockIcon.className = 'cell-lock locked';
                            lockIcon.innerHTML = 'üîí';
                            lockIcon.title = 'Clique para destravar este campo';
                            lockIcon.style.zIndex = '999';
                            
                            // Fun√ß√£o de click com refer√™ncia correta
                            lockIcon.addEventListener('click', function(e) {
                                e.stopPropagation();
                                e.preventDefault();
                                console.log('üñ±Ô∏è [LOCK] Click no cadeado detectado!');
                                toggleCellLock(cell);
                            });
                            
                            cell.appendChild(lockIcon);
                            console.log('‚úÖ [RESTORE] Cadeado restaurado com sucesso');
                        } else {
                            console.warn('‚ö†Ô∏è [RESTORE] C√©lula n√£o encontrada ou valor diferente:', {
                                expected: lock.value,
                                found: cell ? cell.textContent.trim() : 'null'
                            });
                        }
                    } else {
                        console.warn('‚ö†Ô∏è [RESTORE] Linha n√£o encontrada:', lock.rowIndex);
                    }
                } else {
                    console.warn('‚ö†Ô∏è [RESTORE] Tabela n√£o encontrada:', lock.tableId);
                }
            });
            
            console.log('üèÅ [RESTORE] Restaura√ß√£o de cadeados conclu√≠da');
        }

        // Fun√ß√£o para popular tabelas
        function populateTable(tableId, data, columns) {
            const tbody = document.getElementById(tableId + 'Body');
            tbody.innerHTML = '';
            
            data.forEach((item, index) => {
                const row = document.createElement('tr');
                
                columns.forEach(col => {
                    const cell = document.createElement('td');
                    cell.textContent = item[col];
                    
                    // Adicionar classes especiais
                    if (col === 'valor' || col === 'valorAtual' || col === 'valorTotal') {
                        cell.classList.add('valor-cell');
                    }
                    
                    if (col === 'percentual') {
                        cell.classList.add(item[col].includes('-') ? 'percentual-negativo' : 'percentual-positivo');
                    }
                    
                    row.appendChild(cell);
                });
                
                // Adicionar bot√£o de edi√ß√£o
                const actionCell = document.createElement('td');
                const editBtn = document.createElement('button');
                editBtn.textContent = '‚úèÔ∏è Editar';
                editBtn.className = 'edit-btn';
                editBtn.onclick = function() {
                    const cells = row.querySelectorAll('td:not(:last-child)');
                    cells.forEach(cell => {
                        if (!cell.textContent.match(/^\d+$/)) { // N√£o editar posi√ß√£o
                            makeEditable(cell, cell.textContent);
                        }
                    });
                };
                actionCell.appendChild(editBtn);
                row.appendChild(actionCell);
                
                tbody.appendChild(row);
            });
        }

        // Fun√ß√£o para exportar CSV
        function exportCurrentTab() {
            let data, filename, headers;
            
            if (currentTab === 'top100') {
                data = top100Clubs;
                filename = 'top_100_clubes_mais_valiosos.csv';
                headers = ['Posi√ß√£o', 'Clube', 'Pa√≠s', 'Valor'];
            } else if (currentTab === 'serieA') {
                data = serieAClubs;
                filename = 'serie_a_brasileirao.csv';
                headers = ['Posi√ß√£o', 'Clube', 'Plantel', 'Idade M√©dia', 'Estrangeiros', 'Valor M√©dio', 'Valor Total', 'Posse Bola (%)', 'Passes Certos', 'Chutes/Jogo'];
            } else if (currentTab === 'serieB') {
                data = serieBClubs;
                filename = 'serie_b_brasileirao.csv';
                headers = ['Posi√ß√£o', 'Clube', 'Plantel', 'Idade M√©dia', 'Estrangeiros', 'Valor M√©dio', 'Valor Total', 'Posse Bola (%)', 'Passes Certos', 'Chutes/Jogo'];
            }
            
            const csvContent = [
                headers.join(','),
                ...data.map(row => headers.map(header => {
                    const key = header.toLowerCase().replace(/\s+/g, '').replace(/[√ß√£]/g, 'a').replace('√ß', 'c');
                    const value = row[Object.keys(row).find(k => k.toLowerCase().replace(/\s+/g, '').includes(key.substring(0, 5))) || Object.keys(row)[headers.indexOf(header)]];
                    return `"${value || ''}"`;
                }).join(','))
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Fun√ß√£o para salvar altera√ß√µes
        function saveChanges() {
            const lockedCells = document.querySelectorAll('.locked');
            let lockedCount = 0;
            let unlockedCount = 0;
            
            // Contar c√©lulas travadas e destravadas
            document.querySelectorAll('td').forEach(cell => {
                if (cell.classList.contains('locked')) {
                    lockedCount++;
                } else if (cell.contentEditable === 'true' || cell.classList.contains('editable')) {
                    unlockedCount++;
                }
            });
            
            // Preparar dados para enviar √† Central Admin
            const plantelData = {
                timestamp: new Date().toISOString(),
                usuario: 'admin',
                dadosEditados: {},
                celulasProtegidas: lockedCount
            };
            
            // Coletar dados das tabelas
            ['serieATable', 'serieBTable'].forEach(tableId => {
                const table = document.getElementById(tableId);
                if (table && table.closest('.tab-content').classList.contains('active')) {
                    const dados = [];
                    const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
                    
                    for (let row of rows) {
                        const cells = row.getElementsByTagName('td');
                        const clubeData = {
                            clube: cells[1]?.textContent || '',
                            plantel: cells[2]?.textContent || '',
                            valorTotal: cells[6]?.textContent || '',
                            posseBola: cells[7]?.textContent || '',
                            passesCertos: cells[8]?.textContent || '',
                            chutesJogo: cells[9]?.textContent || '',
                            protegido: row.querySelector('.locked') ? true : false
                        };
                        dados.push(clubeData);
                    }
                    
                    plantelData.dadosEditados[tableId] = dados;
                }
            });
            
            // Salvar no localStorage para integra√ß√£o com Central Admin
            localStorage.setItem('estatisticasPlantel', JSON.stringify(plantelData));
            
            alert(`üíæ Altera√ß√µes salvas com sucesso!\n\nüìä Dados protegidos: ${lockedCount} campos\nüîì Dados edit√°veis: ${unlockedCount} campos\n\n‚úÖ Dados sincronizados com a Central Admin!`);
            
            // Log para debug
            console.log('üìä Dados salvos para Central Admin:', plantelData);
        }

        // Fun√ß√£o de debug para limpar todos os cadeados
        function limparTodosCadeados() {
            localStorage.removeItem('cellLocks');
            document.querySelectorAll('.cell-lock').forEach(lock => lock.remove());
            document.querySelectorAll('.locked').forEach(cell => {
                cell.classList.remove('locked');
                cell.contentEditable = true;
            });
            console.log('üßπ [DEBUG] Todos os cadeados foram removidos!');
            alert('üßπ Todos os cadeados foram limpos! Recarregue a p√°gina para testar.');
        }

        // Tornar fun√ß√£o dispon√≠vel globalmente para debug
        window.limparTodosCadeados = limparTodosCadeados;
        window.toggleCellLock = toggleCellLock;

        // Inicializar tabelas
        document.addEventListener('DOMContentLoaded', function() {
            populateTable('top100', top100Clubs, ['posicao', 'clube', 'pais', 'valor']);
            populateTable('serieA', serieAClubs, ['posicao', 'clube', 'plantel', 'idadeMedia', 'estrangeiros', 'valorMedio', 'valorTotal', 'posseBola', 'passesCertos', 'chutesJogo']);
            populateTable('serieB', serieBClubs, ['posicao', 'clube', 'plantel', 'idadeMedia', 'estrangeiros', 'valorMedio', 'valorTotal', 'posseBola', 'passesCertos', 'chutesJogo']);
            
            // Restaurar cadeados ap√≥s carregar tabelas
            setTimeout(() => {
                restoreCellLocks();
            }, 1000); // Aumentei para 1 segundo para garantir
            
            // Debug: mostrar info no console
            console.log('üîß [DEBUG] Para limpar todos os cadeados, digite: limparTodosCadeados()');
        });
    </script>
</body>
</html>
